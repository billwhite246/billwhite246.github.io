<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Bill&#39;s blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://blog.webpro.ltd/"/>
  <updated>2020-03-09T12:07:12.617Z</updated>
  <id>http://blog.webpro.ltd/</id>
  
  <author>
    <name>Bill</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>My Hexo Blog</title>
    <link href="http://blog.webpro.ltd/2020/03/05/My-Hexo-Blog/"/>
    <id>http://blog.webpro.ltd/2020/03/05/My-Hexo-Blog/</id>
    <published>2020-03-05T13:48:00.000Z</published>
    <updated>2020-03-09T12:07:12.617Z</updated>
    
    <content type="html"><![CDATA[<h1 id="博客全新升级为Hexo引擎"><a href="#博客全新升级为Hexo引擎" class="headerlink" title="博客全新升级为Hexo引擎"></a>博客全新升级为Hexo引擎</h1><h2 id="markdown支持测试"><a href="#markdown支持测试" class="headerlink" title="markdown支持测试"></a>markdown支持测试</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">markdown</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 欢迎使用 Markdown在线编辑器 MdEditor</span></span><br><span class="line"><span class="strong">**Markdown是一种轻量级的「标记语言」**</span></span><br></pre></td></tr></table></figure></div><h1 id="欢迎使用-Markdown在线编辑器-MdEditor"><a href="#欢迎使用-Markdown在线编辑器-MdEditor" class="headerlink" title="欢迎使用 Markdown在线编辑器 MdEditor"></a>欢迎使用 Markdown在线编辑器 MdEditor</h1><p><strong>Markdown是一种轻量级的「标记语言」</strong></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">markdown</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![](https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200308123251.png)</span><br></pre></td></tr></table></figure></div><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200308123251.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200308123251.png" class="lazyload"></a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;博客全新升级为Hexo引擎&quot;&gt;&lt;a href=&quot;#博客全新升级为Hexo引擎&quot; class=&quot;headerlink&quot; title=&quot;博客全新升级为Hexo引擎&quot;&gt;&lt;/a&gt;博客全新升级为Hexo引擎&lt;/h1&gt;&lt;h2 id=&quot;markdown支持测试&quot;&gt;&lt;a href
      
    
    </summary>
    
    
      <category term="blog" scheme="http://blog.webpro.ltd/categories/blog/"/>
    
    
      <category term="hexo" scheme="http://blog.webpro.ltd/tags/hexo/"/>
    
      <category term="blog" scheme="http://blog.webpro.ltd/tags/blog/"/>
    
  </entry>
  
  <entry>
    <title>Centos6.10服务器入侵-&gt;重装-&gt;恢复记录</title>
    <link href="http://blog.webpro.ltd/2020/02/22/My-Server-Attacked-by-Scanner/"/>
    <id>http://blog.webpro.ltd/2020/02/22/My-Server-Attacked-by-Scanner/</id>
    <published>2020-02-21T16:00:00.000Z</published>
    <updated>2020-03-09T12:10:41.357Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Centos6-10服务器入侵-gt-重装-gt-恢复记录"><a href="#Centos6-10服务器入侵-gt-重装-gt-恢复记录" class="headerlink" title="Centos6.10服务器入侵-&gt;重装-&gt;恢复记录"></a>Centos6.10服务器入侵-&gt;重装-&gt;恢复记录</h1><ul><li>头些天在centos6.10服务器创建了一个git账户用来搭建私有Git仓库，账户和密码均为git，并且支持ssh密码远程连接，很快被黑客扫描到，通过ssh弱口令进到我的git账户，并操纵我的服务器扫描其他持续扫描其他服务器，被购买服务器的主机商的防火墙发现，锁定了我的服务器。也是在与客服的沟通中，他问我的服务器ssh密码是否过于简单，正是弱口令使我的服务器沦陷。病毒已经植入到我的系统中，为了彻底解决，客服建议我重装系统，尽管服务器上面的数据比较多，我还是硬着头皮备份、重装了一次系统，搞了整整一天，服务器上的功能基本恢复。</li></ul><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200308123405.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200308123405.png" class="lazyload"></a></p><ul><li>上一次配置服务器还是在2年前，当时安全意识较差，认为防火墙是多余的，把防火墙直接关闭，使得服务器上可以任意向外发送数据、服务器上的任何端口都向外开放；很多程序都放到root账户下运行；为了省事，设置及其简单的密码，每当看到网络安全相关资料讲解“弱口令”时，感觉弱口令离我非常遥远，不以为然。这些做法都是极其危险的，也是一步一步使我服务器沦陷的最终原因。</li></ul><h2 id="一、备份WEB站点（root账户）"><a href="#一、备份WEB站点（root账户）" class="headerlink" title="一、备份WEB站点（root账户）"></a>一、备份WEB站点（root账户）</h2><ul><li><p>我安装的WEB服务软件为国产的Kangle服务器，应该很少有人听说，Kangle就相当于平时我们所常见的Apache、Nginx，也是一款能够提供WEB访问控制服务的软件。</p></li><li><p>Kangle站点文件存放在<code>/home/ftp</code>下，Kangle一些相关的账户配置信息存储在<code>/vhs/kangle/etc</code>，首先备份这两个文件夹，然后下载压缩包到本地：</p></li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home/ftp</span><br><span class="line">zip -r ftp.zip ftp</span><br><span class="line"><span class="built_in">cd</span> /vhs/kangle/etc/</span><br><span class="line">zip -r etc.zip etc</span><br></pre></td></tr></table></figure></div><h2 id="二、备份MySQL数据库（root账户）"><a href="#二、备份MySQL数据库（root账户）" class="headerlink" title="二、备份MySQL数据库（root账户）"></a>二、备份MySQL数据库（root账户）</h2><ul><li><p>备份MySQL可以使用Navicat以root账户的身份登陆，导出所有数据库即可（安全起见，MySQL在默认状态是不允许从外网以root账户远程连接，在备份的时候需要手动设置将localhst改成%）。</p></li><li><p>MySQL配置允许远程连接</p></li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进入MySQL</span></span><br><span class="line">mysql -uroot -p</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换到mysql库</span></span><br><span class="line">use mysql;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看用户表</span></span><br><span class="line">SELECT `Host`,`User` FROM user;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新用户表</span></span><br><span class="line">UPDATE user SET `Host` = <span class="string">'%'</span> WHERE `User` = <span class="string">'用户名'</span> LIMIT 1;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 强制刷新权限</span></span><br><span class="line">flush privileges;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭mysql</span></span><br><span class="line"><span class="built_in">exit</span>;</span><br></pre></td></tr></table></figure></div><ul><li><p>如果你安装了phpmyadmin也可以以root身份登陆管理页面，导出数据库。</p></li><li><p>我在服务器上设置了定时任务，即每天01:00将整个数据库备份一次，永久保存在服务器上，恰好今天在重装系统前没有对数据库再进行修改，于是我直接使用了今天凌晨1点的全备份来恢复系统。尽管安装系统时仅格式化系统盘，但是为了安全起见，我把sql备份文件下载到了本地。</p></li></ul><h2 id="三、备份tomcat9、gitea（git账户）"><a href="#三、备份tomcat9、gitea（git账户）" class="headerlink" title="三、备份tomcat9、gitea（git账户）"></a>三、备份tomcat9、gitea（git账户）</h2><ul><li>git账户下运行着tomcat和gitea(开源git仓库面板，轻量级)，将这两个相关的文件全部压缩，下载。</li></ul><h2 id="四、备份root账户下的frp内网穿透软件（root）"><a href="#四、备份root账户下的frp内网穿透软件（root）" class="headerlink" title="四、备份root账户下的frp内网穿透软件（root）"></a>四、备份root账户下的frp内网穿透软件（root）</h2><ul><li>第三步忘记了备份内网穿透，再次切换到root用户，找到frp的安装位置，压缩，下载：</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span></span><br><span class="line">zip -r frp.zip frp</span><br></pre></td></tr></table></figure></div><h2 id="五、重装系统"><a href="#五、重装系统" class="headerlink" title="五、重装系统"></a>五、重装系统</h2><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200308123407.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200308123407.png" class="lazyload"></a></p><ul><li>仍然选择centos6.10，并仅格式化系统盘，手机验证码确认，重装。大概5分钟，系统重装完成.（实际这里第一次重装系统时我选的centos7，但是装完之后发现centos7与centos6之间的操作还是存在一定差异的，用着不顺手，就又重装了一次，装回了centos6）</li></ul><h2 id="六、恢复服务器环境及功能"><a href="#六、恢复服务器环境及功能" class="headerlink" title="六、恢复服务器环境及功能"></a>六、恢复服务器环境及功能</h2><ul><li>由于重装系统时保留了数据盘，因此重装完毕之后。/home目录下的文件夹并没有清空。众所周知，Linux一般是一个账户对应一个/home目录下的文件夹，我们应先把这些目录清理干净，防止造成冲突。</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除git用户</span></span><br><span class="line">userdel git</span><br></pre></td></tr></table></figure></div><ul><li><p>设置ssh，允许远程连接。我的服务器重装完毕后已经配置好ssh，直接连接即可。</p></li><li><p>重装Kangle服务器，恢复站点数据（FTP站点及服务器参数配置文件）。</p></li><li><p>重装MySQL，恢复MySQL数据：</p></li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -u root -p mysql &gt; /backup/20200222.sql</span><br></pre></td></tr></table></figure></div><hr><ul><li>安装git(version &gt;= 2.16)</li></ul><h3 id="卸载旧版本git"><a href="#卸载旧版本git" class="headerlink" title="卸载旧版本git"></a>卸载旧版本git</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum remove git</span><br></pre></td></tr></table></figure></div><h3 id="安装依赖库"><a href="#安装依赖库" class="headerlink" title="安装依赖库"></a>安装依赖库</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel</span><br><span class="line">yum install  gcc perl-ExtUtils-MakeMaker</span><br></pre></td></tr></table></figure></div><h3 id="下载安装libiconv"><a href="#下载安装libiconv" class="headerlink" title="下载安装libiconv"></a>下载安装libiconv</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span></span><br><span class="line">wget https://ftp.gnu.org/pub/gnu/libiconv/libiconv-1.15.tar.gz</span><br><span class="line">tar -zxvf libiconv-1.15.tar.gz</span><br><span class="line"><span class="built_in">cd</span> libiconv-1.15</span><br><span class="line">./configure --prefix=/usr/<span class="built_in">local</span>/libiconv  &amp;&amp;  make  &amp;&amp; make install</span><br></pre></td></tr></table></figure></div><h3 id="下载安装Git"><a href="#下载安装Git" class="headerlink" title="下载安装Git"></a>下载安装Git</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span></span><br><span class="line">wget https://www.kernel.org/pub/software/scm/git/git-2.11.0.tar.gz</span><br><span class="line">tar -zxvf git-2.11.0.tar.gz</span><br><span class="line"><span class="built_in">cd</span> git-2.11.0</span><br><span class="line">./configure --prefix=/usr/<span class="built_in">local</span>/git-2.11.0 --with-iconv=/usr/<span class="built_in">local</span>/libiconv</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure></div><h3 id="检查版本号"><a href="#检查版本号" class="headerlink" title="检查版本号"></a>检查版本号</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git --version</span><br></pre></td></tr></table></figure></div><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200308123406.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200308123406.png" class="lazyload"></a></p><hr><ul><li>安装jdk1.8。我安装的系统位centos6.10 x64，安装jdk1.8。具体版本号为：jdk-8u201-linux-x64.tar.gz。由于已经在本地存过jdk，直接通过SSH上传到/usr/local中：</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf jdk-8u201-linux-x64.tar.gz</span><br><span class="line">vi /etc/profile</span><br></pre></td></tr></table></figure></div><ul><li>在profile文件中追加如下文本：</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># jdk8 env</span></span><br><span class="line">JAVA_HOME=/usr/<span class="built_in">local</span>/dev/jdk1.8.0_201</span><br><span class="line">CLASSPATH=.:<span class="variable">$JAVA_HOME</span>/lib</span><br><span class="line">PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin</span><br><span class="line"><span class="built_in">export</span> PATH JAVA_HOME CLASSPATH</span><br></pre></td></tr></table></figure></div><ul><li>保存退出，使环境变量生效：</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure></div><hr><ul><li><p>升级内核。centos6.10的默认内核版本是2.x，但是gitea内核版本要求在3.x，所以需要升级内核。</p></li><li><p>查看当前内核版本</p></li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname -r</span><br></pre></td></tr></table></figure></div><ul><li>查看当前系统相关信息(内核版本号、硬件架构、主机名称和操作系统类型等)</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br></pre></td></tr></table></figure></div><ul><li>导入public key</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org</span><br></pre></td></tr></table></figure></div><ul><li>安装ELRepo到CentOS</li><li>先要进入后面的网址，<a href="http://elrepo.org/tiki/tiki-index.php" target="_blank" rel="noopener">http://elrepo.org/tiki/tiki-index.php</a> 选择要安装的ELRepo </li><li>以下是centos6需要的资源</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -Uvh http://www.elrepo.org/elrepo-release-6-8.el6.elrepo.noarch.rpm</span><br></pre></td></tr></table></figure></div><ul><li>安装 kernel-lt（lt=long-term）</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum --enablerepo=elrepo-kernel install kernel<span class="_">-lt</span> -y</span><br></pre></td></tr></table></figure></div><ul><li>编辑grub.conf文件，修改Grub引导顺序</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/grub.conf</span><br></pre></td></tr></table></figure></div><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200308123409.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200308123409.png" class="lazyload"></a></p><ul><li><p>因为一般新安装的内核在第一个位置，所以设置default=0，表示启动新内核</p></li><li><p>重启系统</p></li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shutdown -r now</span><br></pre></td></tr></table></figure></div><ul><li>再次查看内核版本，已经升级成<code>4.4.214-1.el6.elrepo.x86_64</code></li></ul><hr><ul><li><p>创建git账户，在git账户中恢复tomcat、frp、gitea服务。为了增强密码安全性，我使用KeePass软件生成了一个128位的密码。在git账户中上传备份过的tomcat9、frp、gitea，解压并配置相关文件，启动tomcat、frp、gitea并保持在后台运行。</p></li><li><p>添加MySQL自动完整备份</p></li><li><p>在/home/backup/创建autobackupmysql.sh，编辑：</p></li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">filename=`date +%Y%m%d`</span><br><span class="line">mysqldump -uroot -p密码 --all-databases &gt;/home/backup/<span class="variable">$filename</span>.sql</span><br></pre></td></tr></table></figure></div><ul><li>添加cron</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br><span class="line">0 1 * * * /home/backup/autobackupmysql.sh</span><br></pre></td></tr></table></figure></div><hr><h2 id="七、服务器安全性增强设置"><a href="#七、服务器安全性增强设置" class="headerlink" title="七、服务器安全性增强设置"></a>七、服务器安全性增强设置</h2><ul><li>主要从以下两方面入手：</li></ul><ol><li>禁止使用ssh密码方式连接，改为ssh证书连接。</li><li>配置安全策略较强的iptables策略，将iptables的INPUT,FORWARD,OUTPUT策略全部设置为DROP，即出现在所有进出站服务都要在iptables的INPUT和OUTPUT上添加记录，否则无法访问服务。</li></ol><ul><li>1.修改ssh连接方式，由于我有root和git两个账户，因此需要分别生成私钥。</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">su root</span><br><span class="line">ssh-keygen -t rsa</span><br><span class="line">cd ~&#x2F;.ssh</span><br></pre></td></tr></table></figure></div><ul><li>将公钥设置为服务器的登录公钥</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv id_rsa.pub authorized_keys</span><br></pre></td></tr></table></figure></div><ul><li>查看私钥并保存到本地</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat id_rsa</span><br></pre></td></tr></table></figure></div><ul><li>设置ssh，禁止密码登录，改用私钥登录</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure></div><ul><li>修改PasswordAuthentication 改为 no，然后重启sshd服务</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service sshd restart</span><br></pre></td></tr></table></figure></div><ul><li>再次连接使用ssh私钥即可直接登陆。其他账户的操作方法同root账户。</li></ul><hr><ul><li>2.iptable安全策略，首先将INPUT,FORWARD,OUTPUT策略全部设置为DROP（即白名单模式，不设置默认黑名单）</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iptables -P INPUT DROP</span><br><span class="line">iptables -P OUTPUT ACCEPT</span><br><span class="line">iptables -P FORWARD DROP</span><br></pre></td></tr></table></figure></div><ul><li><p>注意，上面的命令，当你执行第一条<em>iptables -P INPUT DROP</em>时，会发现你的ssh连接断开，这就说明第一条配置生效了，剩下的配置需要到主机商后台管理页面使用VNC进行连接操作。</p></li><li><p>首先开启22端口，允许其出站入站</p></li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp --dport 22 -j ACCEPT</span><br><span class="line">iptables -A OUTPUT -p tcp --sport 22 -j ACCEPT</span><br><span class="line">service iptables save</span><br><span class="line">service iptables status</span><br></pre></td></tr></table></figure></div><ul><li><p>查看iptables状态，若22端口已添加，那么断开VNC，再到我们的ssh连接软件去操作（ssh终端可以复制粘贴，VNC不能，所以尽快配置好22端口）</p></li><li><p>首先需要开放本机回环地址（127.0.0.1），即允许本机内互相访问</p></li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -i lo -j ACCEPT</span><br><span class="line">iptables -A OUTPUT -o lo -j ACCEPT</span><br><span class="line">service iptables save</span><br><span class="line">service iptables status</span><br></pre></td></tr></table></figure></div><ul><li>添加完毕后，我的服务器还需要陆续开放WEB服务所需的80、443s端口、3306数据库端口、允许ICMP包通过（ping）等等</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp --dport 80 -j ACCEPT</span><br><span class="line">iptables -A OUTPUT -p tcp --sport 80 -j ACCEPT</span><br><span class="line"></span><br><span class="line">iptables -A INPUT -p tcp --dport 443 -j ACCEPT</span><br><span class="line">iptables -A OUTPUT -p tcp --sport 443 -j ACCEPT</span><br><span class="line"></span><br><span class="line">iptables -A INPUT -p tcp --dport 3306 -j ACCEPT</span><br><span class="line">iptables -A OUTPUT -p tcp --sport 3306 -j ACCEPT</span><br><span class="line"></span><br><span class="line">iptables -A INPUT -p icmp --icmp-type <span class="built_in">echo</span>-request -j ACCEPT</span><br><span class="line">iptables -A OUTPUT -p icmp --icmp-type <span class="built_in">echo</span>-reply -j ACCEPT</span><br><span class="line"></span><br><span class="line">service iptables save</span><br><span class="line">service iptables status</span><br></pre></td></tr></table></figure></div><ul><li>配置完毕后，重启防火墙</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service iptables restart</span><br></pre></td></tr></table></figure></div><ul><li>我的服务器上运行的tomcat、gitea等服务，使用Kangle服务器提供的反向代理进行使用，即代理到127.0.0.1:port，这样更加安全，避免没必要的端口暴露。</li></ul><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200308123408.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200308123408.png" class="lazyload"></a></p><ul><li>这是我的防火墙配置</li></ul><hr><blockquote><p>到这里，服务器重装及环境的恢复总算基本完成，下一步就是进行各项功能的测试。这一次的攻击事件也使我加强了对网络安全的认识，计算机网络中无时无刻都在进行这各种扫描、嗅探、入侵，只有我们防护好自己的服务器，滴水不漏，才能保证服务器和数据服务的安全可靠。</p></blockquote><hr><hr><blockquote><p>常用路径及命令</p></blockquote><ul><li>redis官方下载地址：<a href="http://download.redis.io/releases/" target="_blank" rel="noopener">http://download.redis.io/releases/</a></li><li>redis安装——进入到安装目录，直接运行make，然后启动即可</li><li>redis安装目录：<code>/usr/local/dev/redis-3.0.5</code></li><li>redis启动 <code>nohup /usr/local/dev/redis-3.0.5/bin/redis-server /usr/local/dev/redis-3.0.5/redis.conf &amp;</code></li><li>redis测试 <code>/usr/local/dev/redis-3.0.5/bin/redis-cli</code></li><li>centos6.10添加开机自启，<code>vi /etc/rc.d/rc.local</code></li><li>环境变量文件<code>vi /etc/profile</code>,<code>source /etc/profile</code></li><li>如果上面的环境变量文件配置了不生效，则配置<code>vi /etc/bashrc</code>,<code>source /etc/bashrc</code></li><li>jdk环境配置，下载压缩包，解压到某一路径，配置profile，保存，使profile生效</li><li>springboot部署命令：<code>java -jar -Dspring.profiles.active=test demo-0.0.1-SNAPSHOT.jar</code></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Centos6-10服务器入侵-gt-重装-gt-恢复记录&quot;&gt;&lt;a href=&quot;#Centos6-10服务器入侵-gt-重装-gt-恢复记录&quot; class=&quot;headerlink&quot; title=&quot;Centos6.10服务器入侵-&amp;gt;重装-&amp;gt;恢复记录&quot;&gt;&lt;
      
    
    </summary>
    
    
    
      <category term="centos6.10" scheme="http://blog.webpro.ltd/tags/centos6-10/"/>
    
  </entry>
  
  <entry>
    <title>How To Use Git</title>
    <link href="http://blog.webpro.ltd/2020/02/10/how-to-use-git/"/>
    <id>http://blog.webpro.ltd/2020/02/10/how-to-use-git/</id>
    <published>2020-02-09T16:00:00.000Z</published>
    <updated>2020-03-10T08:11:07.396Z</updated>
    
    <content type="html"><![CDATA[<ul><li><code>git fetch</code>和<code>git pull</code>的关系图</li></ul><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309225314.jpg" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309225314.jpg" class="lazyload"></a></p><hr><h1 id="一、Git的3层结构"><a href="#一、Git的3层结构" class="headerlink" title="一、Git的3层结构"></a>一、Git的3层结构</h1><table><thead><tr><th align="left">名称</th><th align="left">解释</th></tr></thead><tbody><tr><td align="left">working directory</td><td align="left">工作区</td></tr><tr><td align="left">staging index</td><td align="left">暂存区</td></tr><tr><td align="left">git directory(Repository)</td><td align="left">版本库</td></tr></tbody></table><h1 id="二、Git中文件的4种状态基本状态"><a href="#二、Git中文件的4种状态基本状态" class="headerlink" title="二、Git中文件的4种状态基本状态"></a>二、Git中文件的4种状态基本状态</h1><table><thead><tr><th align="left">名称</th><th align="left">解释</th></tr></thead><tbody><tr><td align="left">untracked</td><td align="left">未被追踪的</td></tr><tr><td align="left">modified</td><td align="left">表示工作区修改了某个文件但是还没有添加到暂存区</td></tr><tr><td align="left">Staged</td><td align="left">表示把工作区修改的文件添加到了暂存区但是没有提交到版本库</td></tr><tr><td align="left">Committed</td><td align="left">表示数据被安全的存储在本地库中</td></tr></tbody></table><h1 id="三、vscode中文件的Git状态提示"><a href="#三、vscode中文件的Git状态提示" class="headerlink" title="三、vscode中文件的Git状态提示"></a>三、vscode中文件的Git状态提示</h1><table><thead><tr><th align="left">名称</th><th align="left">解释</th></tr></thead><tbody><tr><td align="left"><code>M</code></td><td align="left">修改了文件但没有提交到暂存区</td></tr><tr><td align="left"><code>A</code></td><td align="left">增加的文件</td></tr><tr><td align="left"><code>C</code></td><td align="left">文件的一个新拷贝</td></tr><tr><td align="left"><code>D</code></td><td align="left">删除的一个文件</td></tr><tr><td align="left"><code>M</code></td><td align="left">文件的内容或者mode被修改了</td></tr><tr><td align="left"><code>R</code></td><td align="left">文件名被修改了</td></tr><tr><td align="left"><code>T</code></td><td align="left">文件的类型被修改了</td></tr><tr><td align="left"><code>U</code></td><td align="left">文件没有被合并(你需要完成合并才能进行提交)</td></tr><tr><td align="left"><code>X</code></td><td align="left">未知状态。(很可能是遇到git的bug了，你可以向git提交bug report)</td></tr></tbody></table><h1 id="四、指令"><a href="#四、指令" class="headerlink" title="四、指令"></a>四、指令</h1><h2 id="配置指令"><a href="#配置指令" class="headerlink" title="配置指令"></a>配置指令</h2><table><thead><tr><th align="left">命令</th><th align="left">解释</th></tr></thead><tbody><tr><td align="left">git config –list</td><td align="left">查看配置信息</td></tr><tr><td align="left">git config –global user.name Bill</td><td align="left">配置用户信息姓名</td></tr><tr><td align="left">git config –global user.email <a href="mailto:xxx@mail.com">xxx@mail.com</a></td><td align="left">配置用户信息邮箱</td></tr><tr><td align="left">git log</td><td align="left">查看提交日志</td></tr><tr><td align="left">git log –oneline</td><td align="left">查看提交日志一行一条记录</td></tr></tbody></table><h2 id="Git提交"><a href="#Git提交" class="headerlink" title="Git提交"></a>Git提交</h2><table><thead><tr><th align="left">命令</th><th align="left">解释</th></tr></thead><tbody><tr><td align="left">git add fileName</td><td align="left">提交到暂存区</td></tr><tr><td align="left">git commit -m “提交信息”</td><td align="left">提交到版本库</td></tr><tr><td align="left">git commit -am “提交信息”</td><td align="left">一次性提交到版本库</td></tr><tr><td align="left">git commit –amend</td><td align="left">撤销上一次提交，并将暂存区的文件重新提交</td></tr><tr><td align="left">git checkout – fileName</td><td align="left">拉取暂存区的文件并将其替换工作区的文件</td></tr><tr><td align="left">git reset HEAD fileName</td><td align="left">拉取最近一次提交到版本库的这个文件到暂存区，该操作不影响工作区</td></tr></tbody></table><h2 id="Git删除"><a href="#Git删除" class="headerlink" title="Git删除"></a>Git删除</h2><h3 id="方法一：先在文件资源管理器中删除文件，然后-git-add"><a href="#方法一：先在文件资源管理器中删除文件，然后-git-add" class="headerlink" title="方法一：先在文件资源管理器中删除文件，然后 git add ."></a>方法一：先在文件资源管理器中删除文件，然后 git add .</h3><h3 id="方法二：git-rm-fileName"><a href="#方法二：git-rm-fileName" class="headerlink" title="方法二：git rm fileName"></a>方法二：git rm fileName</h3><table><thead><tr><th align="left">命令</th><th align="left">解释</th></tr></thead><tbody><tr><td align="left">git rm -cached fileName</td><td align="left">不小心把追踪的文件添加到暂存区，想删除暂存区的文件但是不修改工作区的文件</td></tr><tr><td align="left">git rm -f fileName</td><td align="left">工作区和暂存区都删除</td></tr></tbody></table><h2 id="Git重命名"><a href="#Git重命名" class="headerlink" title="Git重命名"></a>Git重命名</h2><h3 id="例如：修改index-html的文件名"><a href="#例如：修改index-html的文件名" class="headerlink" title="例如：修改index.html的文件名"></a>例如：修改index.html的文件名</h3><table><thead><tr><th align="left">命令</th><th align="left">解释</th></tr></thead><tbody><tr><td align="left">mv index.html index1.html</td><td align="left">一般重命名文件操作，Git会看做是删除了旧文件，新建新文件，新文件的状态是U(untracked)状态</td></tr><tr><td align="left">git mv index.html index1.html</td><td align="left">如果用git mv,Git会知道这是重命名了文件，改文件的状态是R(rename)状态</td></tr></tbody></table><h2 id="Git分支"><a href="#Git分支" class="headerlink" title="Git分支"></a>Git分支</h2><table><thead><tr><th align="left">命令</th><th align="left">解释</th></tr></thead><tbody><tr><td align="left">git branch</td><td align="left">查看分支</td></tr><tr><td align="left">git branch dev</td><td align="left">创建dev分支</td></tr><tr><td align="left">git checkout dev</td><td align="left">切换到dev分支</td></tr><tr><td align="left">git branch -d dev</td><td align="left">删除dev分支</td></tr><tr><td align="left">git branch -m dev fix</td><td align="left">修改dev分支的名称为fix</td></tr><tr><td align="left">git branch -d fix</td><td align="left">删除dev分支</td></tr><tr><td align="left">git checkout -b fix</td><td align="left">撤销删除fix分支并切换到fix分支</td></tr></tbody></table><h2 id="Git合并分支"><a href="#Git合并分支" class="headerlink" title="Git合并分支"></a>Git合并分支</h2><h3 id="先切换到-master-分支"><a href="#先切换到-master-分支" class="headerlink" title="先切换到 master 分支"></a>先切换到 master 分支</h3><table><thead><tr><th align="left">命令</th><th align="left">解释</th></tr></thead><tbody><tr><td align="left">git merge dev</td><td align="left">当前分支与dev分支合并</td></tr></tbody></table><ul><li>如果有冲突，即同一个文件同一行有不同的修改，将会提示用户手动决定用哪个版本</li><li>实际多人协作开发时，合并时为Fast-forward（快进式合并），即没有冲突</li></ul><h2 id="比较不同代码版本区别"><a href="#比较不同代码版本区别" class="headerlink" title="比较不同代码版本区别"></a>比较不同代码版本区别</h2><table><thead><tr><th align="left">命令</th><th align="left">解释</th></tr></thead><tbody><tr><td align="left">git diff</td><td align="left">比较工作区和暂存区的区别</td></tr><tr><td align="left">git diff –staged</td><td align="left">比较暂存区与版本库中的差异</td></tr><tr><td align="left">git diff hashValue1 hashValue2</td><td align="left">比较两个版本的差异</td></tr></tbody></table><ul><li>例如当前为master分支，执行 <code>git diff dev</code> 可以比较当前分支和dev分支的差异</li></ul><h2 id="git-stash"><a href="#git-stash" class="headerlink" title="git stash"></a>git stash</h2><ul><li>git stash 将当前工作去的文件暂存（不提交），然后切换分支。应用场景：当正在dev分支上开发某个项目，这时项目中出现一个bug，需要紧急修复，但是正在开发的内容只是完成一半，还不想提交，这时可以用git stash命令将修改的内容保存至堆栈区，然后顺利切换到hotfix分支进行bug修复，修复完成后，再次切回到dev分支，从堆栈中恢复刚刚保存的内容</li></ul><table><thead><tr><th align="left">命令</th><th align="left">解释</th></tr></thead><tbody><tr><td align="left">git stash list</td><td align="left">查看本地保存的代码列表</td></tr><tr><td align="left">git stash pop stash@{1}</td><td align="left">还原代码并删除本地保存</td></tr><tr><td align="left">git stash drop stash@{0}</td><td align="left">删除这个修改</td></tr></tbody></table><h2 id="Git推送"><a href="#Git推送" class="headerlink" title="Git推送"></a>Git推送</h2><table><thead><tr><th align="left">命令</th><th align="left">解释</th></tr></thead><tbody><tr><td align="left">git push <a href="https://xxx.git" target="_blank" rel="noopener">https://xxx.git</a> master</td><td align="left">将本地的当前分支推送到远程的master分支上</td></tr></tbody></table><h2 id="git-remote"><a href="#git-remote" class="headerlink" title="git remote"></a>git remote</h2><table><thead><tr><th align="left">命令</th><th align="left">解释</th></tr></thead><tbody><tr><td align="left">git remote add myStudy <a href="mailto:git@gitee.com">git@gitee.com</a>:xxx/studyGit.git</td><td align="left">myStudy指代替代仓库地址</td></tr><tr><td align="left">git remote -v</td><td align="left">查看仓库地址</td></tr><tr><td align="left">git remote remove myStudy</td><td align="left">删除添加的指代单词</td></tr></tbody></table><h2 id="Git-Tag-Release"><a href="#Git-Tag-Release" class="headerlink" title="Git Tag (Release)"></a>Git Tag (Release)</h2><table><thead><tr><th align="left">命令</th><th align="left">解释</th></tr></thead><tbody><tr><td align="left">git tag</td><td align="left">列出已有的tag</td></tr><tr><td align="left">git tag -l “v1.1”</td><td align="left">加上-l命令可以使用通配符来过滤tag</td></tr><tr><td align="left">git tag v1.0</td><td align="left">新建tag</td></tr><tr><td align="left">git tag -a tagName -m “my tag”</td><td align="left">还可以加上-a参数来创建一个带备注的tag，备注信息由-m指定</td></tr><tr><td align="left">git show tagName</td><td align="left">查看tag的详细信息，包括commit号等</td></tr><tr><td align="left">git tag -a v1.2 9fceb02 -m “my tag”</td><td align="left">打tag不必要在head之上，也可通过commit号在之前的版本上打</td></tr><tr><td align="left">git push origin v1.0</td><td align="left">将tag同步到远程服务器</td></tr><tr><td align="left">git push origin –tags</td><td align="left">推送本地所有tag</td></tr><tr><td align="left">git checkout v1.0</td><td align="left">跟分支一样，可以直接切换到某个tag去。<br>这个时候不位于任何分支，处于游离状态，可以考虑基于这个tag创建一个分支</td></tr><tr><td align="left">git tag -d v0.1.2</td><td align="left">删除某个tag，本地删除</td></tr><tr><td align="left">git push origin :refs/tags/v0.1.2</td><td align="left">远端删除</td></tr></tbody></table><h2 id="Git误删commit后的恢复方法"><a href="#Git误删commit后的恢复方法" class="headerlink" title="Git误删commit后的恢复方法"></a>Git误删commit后的恢复方法</h2><ul><li><p>1）通过git log可以查看我们之前提交的commit_id</p></li><li><p>2）复制你需要回滚的commit_id。不过windows下的命令行是不能复制文本的，为此你可以到github上查看仓库的commit历史，上面是可以直接复制的,复制好后在命令行执行：<code>git reset --hard commit_id</code></p></li><li><p>3）执行: <code>git push origin HEAD --force</code> 提交当前HEAD,这样就能够将错误的提交删除，回滚至其之前的代码</p></li><li><p>但是如果当你回滚代码以后发现commit_id复制错了或者回滚错了怎么办呢？不要慌，按下面的方法做：</p><ul><li>1）执行：<code>git reflog</code><br>  你能在命令行中看到你的历史操作，复制你要恢复操作最前面的hash值</li><li>2）执行 <code>git reset --hard hash</code> 命令中最后要输的hash就是你要恢复的历史记录最前面黄色部分的hash值<br>  比如 <code>git reset --hard 4458e09</code>，这样就成功解决问题了。</li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ul&gt;
&lt;li&gt;&lt;code&gt;git fetch&lt;/code&gt;和&lt;code&gt;git pull&lt;/code&gt;的关系图&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@maste
      
    
    </summary>
    
    
      <category term="git" scheme="http://blog.webpro.ltd/categories/git/"/>
    
    
      <category term="git" scheme="http://blog.webpro.ltd/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>vue-cli小工具 – oneLifeCache缓存</title>
    <link href="http://blog.webpro.ltd/2020/01/26/vue-cli-tool-oneLifeCache/"/>
    <id>http://blog.webpro.ltd/2020/01/26/vue-cli-tool-oneLifeCache/</id>
    <published>2020-01-25T16:00:00.000Z</published>
    <updated>2020-03-09T14:36:08.516Z</updated>
    
    <content type="html"><![CDATA[<h1 id="oneLifeCache"><a href="#oneLifeCache" class="headerlink" title="oneLifeCache"></a>oneLifeCache</h1><p>用于vue-cli的前端缓存插件</p><ul><li>vue-cli2已测试</li><li>vue-cli3未测试，理论上没问题</li></ul><blockquote><p>oneLifeCache-v2与oneLifeCache版本存在较大改动，因此要分开说明</p></blockquote><blockquote><p>挂载到vue-cli2(两版本挂载方式相同)</p></blockquote><ul><li>main.js</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// oneLifeCache</span></span><br><span class="line"><span class="keyword">import</span> oneLifeCache <span class="keyword">from</span> <span class="string">'@/utils/oneLifeCache'</span></span><br><span class="line"><span class="comment">// 挂载全局</span></span><br><span class="line"><span class="comment">// eslint-disable-next-line new-cap</span></span><br><span class="line">Vue.prototype.$cache = <span class="keyword">new</span> oneLifeCache()</span><br></pre></td></tr></table></figure></div><blockquote><h2 id="oneLifeCache-v2-版本"><a href="#oneLifeCache-v2-版本" class="headerlink" title="oneLifeCache-v2 版本"></a>oneLifeCache-v2 版本</h2></blockquote><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$cache.set(key, value)       <span class="comment">// 添加k-v；若k重复，将覆盖旧值</span></span><br><span class="line"><span class="keyword">this</span>.$cache.getAndSet(key, value) <span class="comment">// 重设k的值</span></span><br><span class="line"><span class="keyword">this</span>.$cache.getAndRemove(key)     <span class="comment">// 通过k获取值后删除之</span></span><br><span class="line"><span class="keyword">this</span>.$cache.remove(key)           <span class="comment">// 通过k删除节点</span></span><br><span class="line"><span class="keyword">this</span>.$cache.clear()               <span class="comment">// 清空缓存</span></span><br></pre></td></tr></table></figure></div><blockquote><h2 id="oneLifeCache-版本"><a href="#oneLifeCache-版本" class="headerlink" title="oneLifeCache 版本"></a>oneLifeCache 版本</h2></blockquote><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$cache.set(key, value) <span class="comment">// 添加k-v；若k重复，将添加失败</span></span><br><span class="line"><span class="keyword">this</span>.$cache.get(key)        <span class="comment">// 通过k获取值</span></span><br><span class="line"><span class="keyword">this</span>.$cache.read(key)       <span class="comment">// 通过k获取值后删除之</span></span><br><span class="line"><span class="keyword">this</span>.$cache.clear()         <span class="comment">// 清空缓存</span></span><br></pre></td></tr></table></figure></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;oneLifeCache&quot;&gt;&lt;a href=&quot;#oneLifeCache&quot; class=&quot;headerlink&quot; title=&quot;oneLifeCache&quot;&gt;&lt;/a&gt;oneLifeCache&lt;/h1&gt;&lt;p&gt;用于vue-cli的前端缓存插件&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
      
    
    </summary>
    
    
      <category term="vue-cli" scheme="http://blog.webpro.ltd/categories/vue-cli/"/>
    
    
      <category term="vue-cli2" scheme="http://blog.webpro.ltd/tags/vue-cli2/"/>
    
      <category term="vue-cli3" scheme="http://blog.webpro.ltd/tags/vue-cli3/"/>
    
  </entry>
  
  <entry>
    <title>springboot package war</title>
    <link href="http://blog.webpro.ltd/2020/01/13/springboot-package-war/"/>
    <id>http://blog.webpro.ltd/2020/01/13/springboot-package-war/</id>
    <published>2020-01-12T16:00:00.000Z</published>
    <updated>2020-03-10T08:11:29.696Z</updated>
    
    <content type="html"><![CDATA[<h1 id="为什么要打war包"><a href="#为什么要打war包" class="headerlink" title="为什么要打war包?"></a>为什么要打war包?</h1><p>springboot默认打包是jar包，通过java -xxx.jar命令可以直接跑起来。一般的jar包，每一个springboot项目运行后都有对应的Tomcat服务器启动，每个Tomcat占一个端口、jvm占用内存，尤其是多个springboot的jar包在一台服务器上，包不好管理且端口比较混乱，耗内存，不如启动一个Tomcat服务器，将springboot打成war包放到webapps下面统一运行管理，这样所有打成war包的项目都可以在同一个端口下运行。</p><h1 id="操作流程"><a href="#操作流程" class="headerlink" title="操作流程"></a>操作流程</h1><h2 id="亲测的springboot版本：2-0-6-RELEASE"><a href="#亲测的springboot版本：2-0-6-RELEASE" class="headerlink" title="亲测的springboot版本：2.0.6.RELEASE"></a>亲测的springboot版本：2.0.6.RELEASE</h2><h2 id="将pom-xml文件首部的jar改成war"><a href="#将pom-xml文件首部的jar改成war" class="headerlink" title="将pom.xml文件首部的jar改成war"></a>将pom.xml文件首部的jar改成war</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">xml</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight xml"><figcaption><span>pom.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- &lt;packaging&gt;jar&lt;/packaging&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h2 id="去除内置的Tomcat容器（a-b两种方式都可）"><a href="#去除内置的Tomcat容器（a-b两种方式都可）" class="headerlink" title="去除内置的Tomcat容器（a/b两种方式都可）"></a>去除内置的Tomcat容器（a/b两种方式都可）</h2><ul><li><p>a.去掉spring-boot-starter-tomcat(如果没有tomcat字样，忽略本步骤)</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">xml</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight xml"><figcaption><span>pom.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></div></li><li><p>b.添加依赖</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">xml</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight xml"><figcaption><span>pom.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--打包的时候可以不用包进去，别的设施会提供。事实上该依赖理论上可以参与编译，测试，运行等周期。</span></span><br><span class="line"><span class="comment">        相当于compile，但是打包阶段做了exclude操作--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></div></li></ul><h2 id="新建启动类：主要是SpringApplicationBuilder-configure-方法"><a href="#新建启动类：主要是SpringApplicationBuilder-configure-方法" class="headerlink" title="新建启动类：主要是SpringApplicationBuilder configure 方法"></a>新建启动类：主要是SpringApplicationBuilder configure 方法</h2><ul><li><p>原xxxApplication.java启动类里面的其他东西要原封不动的搬过来（比如@MapperScan等）</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">SpringBootServletInitializer</span></span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> SpringApplicationBuilder <span class="title">configure</span><span class="params">(SpringApplicationBuilder builder)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> builder.sources(App<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    SpringApplication.run(App<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li><li><p>新建该类成功后，将原来的xxxApplication.java文件保留，打开文件，将里面的代码全部注释。</p></li></ul><h2 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean package</span><br></pre></td></tr></table></figure></div><ul><li>打包完成会显示 BUILD SUCCESS,war包在target目录下</li></ul><h1 id="测试war包"><a href="#测试war包" class="headerlink" title="测试war包"></a>测试war包</h1><ul><li>在本地启动tomcat服务器，将打好的war包放到webapps目录下</li><li>访问<code>http://localhost:[端口号]/[打包项目名]/</code>进行测试</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;为什么要打war包&quot;&gt;&lt;a href=&quot;#为什么要打war包&quot; class=&quot;headerlink&quot; title=&quot;为什么要打war包?&quot;&gt;&lt;/a&gt;为什么要打war包?&lt;/h1&gt;&lt;p&gt;springboot默认打包是jar包，通过java -xxx.jar命令可以直
      
    
    </summary>
    
    
      <category term="springboot" scheme="http://blog.webpro.ltd/categories/springboot/"/>
    
    
      <category term="springboot" scheme="http://blog.webpro.ltd/tags/springboot/"/>
    
  </entry>
  
  <entry>
    <title>开发常用命令笔记</title>
    <link href="http://blog.webpro.ltd/2019/12/27/work-cmd/"/>
    <id>http://blog.webpro.ltd/2019/12/27/work-cmd/</id>
    <published>2019-12-27T13:23:23.000Z</published>
    <updated>2020-03-12T01:58:03.940Z</updated>
    
    <content type="html"><![CDATA[<h2 id="centos6-10配置jdk8"><a href="#centos6-10配置jdk8" class="headerlink" title="centos6.10配置jdk8"></a>centos6.10配置jdk8</h2><h3 id="1、下载JDK"><a href="#1、下载JDK" class="headerlink" title="1、下载JDK"></a>1、下载JDK</h3><p>这里选择JDK8，去官网下载即可。<br>jdk-8u11-linux-i586.tar.gz</p><h3 id="2、上传到服务器，解压"><a href="#2、上传到服务器，解压" class="headerlink" title="2、上传到服务器，解压"></a>2、上传到服务器，解压</h3><p>通过ssh，将<code>jdk-8u11-linux-i586.tar.gz</code>放到<code>/usr/local</code>下。<br>解压：</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xzvf jdk-8u11-linux-i586.tar.gz</span><br></pre></td></tr></table></figure></div><h3 id="3、配置环境变量"><a href="#3、配置环境变量" class="headerlink" title="3、配置环境变量"></a>3、配置环境变量</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile</span><br></pre></td></tr></table></figure></div><p>文件末尾追加如下内容：（路径根据自己的实际情况修改）</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># set java environment</span></span><br><span class="line">JAVA_HOME=/usr/<span class="built_in">local</span>/jdk1.8.0_11</span><br><span class="line">JRE_HOME=/usr/<span class="built_in">local</span>/jdk1.8.0_11/jre</span><br><span class="line">CLASS_PATH=.:<span class="variable">$JAVA_HOME</span>/lib/dt.jar:<span class="variable">$JAVA_HOME</span>/lib/tools.jar:<span class="variable">$JRE_HOME</span>/lib</span><br><span class="line">PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$JRE_HOME</span>/bin</span><br><span class="line"><span class="built_in">export</span> JAVA_HOME JRE_HOME CLASS_PATH PATH</span><br></pre></td></tr></table></figure></div><h3 id="4、配置文件生效"><a href="#4、配置文件生效" class="headerlink" title="4、配置文件生效"></a>4、配置文件生效</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure></div><h3 id="5、查看jdk版本"><a href="#5、查看jdk版本" class="headerlink" title="5、查看jdk版本"></a>5、查看jdk版本</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure></div><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200308123652.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200308123652.png" class="lazyload"></a></p><hr><h2 id="vue-cli2"><a href="#vue-cli2" class="headerlink" title="vue-cli2"></a>vue-cli2</h2><ul><li>创建项目/脚手架<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue init webpack project-name</span><br></pre></td></tr></table></figure></div></li></ul><h3 id="启动项目"><a href="#启动项目" class="headerlink" title="启动项目"></a>启动项目</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure></div><h3 id="编译（打包）项目"><a href="#编译（打包）项目" class="headerlink" title="编译（打包）项目"></a>编译（打包）项目</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure></div><h3 id="安装HTTP请求"><a href="#安装HTTP请求" class="headerlink" title="安装HTTP请求"></a>安装HTTP请求</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save vue-resource</span><br></pre></td></tr></table></figure></div><h3 id="安装路由"><a href="#安装路由" class="headerlink" title="安装路由"></a>安装路由</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save vue-router</span><br></pre></td></tr></table></figure></div><h3 id="安装axios"><a href="#安装axios" class="headerlink" title="安装axios"></a>安装axios</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install axios</span><br><span class="line">npm install --save axios</span><br></pre></td></tr></table></figure></div><hr><h2 id="vue-cli3"><a href="#vue-cli3" class="headerlink" title="vue-cli3"></a>vue-cli3</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">创建项目/脚手架</span><br><span class="line">vue create project-name</span><br></pre></td></tr></table></figure></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;centos6-10配置jdk8&quot;&gt;&lt;a href=&quot;#centos6-10配置jdk8&quot; class=&quot;headerlink&quot; title=&quot;centos6.10配置jdk8&quot;&gt;&lt;/a&gt;centos6.10配置jdk8&lt;/h2&gt;&lt;h3 id=&quot;1、下载JDK&quot;&gt;
      
    
    </summary>
    
    
    
      <category term="centos6.10" scheme="http://blog.webpro.ltd/tags/centos6-10/"/>
    
  </entry>
  
  <entry>
    <title>Linux c 程序设计考试 复习</title>
    <link href="http://blog.webpro.ltd/2019/08/09/Linux-c-review1/"/>
    <id>http://blog.webpro.ltd/2019/08/09/Linux-c-review1/</id>
    <published>2019-08-08T16:00:00.000Z</published>
    <updated>2020-03-12T02:13:47.850Z</updated>
    
    <content type="html"><![CDATA[<h1 id="匹配字符串在文件中出现的行号"><a href="#匹配字符串在文件中出现的行号" class="headerlink" title="匹配字符串在文件中出现的行号"></a>匹配字符串在文件中出现的行号</h1><blockquote><p>打开一文本文件，给出字符串(char *pattern)在文件哪些行出现过，在屏幕上显示匹配的行号和该行文本。</p></blockquote><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><figcaption><span>findstr.c</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">computed</span><span class="params">(FILE *fd, <span class="keyword">char</span> *pattern)</span></span>&#123;</span><br><span class="line">    <span class="comment">// windows 中 换行符为 \r\n</span></span><br><span class="line">    <span class="comment">// unix 中 换行符为 \n</span></span><br><span class="line">    <span class="comment">// 因此可以使用 \n 作为统一换行标志</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> ch;                            <span class="comment">// 单字符缓存</span></span><br><span class="line">    <span class="keyword">int</span> line = <span class="number">1</span>;                       <span class="comment">// 当前行数</span></span><br><span class="line">    <span class="keyword">char</span> current_line_content[<span class="number">256</span>];     <span class="comment">// 当前行字符串缓存</span></span><br><span class="line">    <span class="keyword">int</span> temp_idx = <span class="number">0</span>;                   <span class="comment">// 当前行的匹配列数</span></span><br><span class="line">    <span class="keyword">int</span> current_idx = <span class="number">0</span>;                <span class="comment">// 当前行的列数</span></span><br><span class="line">    <span class="keyword">int</span> current_status = <span class="number">0</span>;             <span class="comment">// 当前行无匹配成功状态 当一行中有一个匹配后，就不再对其后面的字符串进行比较了</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>((ch = fgetc(fd)) != EOF)&#123;</span><br><span class="line">        <span class="comment">// 换行后行数+1</span></span><br><span class="line">        <span class="keyword">if</span>(ch == <span class="string">'\n'</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(current_status)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"line[%d], content[%s]\n"</span>, line, current_line_content);</span><br><span class="line">                current_status = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            line++;</span><br><span class="line">            <span class="built_in">memset</span>(current_line_content, <span class="number">0</span>, <span class="keyword">sizeof</span>(current_line_content));</span><br><span class="line">            current_idx = <span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(ch == <span class="string">'\r'</span>)&#123;</span><br><span class="line">            <span class="comment">// 对于win系统忽略掉\r</span></span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            current_line_content[current_idx] = ch;</span><br><span class="line">            current_idx++;</span><br><span class="line">            <span class="keyword">if</span>(!current_status)&#123;</span><br><span class="line">                <span class="keyword">if</span>(ch == pattern[temp_idx])&#123;</span><br><span class="line">                    temp_idx++;</span><br><span class="line">                    <span class="keyword">if</span>(pattern[temp_idx] == <span class="string">'\0'</span>)&#123;</span><br><span class="line">                        <span class="comment">// 匹配成功</span></span><br><span class="line">                        temp_idx = <span class="number">0</span>;</span><br><span class="line">                        current_status = <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="comment">// 不匹配从头来</span></span><br><span class="line">                    temp_idx = <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(argc != <span class="number">3</span>)&#123;</span><br><span class="line">        <span class="comment">// 第 0 个参数是运行的文件名</span></span><br><span class="line">        perror(<span class="string">"请传参: ./main filename pattern"</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span>* file_name = (<span class="keyword">char</span>*)argv[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">char</span>* pattern   = (<span class="keyword">char</span>*)argv[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">    FILE *fd;     <span class="comment">// 文件句柄</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>((fd = fopen(file_name, <span class="string">"r"</span>)) == <span class="literal">NULL</span>)&#123;</span><br><span class="line">        perror(<span class="string">"文件打开失败"</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    computed(fd, pattern);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="测试匹配的文件：find"><a href="#测试匹配的文件：find" class="headerlink" title="测试匹配的文件：find"></a>测试匹配的文件：find</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">html</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight html"><figcaption><span>file find</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Mr. liu, would you care for another helping?</span><br><span class="line">No more, thank you. I'm quite full.</span><br><span class="line">Did you enjoy the meal?</span><br><span class="line">I'm so glad you like it.</span><br><span class="line">Thank you very much for your hospitality.</span><br></pre></td></tr></table></figure></div><h2 id="编译程序"><a href="#编译程序" class="headerlink" title="编译程序"></a>编译程序</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g++ -o findstr findstr.c</span><br></pre></td></tr></table></figure></div><h2 id="测试1-在find文件中查找包含you字符串的行并输出"><a href="#测试1-在find文件中查找包含you字符串的行并输出" class="headerlink" title="测试1 在find文件中查找包含you字符串的行并输出"></a>测试1 在find文件中查找包含you字符串的行并输出</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-P9B04K1:/mnt/d/phpStudy/WWW/vsCode/linux/c/<span class="built_in">test</span><span class="comment"># ./findstr find you</span></span><br><span class="line">line[1], content[Mr. liu, would you care <span class="keyword">for</span> another helping?]</span><br><span class="line">line[2], content[No more, thank you. I<span class="string">'m quite full.]</span></span><br><span class="line"><span class="string">line[3], content[Did you enjoy the meal?]</span></span><br><span class="line"><span class="string">line[4], content[I'</span>m so glad you like it.]</span><br><span class="line">line[5], content[Thank you very much <span class="keyword">for</span> your hospitality.]</span><br></pre></td></tr></table></figure></div><h2 id="测试2-在find文件中查找包含Mr字符串的行并输出"><a href="#测试2-在find文件中查找包含Mr字符串的行并输出" class="headerlink" title="测试2 在find文件中查找包含Mr字符串的行并输出"></a>测试2 在find文件中查找包含Mr字符串的行并输出</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-P9B04K1:/mnt/d/phpStudy/WWW/vsCode/linux/c/<span class="built_in">test</span><span class="comment"># ./findstr find Mr</span></span><br><span class="line">line[1], content[Mr. liu, would you care <span class="keyword">for</span> another helping?]</span><br></pre></td></tr></table></figure></div><h2 id="测试3-输入一个不存在的文件"><a href="#测试3-输入一个不存在的文件" class="headerlink" title="测试3 输入一个不存在的文件"></a>测试3 输入一个不存在的文件</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-P9B04K1:/mnt/d/phpStudy/WWW/vsCode/linux/c/<span class="built_in">test</span><span class="comment"># ./findstr find2 you</span></span><br><span class="line">文件打开失败: No such file or directory</span><br></pre></td></tr></table></figure></div><h2 id="测试4-输入错误的参数个数"><a href="#测试4-输入错误的参数个数" class="headerlink" title="测试4 输入错误的参数个数"></a>测试4 输入错误的参数个数</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-P9B04K1:/mnt/d/phpStudy/WWW/vsCode/linux/c/<span class="built_in">test</span><span class="comment"># ./findstr find</span></span><br><span class="line">请传参: ./main filename pattern: Success</span><br></pre></td></tr></table></figure></div><h1 id="父子进程管道通讯"><a href="#父子进程管道通讯" class="headerlink" title="父子进程管道通讯"></a>父子进程管道通讯</h1><h2 id="方式1-重定向I-O"><a href="#方式1-重定向I-O" class="headerlink" title="方式1 重定向I/O"></a>方式1 重定向I/O</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">cpp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight cpp"><figcaption><span>pipe1.c</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;limits.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fd[<span class="number">2</span>]; <span class="comment">// fd[0]为读 fd[1]为写</span></span><br><span class="line">    <span class="keyword">pid_t</span> pid;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*创建管道 */</span></span><br><span class="line">    <span class="keyword">if</span>(pipe(fd) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        perror(<span class="string">"fail to pipe"</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*创建子进程 */</span></span><br><span class="line">    <span class="keyword">if</span>((pid = fork()) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        perror(<span class="string">"fail to fork"</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(pid != <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="comment">// 父进程</span></span><br><span class="line">        close(fd[<span class="number">0</span>]);</span><br><span class="line">        dup(fd[<span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"我是父进程"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">// 子进程</span></span><br><span class="line">        close(fd[<span class="number">1</span>]);</span><br><span class="line">        dup(fd[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">char</span> str[<span class="number">256</span>];</span><br><span class="line">        fgets(str, <span class="keyword">sizeof</span>(str), <span class="built_in">stdin</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%s\n"</span>, str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="测试运行"><a href="#测试运行" class="headerlink" title="测试运行"></a>测试运行</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-P9B04K1:/mnt/d/phpStudy/WWW/vsCode/linux/c/<span class="built_in">test</span><span class="comment"># ./run pipe1</span></span><br><span class="line"></span><br><span class="line">--------- project pipe1 start ---------</span><br><span class="line"></span><br><span class="line">我是父进程</span><br><span class="line">--------- project pipe1 end ---------</span><br></pre></td></tr></table></figure></div><h2 id="附：run脚本代码-兼容运行带MySQL操作头的代码编译"><a href="#附：run脚本代码-兼容运行带MySQL操作头的代码编译" class="headerlink" title="附：run脚本代码(兼容运行带MySQL操作头的代码编译)"></a>附：run脚本代码(兼容运行带MySQL操作头的代码编译)</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"\n--------- project <span class="variable">$1</span> start ---------\n"</span></span><br><span class="line">g++ -o <span class="variable">$1</span> <span class="variable">$1</span>.c `mysql_config --cflags --libs`;./<span class="variable">$1</span>;<span class="built_in">echo</span> <span class="string">"\n--------- project <span class="variable">$1</span> end ---------\n"</span></span><br><span class="line">rm <span class="variable">$1</span>;</span><br></pre></td></tr></table></figure></div><h1 id="ls-l命令结果说明"><a href="#ls-l命令结果说明" class="headerlink" title="ls -l命令结果说明"></a>ls -l命令结果说明</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><figcaption><span>例如</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@webpro1 VmwareShare]<span class="comment"># ls -l</span></span><br><span class="line">总用量 88</span><br><span class="line">-rwxrwxrwx. 1 root root 88204 8月   9 08:49 mlocate.rpm</span><br><span class="line">-rwxrwxrwx. 1 root root    56 8月   9 09:07 <span class="built_in">test</span></span><br><span class="line">-rwxrwxrwx. 1 root root     7 8月   8 12:20 新文件~</span><br><span class="line">-rwxrwxrwx. 1 root root    15 8月   8 20:02 新文件.txt</span><br></pre></td></tr></table></figure></div><ul><li>对于 - rwx  rwx  rwx 的第一列：</li></ul><table><thead><tr><th align="left">第一个属性</th><th align="left">文件类型</th></tr></thead><tbody><tr><td align="left">-</td><td align="left">Linux中最多的一种文件类型<br>包括纯文本文件(ASCII)；二进制文件(binary)；数据格式的文件(data);各种压缩文件。</td></tr><tr><td align="left">d</td><td align="left">二，目录文件类型</td></tr><tr><td align="left">c</td><td align="left">串行端口的接口设备，例如键盘、鼠标等等</td></tr><tr><td align="left">b</td><td align="left">可随机存储装置。<br>存储数据以供系统存取的接口设备，简单而言就是硬盘。<br>例如一号硬盘的代码是 /dev/hda1等文件</td></tr><tr><td align="left">s</td><td align="left">套接字文件，这类文件通常用在网络数据连接。<br>可以启动一个程序来监听客户端的要求，客户端就可以通过套接字来进行数据通信，最常在var/run目录中看到这种文件类型。</td></tr><tr><td align="left">p</td><td align="left">管道文件。FIFO也是一种特殊的文件类型，它主要的目的是，解决多个程序同时存取一个文件所造成的错误。FIFO是first-in-first-out(先进先出)的缩写。第一个属性为</td></tr><tr><td align="left">l</td><td align="left">链接文件，类似Windows下面的快捷方式。第一个属性为 [l]，例如 [lrwxrwxrwx]。</td></tr></tbody></table><ul><li><p>对于 - rwx  rwx  rwx 的第二、三、四列：</p></li><li><p>第二、三、四列分别代表拥有者 、群组 、其它组的权限设定</p></li><li><p>权限：rwx</p><ul><li>r - 读</li><li>w - 写</li><li>x - 运行</li></ul></li><li><p>rwx对应的数字</p></li></ul><table><thead><tr><th>标志字母</th><th>代表数字</th></tr></thead><tbody><tr><td>r</td><td>4</td></tr><tr><td>w</td><td>2</td></tr><tr><td>x</td><td>1</td></tr></tbody></table><ul><li>如何计算并设置权限<ul><li>常见的权限表示形式有：<ul><li>-rw——- (600)      只有拥有者有读写权限。</li><li>-rw-r–r– (644)      只有拥有者有读写权限；而属组用户和其他用户只有读权限。</li><li>-rwx—— (700)     只有拥有者有读、写、执行权限。</li><li>-rwxr-xr-x (755)    拥有者有读、写、执行权限；而属组用户和其他用户只有读、执行权限。</li><li>-rwx–x–x (711)    拥有者有读、写、执行权限；而属组用户和其他用户只有执行权限。</li><li>-rw-rw-rw- (666)   所有用户都有文件读、写权限。</li><li>-rwxrwxrwx (777)  所有用户都有读、写、执行权限。</li></ul></li><li>例1:<code>rw-------</code><table><thead><tr><th align="left">拥有者</th><th align="left">群组</th><th align="left">其它组</th></tr></thead><tbody><tr><td align="left">rw-</td><td align="left">—</td><td align="left">—</td></tr><tr><td align="left">4+2+0</td><td align="left">0+0+0</td><td align="left">0+0+0</td></tr><tr><td align="left">6</td><td align="left">0</td><td align="left">0</td></tr></tbody></table></li><li>例2:<code>rw-r--r--</code><table><thead><tr><th align="left">拥有者</th><th align="left">群组</th><th align="left">其它组</th></tr></thead><tbody><tr><td align="left">rw-</td><td align="left">r–</td><td align="left">r–</td></tr><tr><td align="left">4+2+0</td><td align="left">4+0+0</td><td align="left">4+0+0</td></tr><tr><td align="left">6</td><td align="left">4</td><td align="left">4</td></tr></tbody></table></li><li>例3:<code>rwxrwxrwx</code><table><thead><tr><th align="left">拥有者</th><th align="left">群组</th><th align="left">其它组</th></tr></thead><tbody><tr><td align="left">rwx</td><td align="left">rwx</td><td align="left">rwx</td></tr><tr><td align="left">4+2+1</td><td align="left">4+2+1</td><td align="left">4+2+1</td></tr><tr><td align="left">7</td><td align="left">7</td><td align="left">7</td></tr></tbody></table></li></ul></li></ul><h1 id="reboot和init6之间的区别"><a href="#reboot和init6之间的区别" class="headerlink" title="reboot和init6之间的区别"></a>reboot和init6之间的区别</h1><ul><li><p>Linux中重启的两个命令：reboot和init6之间的区别</p></li><li><p>Init 6是重新启动机器； reboot也是重新启动机器；</p></li><li><p>那这两个命令到底有什么区别呢？</p><ul><li><p>对这两个操作使用man命令看到的内容如下：</p><ul><li><p>“init 6” 基于一系列/etc/inittab文件，并且每个应用都会有一个相应shutdown脚本。</p></li><li><p>“init 6”调用一系列shutdown脚本(/etc/rc0.d/K*)来使系统优雅关机;</p></li><li><p>‘reboot’并不执行这些过程，reboot更是一个kernel级别的命令，</p></li><li><p>不对应用使用shutdown脚本。</p></li><li><p>reboot - reboot performs a sync(1M) operation on the disks, andthen amulti- user reboot is initiated. See init(1M) fordetails.init 6 Stop the operating system and reboot to the state defined by the initdefault entry in /etc/inittab.</p></li><li><p>我们应该在通常情况下使用 init 6.</p></li><li><p>在出问题的状况下或强制重启时使用reboot</p></li></ul></li></ul></li></ul><ul><li><p>Linux系统有7个运行级别(runlevel)：</p><ul><li><p>运行级别0：系统停机状态，系统默认运行级别不能设为0，否则不能正常启动</p></li><li><p>运行级别1：单用户工作状态，root权限，用于系统维护，禁止远程登陆</p></li><li><p>运行级别2：多用户状态(没有NFS)</p></li><li><p>运行级别3：完全的多用户状态(有NFS)，登陆后进入控制台命令行模式</p></li><li><p>运行级别4：系统未使用，保留</p></li><li><p>运行级别5：X11控制台，登陆后进入图形GUI模式</p></li><li><p>运行级别6：系统正常关闭并重启，默认运行级别不能设为6，否则不能正常启动</p></li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;匹配字符串在文件中出现的行号&quot;&gt;&lt;a href=&quot;#匹配字符串在文件中出现的行号&quot; class=&quot;headerlink&quot; title=&quot;匹配字符串在文件中出现的行号&quot;&gt;&lt;/a&gt;匹配字符串在文件中出现的行号&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;打开一文本文件，给
      
    
    </summary>
    
    
      <category term="linux" scheme="http://blog.webpro.ltd/categories/linux/"/>
    
    
      <category term="linux" scheme="http://blog.webpro.ltd/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>写个网站流量统计插件</title>
    <link href="http://blog.webpro.ltd/2019/05/29/get-my-site-pageview/"/>
    <id>http://blog.webpro.ltd/2019/05/29/get-my-site-pageview/</id>
    <published>2019-05-28T16:00:00.000Z</published>
    <updated>2020-03-12T01:56:21.224Z</updated>
    
    <content type="html"><![CDATA[<h1 id="插件效果"><a href="#插件效果" class="headerlink" title="插件效果"></a>插件效果</h1><ul><li>闲来无事写个简易网站流量统计插件:</li><li>开发用到: php mysql js html</li><li>效果如下</li></ul><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200310162203.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200310162203.png" class="lazyload"></a></p><ul><li><input checked disabled type="checkbox"> 简易的流量统计插件，数据大致参考即可，没有高级算法，仅统计下IP和PV</li><li><input checked disabled type="checkbox"> 不防刷，用软件数据分分钟刷上去</li><li><input checked disabled type="checkbox"> 插件非常轻，对网站加载速度影响大概在5ms左右</li></ul><h1 id="统计数据分析"><a href="#统计数据分析" class="headerlink" title="统计数据分析"></a>统计数据分析</h1><ol><li>今日IP</li><li>今日PV</li><li>昨日IP</li><li>昨日PV</li><li>当前在线</li></ol><h1 id="计算方法"><a href="#计算方法" class="headerlink" title="计算方法"></a>计算方法</h1><h2 id="如何准确获取到客户端IP"><a href="#如何准确获取到客户端IP" class="headerlink" title="如何准确获取到客户端IP"></a>如何准确获取到客户端IP</h2><blockquote><p>统计IP需要获取到客户端真实的IP地址，仅js实现效果并不好。在这里我采用了[搜狐]的接口</p></blockquote><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">"https://pv.sohu.com/cityjson?ie=utf-8"</span>&gt;&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure></div><h3 id="将搜狐提供的js嵌入到网页，访问结果如下"><a href="#将搜狐提供的js嵌入到网页，访问结果如下" class="headerlink" title="将搜狐提供的js嵌入到网页，访问结果如下:"></a>将搜狐提供的js嵌入到网页，访问结果如下:</h3><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200310162450.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200310162450.png" class="lazyload"></a></p><ul><li>直接返回了一个 returnCitySN 对象，我们可以获得准确的IP地址、cid(cid是什么给我留言)、地区</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> returnCitySN = &#123;<span class="string">"cip"</span>: <span class="string">"223.241.141.73"</span>, <span class="string">"cid"</span>: <span class="string">"340000"</span>, <span class="string">"cname"</span>: <span class="string">"安徽省"</span>&#125;;</span><br></pre></td></tr></table></figure></div><h3 id="通过returnCitySN获取ip、cname"><a href="#通过returnCitySN获取ip、cname" class="headerlink" title="通过returnCitySN获取ip、cname"></a>通过returnCitySN获取ip、cname</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ip = returnCitySN.cip;</span><br><span class="line"><span class="keyword">var</span> cname = returnCitySN.cname;</span><br></pre></td></tr></table></figure></div><blockquote><p>至此，IP已经拿到</p></blockquote><h2 id="后端存储方法"><a href="#后端存储方法" class="headerlink" title="后端存储方法"></a>后端存储方法</h2><ul><li>前端将IP、cname、访问的url传输到后端</li></ul><h3 id="wnzz-visit表（直接存储访问记录）"><a href="#wnzz-visit表（直接存储访问记录）" class="headerlink" title="wnzz_visit表（直接存储访问记录）"></a>wnzz_visit表（直接存储访问记录）</h3><table><thead><tr><th>键名</th><th>说明</th><th>类型</th></tr></thead><tbody><tr><td>id</td><td>自动编号</td><td>int11</td></tr><tr><td>ip</td><td>ip地址</td><td>varchar128</td></tr><tr><td>cname</td><td>地区</td><td>varchar255</td></tr><tr><td>url</td><td>访问地址</td><td>varchar255</td></tr><tr><td>time</td><td>访问时间戳</td><td>int11</td></tr><tr><td>siteid</td><td>统计站点编号</td><td>int11</td></tr></tbody></table><ul><li>字段 siteid，用来标记和区分不同的站点，这样可以实现多站点统计，只需要确保siteid不重复即可</li></ul><h3 id="wnzz-cal表（聚合一天的数据，存储计算结果）"><a href="#wnzz-cal表（聚合一天的数据，存储计算结果）" class="headerlink" title="wnzz_cal表（聚合一天的数据，存储计算结果）"></a>wnzz_cal表（聚合一天的数据，存储计算结果）</h3><ul><li>该表的作用是，当某一天已经过去时，自动计算某一天IP和PV总值，记录在这个表中</li></ul><blockquote><p>为什么需要这个表？因为当日统计的IP和PV都是动态计算的，php从数据库读出所有访问的数据，然后再对数据进行统计，如此方法加大了服务器的开销，所以对于一些不必要的重复计算，我们计算一次，存储其即可，下次需要直接读取。</p></blockquote><table><thead><tr><th>键名</th><th>说明</th><th>类型</th></tr></thead><tbody><tr><td>id</td><td>自动编号</td><td>int11</td></tr><tr><td>timestamp</td><td>某一天0点的时间戳</td><td>int11</td></tr><tr><td>timestr</td><td>某一天用字符表示，例如2019-05-05</td><td>varchar255</td></tr><tr><td>ips</td><td>IP总数</td><td>int11</td></tr><tr><td>pvs</td><td>PV总数</td><td>int11</td></tr><tr><td>siteid</td><td>统计站点编号</td><td>int11</td></tr></tbody></table><h2 id="计算IP、PV"><a href="#计算IP、PV" class="headerlink" title="计算IP、PV"></a>计算IP、PV</h2><ul><li><p>首先需要确认 siteid 和统计事件的区间</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//设置北京时间为默认时区</span></span><br><span class="line">date_default_timezone_set(<span class="string">'PRC'</span>);</span><br><span class="line"><span class="comment">// 现在的时间戳</span></span><br><span class="line">$now = time();</span><br><span class="line"><span class="comment">// 现在对应今日0点的时间戳</span></span><br><span class="line">$today = strtotime(date(<span class="string">"Y-m-d"</span>), $now);</span><br><span class="line"><span class="comment">// 现在对应昨日0点的时间戳</span></span><br><span class="line">$yesterday = $today - <span class="number">86400</span>;</span><br><span class="line"><span class="comment">// 现在对应明日0点的时间戳</span></span><br><span class="line">$tomorrow = $today + <span class="number">86400</span>;</span><br></pre></td></tr></table></figure></div></li><li><p>动态统计一下今天的数据，即 <code>today&lt;=time&lt;tomorrow</code>，执行如下sql语句</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- 原生SQL写法</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="string">`wnzz_visit`</span> <span class="keyword">WHERE</span> <span class="string">`time`</span>&gt;&#123;$today&#125; <span class="keyword">AND</span> <span class="string">`time`</span>&lt;&#123;$tomorrow&#125; <span class="keyword">AND</span> <span class="string">`siteid`</span>=&#123;$siteid&#125;;</span><br></pre></td></tr></table></figure></div></li><li><p>持久层框架写法(下面提供)</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$res_t = $bean-&gt;findByX([<span class="string">'ip'</span>], <span class="string">"wnzz_visit"</span>, [<span class="string">"time&gt;&#123;$today&#125;"</span>, <span class="string">"time&lt;&#123;$tomorrow&#125;"</span>, <span class="string">"siteid=&#123;$siteid&#125;"</span>]);</span><br></pre></td></tr></table></figure></div></li><li><p>从数据库读出的数据形如如下:</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">datas&#x3D;&gt;[</span><br><span class="line"></span><br><span class="line">    [&quot;ip&quot;&#x3D;&gt;&quot;127.0.0.1&quot;],</span><br><span class="line"></span><br><span class="line">    [&quot;ip&quot;&#x3D;&gt;&quot;127.0.0.1&quot;],</span><br><span class="line"></span><br><span class="line">    [&quot;ip&quot;&#x3D;&gt;&quot;127.0.0.1&quot;],</span><br><span class="line"></span><br><span class="line">    [&quot;ip&quot;&#x3D;&gt;&quot;127.0.0.2&quot;],</span><br><span class="line"></span><br><span class="line">    [&quot;ip&quot;&#x3D;&gt;&quot;127.0.0.2&quot;],</span><br><span class="line"></span><br><span class="line">    [&quot;ip&quot;&#x3D;&gt;&quot;127.0.0.2&quot;],</span><br><span class="line"></span><br><span class="line">    [&quot;ip&quot;&#x3D;&gt;&quot;127.0.0.3&quot;]</span><br><span class="line"></span><br><span class="line">]</span><br></pre></td></tr></table></figure></div></li></ul><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200310163423.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200310163423.png" class="lazyload"></a></p><ul><li>用PHP实现<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> array(ips, pvs)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cal_ipandpv</span><span class="params">($datas)</span></span>&#123;</span><br><span class="line">    <span class="comment">// echo "emmm&lt;br/&gt;";</span></span><br><span class="line">    <span class="comment">// print_r($datas);</span></span><br><span class="line">    <span class="comment">// $ip['192.168.1.1'] = 10;</span></span><br><span class="line">    $ip = <span class="keyword">array</span>();</span><br><span class="line">    <span class="keyword">foreach</span>($datas <span class="keyword">as</span> $index =&gt; $item)&#123;</span><br><span class="line">        <span class="keyword">if</span>(array_key_exists($item[<span class="string">'ip'</span>], $ip))&#123;</span><br><span class="line">            <span class="comment">// 统计过</span></span><br><span class="line">            $ip[$item[<span class="string">'ip'</span>]] += <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">// 没统计过</span></span><br><span class="line">            $ip[$item[<span class="string">'ip'</span>]] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 累加IP和PV</span></span><br><span class="line">    $ips = <span class="number">0</span>;</span><br><span class="line">    $pvs = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">foreach</span>($ip <span class="keyword">as</span> $keyip =&gt; $count)&#123;</span><br><span class="line">        $ips++;</span><br><span class="line">        $pvs += $count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> [$ips, $pvs];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li></ul><h2 id="计算当前在线人数"><a href="#计算当前在线人数" class="headerlink" title="计算当前在线人数"></a>计算当前在线人数</h2><ul><li><p>访问记录在十分钟以内的即算作在线</p></li><li><p>SQL语句</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">sql</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="string">`wnzz_visit`</span> <span class="keyword">WHERE</span> <span class="string">`time`</span>&gt;&#123;$onlineMin &#125; <span class="keyword">AND</span> <span class="string">`siteid`</span>=&#123;$siteid&#125;;</span><br></pre></td></tr></table></figure></div></li></ul><h1 id="插件总体代码实现"><a href="#插件总体代码实现" class="headerlink" title="插件总体代码实现"></a>插件总体代码实现</h1><h2 id="前端（js）"><a href="#前端（js）" class="headerlink" title="前端（js）"></a>前端（js）</h2><ul><li><p>domain变量是后端接口地址，这里我开发用的本地IP</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://pv.sohu.com/cityjson?ie=utf-8</span></span><br><span class="line"><span class="keyword">var</span> domain = <span class="string">"http://127.0.0.1/vsCode/wnzz/"</span>;</span><br><span class="line"><span class="keyword">var</span> url = <span class="built_in">window</span>.location.href;</span><br><span class="line"><span class="keyword">var</span> siteid = <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line">$.<span class="keyword">get</span>(domain + "?ip=" + returnCitySN["cip"] + "&amp;cname=" + returnCitySN["cname"] + "&amp;url=" + url + "&amp;siteid=" + siteid, function(result)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(result);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$.<span class="keyword">get</span>(domain + "?act=<span class="keyword">get</span>&amp;siteid=" + siteid, function(result)&#123;</span><br><span class="line">    $(<span class="string">"#wnzz"</span>).text(result);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div></li><li><p>在引入上面的脚本之前要先引入jQuery库和下面的搜狐库</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">html</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://pv.sohu.com/cityjson?ie=utf-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div></li><li><p>访问结果会显示在ID为wnzz的标签中</p></li></ul><h2 id="后端"><a href="#后端" class="headerlink" title="后端"></a>后端</h2><ul><li><p>后端使用PHP</p></li><li><p>在下面的代码之前需要引用<a href="/pan/BeanANDTools.zip">Bean.class.php、Tools.class.php</a>，下载之后直接引用。即可以下为wnzz服务端接口</p></li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// ============================ //</span></span><br><span class="line"><span class="comment">//                              //</span></span><br><span class="line"><span class="comment">//        数据库参数配置         //</span></span><br><span class="line"><span class="comment">//                              //</span></span><br><span class="line"><span class="comment">// ============================ //</span></span><br><span class="line">define(<span class="string">"DB_HOST"</span>, <span class="string">"127.0.0.1"</span>);</span><br><span class="line"><span class="comment">// 数据库地址</span></span><br><span class="line">define(<span class="string">"DB_USER"</span>, <span class="string">"root"</span>);</span><br><span class="line"><span class="comment">// 数据库用户名</span></span><br><span class="line">define(<span class="string">"DB_PASSWD"</span>, <span class="string">"root"</span>);</span><br><span class="line"><span class="comment">// 数据库密码</span></span><br><span class="line">define(<span class="string">"DB_NAME"</span>, <span class="string">"wnzz"</span>);</span><br><span class="line"><span class="comment">// 数据库名</span></span><br><span class="line"><span class="comment">//设置北京时间为默认时区</span></span><br><span class="line">date_default_timezone_set(<span class="string">'PRC'</span>);</span><br><span class="line"><span class="comment">//输出当前时间</span></span><br><span class="line"><span class="comment">// echo date("Y-m-d H:i:s",time());  //2016-08-11 10:30:32</span></span><br><span class="line"><span class="comment">//获得当日凌晨的时间戳</span></span><br><span class="line"><span class="comment">// $today = strtotime(date("Y-m-d"),time());</span></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">"./Tools.class.php"</span>;</span><br><span class="line"><span class="keyword">require_once</span> <span class="string">"./Bean.class.php"</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ip</span></span><br><span class="line"><span class="comment"> * cname</span></span><br><span class="line"><span class="comment"> * url</span></span><br><span class="line"><span class="comment"> * siteid</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">siteid </span></span><br><span class="line"><span class="comment">1000-1999 我的字段</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// 存储访客数据</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'ip'</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">'cname'</span>]) &amp;&amp; $_GET[<span class="string">'url'</span>] &amp;&amp; $_GET[<span class="string">'siteid'</span>]) &#123;</span><br><span class="line">$ip = anti_sqlin($_GET[<span class="string">'ip'</span>]);</span><br><span class="line">$cname = anti_sqlin($_GET[<span class="string">'cname'</span>]);</span><br><span class="line">$url = anti_sqlin($_GET[<span class="string">'url'</span>]);</span><br><span class="line">$siteid = (int)$_GET[<span class="string">'siteid'</span>];</span><br><span class="line">$bean = <span class="keyword">new</span> Bean();</span><br><span class="line"><span class="comment">// 现在的时间戳</span></span><br><span class="line">$now = time();</span><br><span class="line"><span class="comment">// 存储</span></span><br><span class="line">$bean-&gt;save(<span class="string">"wnzz_visit"</span>, [<span class="string">"ip=&#123;$ip&#125;"</span>, <span class="string">"cname=&#123;$cname&#125;"</span>, <span class="string">"url=&#123;$url&#125;"</span>, <span class="string">"time=&#123;$now&#125;"</span>, <span class="string">"siteid=&#123;$siteid&#125;"</span>]);</span><br><span class="line"><span class="comment">// 获取访问记录</span></span><br><span class="line">&#125; <span class="keyword">elseif</span>(<span class="keyword">isset</span>($_GET[<span class="string">'act'</span>]) &amp;&amp; $_GET[<span class="string">'act'</span>] == <span class="string">'get'</span> &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">'siteid'</span>])) &#123;</span><br><span class="line">$siteid = (int)$_GET[<span class="string">'siteid'</span>];</span><br><span class="line"><span class="comment">// init</span></span><br><span class="line">$y_ips = <span class="number">0</span>;</span><br><span class="line">$y_pvs = <span class="number">0</span>;</span><br><span class="line">$t_ips = <span class="number">0</span>;</span><br><span class="line">$t_pvs = <span class="number">0</span>;</span><br><span class="line">$online = <span class="number">0</span>;</span><br><span class="line">$bean = <span class="keyword">new</span> Bean();</span><br><span class="line"><span class="comment">// 现在的时间戳</span></span><br><span class="line">$now = time();</span><br><span class="line"><span class="comment">// 现在对应今日0点的时间戳</span></span><br><span class="line">$today = strtotime(date(<span class="string">"Y-m-d"</span>), $now);</span><br><span class="line"><span class="comment">// 现在对应昨日0点的时间戳</span></span><br><span class="line">$yesterday = $today - <span class="number">86400</span>;</span><br><span class="line"><span class="comment">// 现在对应明日0点的时间戳</span></span><br><span class="line">$tomorrow = $today + <span class="number">86400</span>;</span><br><span class="line"><span class="comment">// 查找昨天的记录</span></span><br><span class="line">$res = $bean-&gt;findByX([<span class="string">'timestr'</span>, <span class="string">'ips'</span>, <span class="string">'pvs'</span>], <span class="string">"wnzz_cal"</span>, [<span class="string">"timestamp=&#123;$yesterday&#125;"</span>, <span class="string">"siteid=&#123;$siteid&#125;"</span>]);</span><br><span class="line"><span class="keyword">if</span>($res[<span class="string">'status'</span>] == <span class="string">'data'</span>) &#123;</span><br><span class="line"><span class="comment">// 有数据直接读</span></span><br><span class="line">$y_ips = $res[<span class="string">'data'</span>][<span class="number">0</span>][<span class="string">'ips'</span>];</span><br><span class="line">$y_pvs = $res[<span class="string">'data'</span>][<span class="number">0</span>][<span class="string">'pvs'</span>];</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// 计算并存储</span></span><br><span class="line">$res_m = $bean-&gt;findByX([<span class="string">'ip'</span>], <span class="string">"wnzz_visit"</span>, [<span class="string">"time&gt;=&#123;$yesterday&#125;"</span>, <span class="string">"time&lt;&#123;$today&#125;"</span>, <span class="string">"siteid=&#123;$siteid&#125;"</span>]);</span><br><span class="line">$datas = $res_m[<span class="string">'data'</span>];</span><br><span class="line">$ipsandpvs = cal_ipandpv($datas);</span><br><span class="line"><span class="comment">// 存储</span></span><br><span class="line"><span class="comment">// $ips</span></span><br><span class="line"><span class="comment">// $pvs</span></span><br><span class="line"><span class="comment">// $yesterday</span></span><br><span class="line"><span class="comment">// $yesterday_timestamp</span></span><br><span class="line">$ips = $ipsandpvs[<span class="number">0</span>];</span><br><span class="line">$pvs = $ipsandpvs[<span class="number">1</span>];</span><br><span class="line">$yesterday_timestamp = date(<span class="string">"Y-m-d"</span>, $yesterday);</span><br><span class="line">$y_ips = $ips;</span><br><span class="line">$y_pvs = $pvs;</span><br><span class="line">$res1 = $bean-&gt;save(<span class="string">"wnzz_cal"</span>, [<span class="string">"ips=&#123;$ips&#125;"</span>, <span class="string">"pvs=&#123;$pvs&#125;"</span>, <span class="string">"timestamp=&#123;$yesterday&#125;"</span>, <span class="string">"timestr=&#123;$yesterday_timestamp&#125;"</span>, <span class="string">"siteid=&#123;$siteid&#125;"</span>]);</span><br><span class="line"><span class="comment">// print_r($res1);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 查找今天的记录</span></span><br><span class="line">$res_t = $bean-&gt;findByX([<span class="string">'ip'</span>], <span class="string">"wnzz_visit"</span>, [<span class="string">"time&gt;&#123;$today&#125;"</span>, <span class="string">"time&lt;&#123;$tomorrow&#125;"</span>, <span class="string">"siteid=&#123;$siteid&#125;"</span>]);</span><br><span class="line">$datas_t = $res_t[<span class="string">'data'</span>];</span><br><span class="line">$ipsandpvs_t = cal_ipandpv($datas_t);</span><br><span class="line">$ips_t = $ipsandpvs_t[<span class="number">0</span>];</span><br><span class="line">$pvs_t = $ipsandpvs_t[<span class="number">1</span>];</span><br><span class="line">$t_ips = $ips_t;</span><br><span class="line">$t_pvs = $pvs_t;</span><br><span class="line"><span class="comment">// 获取当前在线，10min内为在线</span></span><br><span class="line"><span class="comment">// 用PV计算当前在线数</span></span><br><span class="line">$onlineMin = $now - <span class="number">600</span>;</span><br><span class="line">$res_o = $bean-&gt;findByX([<span class="string">'ip'</span>], <span class="string">"wnzz_visit"</span>, [<span class="string">"time&gt;&#123;$onlineMin&#125;"</span>, <span class="string">"siteid=&#123;$siteid&#125;"</span>]);</span><br><span class="line">$datas_o = $res_o[<span class="string">'data'</span>];</span><br><span class="line">$ipsandpvs_o = cal_ipandpv($datas_o);</span><br><span class="line">$ips_o = $ipsandpvs_o[<span class="number">0</span>];</span><br><span class="line">$pvs_o = $ipsandpvs_o[<span class="number">1</span>];</span><br><span class="line"><span class="comment">// $t_ips = $ips_o;</span></span><br><span class="line">$online = $pvs_o;</span><br><span class="line"><span class="comment">// $y_ips = 0;</span></span><br><span class="line"><span class="comment">// $y_pvs = 0;</span></span><br><span class="line"><span class="comment">// $t_ips = 0;</span></span><br><span class="line"><span class="comment">// $t_pvs = 0;</span></span><br><span class="line"><span class="comment">// $online = 0;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"webpro统计|今日IP[&#123;$t_ips&#125;]|今日PV[&#123;$t_pvs&#125;]|昨日IP[&#123;$y_ips&#125;]|昨日PV[&#123;$y_pvs&#125;]|当前在线[&#123;$online&#125;]"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> array(ips, pvs)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cal_ipandpv</span><span class="params">($datas)</span> </span>&#123;</span><br><span class="line"><span class="comment">// echo "emmm&lt;br/&gt;";</span></span><br><span class="line"><span class="comment">// print_r($datas);</span></span><br><span class="line"><span class="comment">// $ip['192.168.1.1'] = 10;</span></span><br><span class="line">$ip = <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">foreach</span>($datas <span class="keyword">as</span> $index =&gt; $item) &#123;</span><br><span class="line"><span class="keyword">if</span>(array_key_exists($item[<span class="string">'ip'</span>], $ip)) &#123;</span><br><span class="line"><span class="comment">// 统计过</span></span><br><span class="line">$ip[$item[<span class="string">'ip'</span>]] += <span class="number">1</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// 没统计过</span></span><br><span class="line">$ip[$item[<span class="string">'ip'</span>]] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 累加IP和PV</span></span><br><span class="line">$ips = <span class="number">0</span>;</span><br><span class="line">$pvs = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">foreach</span>($ip <span class="keyword">as</span> $keyip =&gt; $count) &#123;</span><br><span class="line">$ips++;</span><br><span class="line">$pvs += $count;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> [$ips, $pvs];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">anti_sqlin</span><span class="params">($data)</span> </span>&#123;</span><br><span class="line">$data = str_replace(<span class="string">"'"</span>, <span class="string">""</span>, $data);</span><br><span class="line"><span class="keyword">return</span> $data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h1 id="在要统计的页面中安装"><a href="#在要统计的页面中安装" class="headerlink" title="在要统计的页面中安装"></a>在要统计的页面中安装</h1><h2 id="在合适位置添加统计代码"><a href="#在合适位置添加统计代码" class="headerlink" title="在合适位置添加统计代码"></a>在合适位置添加统计代码</h2><ul><li>在head代码处添加、或者有的网站后台管理中留有网站统计填写等合适位置，添加如下代码(xxx/xxx.js改成自己的服务器上的JS地址)</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">html</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://pv.sohu.com/cityjson?ie=utf-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://xxx/xxx.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200310164440.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200310164440.png" class="lazyload"></a></p><ul><li>然后在你需要显示统计数据的地方添加如下div标签</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">html</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"wnzz"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h2 id="插件测试"><a href="#插件测试" class="headerlink" title="插件测试"></a>插件测试</h2><ul><li>安装好后，刷新网站进行测试</li></ul><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200310162203.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200310162203.png" class="lazyload"></a></p><blockquote><p>安装成功！</p></blockquote><ul><li>如果要实现多网站统计，设置不同的siteid，避免siteid重复即可！</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;插件效果&quot;&gt;&lt;a href=&quot;#插件效果&quot; class=&quot;headerlink&quot; title=&quot;插件效果&quot;&gt;&lt;/a&gt;插件效果&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;闲来无事写个简易网站流量统计插件:&lt;/li&gt;
&lt;li&gt;开发用到: php mysql js html&lt;/li&gt;

      
    
    </summary>
    
    
      <category term="php" scheme="http://blog.webpro.ltd/categories/php/"/>
    
    
      <category term="php" scheme="http://blog.webpro.ltd/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>OrangePi Zero嵌入式板搭建微服务网关[Ubuntu_Server1504+JDK1.8]</title>
    <link href="http://blog.webpro.ltd/2019/05/26/OrangePi-Zero-run-springboot/"/>
    <id>http://blog.webpro.ltd/2019/05/26/OrangePi-Zero-run-springboot/</id>
    <published>2019-05-25T16:00:00.000Z</published>
    <updated>2020-03-09T11:59:22.634Z</updated>
    
    <content type="html"><![CDATA[<h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><h2 id="配件清单"><a href="#配件清单" class="headerlink" title="配件清单"></a>配件清单</h2><h3 id="必选清单"><a href="#必选清单" class="headerlink" title="必选清单"></a>必选清单</h3><table><thead><tr><th align="left">名称</th><th align="left">配置</th></tr></thead><tbody><tr><td align="left">OragePi Zero主板</td><td align="left">4核ARM CPU + 512M DDR3(与显存共享)，带1个板载WiFi(及天线)、1个USB2.0接口、1个标准网线插口、TF卡槽、OTG电源口、兼容树莓派的GPIO接口等等</td></tr><tr><td align="left">OragePi Zero扩展版</td><td align="left">扩展了2个USB2.0，1个红外线信号接收器、1个AV显示器信号模拟输出</td></tr><tr><td align="left">orangepi zero</td><td align="left">黑色壳可装下开发板和扩展板    若板子上电启动正常，各个接口输出正常，就可把板子安装在壳子中，保护其零件。(谨慎安装，安装好后板子基本上就拆卸不出来了)</td></tr><tr><td align="left">0.2毫米移动石墨散热片</td><td align="left">裁剪贴在CPU和DDR上，裁剪剩下的可以贴在主板的背面</td></tr><tr><td align="left">32GB TF卡 Class10</td><td align="left">32GB性价比较高，Class10级及以上速度，稍后系统将烧录在内，需要读卡器</td></tr><tr><td align="left">5V2A电源、OTG充电线</td><td align="left">给开发板供电</td></tr><tr><td align="left">操作环境</td><td align="left">win10 + Ubuntu(主要用于ssh) + 局域网(路由器等内网环境)</td></tr></tbody></table><h3 id="可选清单"><a href="#可选清单" class="headerlink" title="可选清单"></a>可选清单</h3><table><thead><tr><th align="left">名称</th><th align="left">配置</th></tr></thead><tbody><tr><td align="left">鼠标</td><td align="left">USB串口</td></tr><tr><td align="left">键盘</td><td align="left">USB串口</td></tr><tr><td align="left">AV转HDMI</td><td align="left">可将板子输出的信号直接插在支持HDMI的显示器上</td></tr><tr><td align="left">AV线</td><td align="left">可将板子输出AV信号直接插在支持AV的显示器上</td></tr></tbody></table><h2 id="软件及镜像准备"><a href="#软件及镜像准备" class="headerlink" title="软件及镜像准备"></a>软件及镜像准备</h2><table><thead><tr><th align="left">名称</th><th align="left">下载地址</th></tr></thead><tbody><tr><td align="left">SDFormatter</td><td align="left">TF卡格式化<br><a href="https://pan.baidu.com/s/1uezMmj4rY4sMo3dZD_JMNA" target="_blank" rel="noopener">https://pan.baidu.com/s/1uezMmj4rY4sMo3dZD_JMNA</a><br>提取码：jufm</td></tr><tr><td align="left">Win32DiskImager</td><td align="left">镜像烧录软件<br><a href="https://pan.baidu.com/s/1net3qS-tmrhKnAimyat0iA" target="_blank" rel="noopener">https://pan.baidu.com/s/1net3qS-tmrhKnAimyat0iA</a><br>提取码：u4lg</td></tr><tr><td align="left">ubuntu_server.img</td><td align="left">系统镜像MD5<br> 474f0b497dafd9368a7d3cfe7961ea16<br><a href="https://pan.baidu.com/s/1l3FEdj9UJvFi5GSwUrUvlQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1l3FEdj9UJvFi5GSwUrUvlQ</a><br>提取码：nnap</td></tr><tr><td align="left">jdk-8u211-linux-arm32-vfp-hflt.tar.gz</td><td align="left">JDK8从Oracle官网下载即可</td></tr></tbody></table><h1 id="烧录镜像"><a href="#烧录镜像" class="headerlink" title="烧录镜像"></a>烧录镜像</h1><ol><li>将TF卡插在读卡器上，插入电脑。</li></ol><ul><li>打开SDFormatter，选择参数后，格式化TF卡。</li></ul><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309184342.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309184342.png" class="lazyload"></a></p><ol start="2"><li>打开Win32DiskImager，选择镜像地址，选择Device（TF卡的盘符），选择成功后，Write按钮处于可点击状态，点击Write按钮进行烧录</li></ol><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309184405.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309184405.png" class="lazyload"></a></p><ol start="3"><li>提示烧录成功后，win10系统会提示TF卡格式错误，忽略提示（烧录后的TF卡格式win10系统不支持），直接拔掉TF卡即可。</li></ol><h1 id="启动开发板"><a href="#启动开发板" class="headerlink" title="启动开发板"></a>启动开发板</h1><ol><li><p>将TF卡插到开发板的TF卡槽中，插入网线，接通电源（5V2A），系统会自动开机，等待2分钟。</p></li><li><p>从路由器管理页面查新设备的IP地址，我查到我的设备IP地址为 192.168.31.73 ，注意这是内网地址，外网不能直接访问</p></li></ol><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309184520.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309184520.png" class="lazyload"></a></p><ol start="3"><li><p>打开Ubuntu命令行，输入指令</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh root@192.168.31.73</span><br></pre></td></tr></table></figure></div><ul><li>远程连接（该系统已经集成了ssh，新镜像开机即可使用ssh）</li></ul><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309184625.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309184625.png" class="lazyload"></a></p><ul><li><p>默认密码为 orangepi</p></li><li><p>登陆上去后输入指令</p></li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd</span><br></pre></td></tr></table></figure></div><ul><li>更改当前账户密码</li></ul><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309184717.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309184717.png" class="lazyload"></a></p><ul><li>成功登陆到Ubuntu_Server，首次登陆会提示 需要执行 sudo fs_resize 命令，重划空间分配</li></ul></li></ol><h1 id="配置JDK1-8环境"><a href="#配置JDK1-8环境" class="headerlink" title="配置JDK1.8环境"></a>配置JDK1.8环境</h1><ul><li><p>从官网下载 jdk-8u211-linux-arm32-vfp-hflt.tar.gz</p></li><li><p>具体安装方法详见<a href="/2019/02/17/WSL-Install/#配置JDK环境">WSL,Ubuntu16.04配置JDK1.8</a> (注意两者下载的JDK包不同)</p></li></ul><h1 id="运行第一个jar包"><a href="#运行第一个jar包" class="headerlink" title="运行第一个jar包"></a>运行第一个jar包</h1><ol><li>我使用spingboot写了一个简单的HelloWorld程序:</li></ol><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309195156.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309195156.png" class="lazyload"></a></p><ul><li>执行 mvn install 将项目打包成jar包</li></ul><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309195221.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309195221.png" class="lazyload"></a></p><ul><li>smarthome1-0.0.1-SNAPSHOT.jar</li></ul><ol start="2"><li>我在/usr目录下新建me文件夹，将我的项目都上传到此</li></ol><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir /usr/me</span><br><span class="line"><span class="built_in">cd</span> /usr/me</span><br></pre></td></tr></table></figure></div><ul><li>将smarthome1-0.0.1-SNAPSHOT.jar上传到该文件夹中即可</li></ul><ol start="3"><li>运行jar包</li></ol><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar smarthome1-0.0.1-SNAPSHOT.jar</span><br></pre></td></tr></table></figure></div><ul><li>jar包启动成功，如下所示:</li></ul><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309195341.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309195341.png" class="lazyload"></a></p><ol start="4"><li>访问测试，访问:</li></ol><p><code>http://192.168.31.73:8080/hello</code></p><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309195408.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309195408.png" class="lazyload"></a></p><blockquote><p>访问成功！</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;准备工作&quot;&gt;&lt;a href=&quot;#准备工作&quot; class=&quot;headerlink&quot; title=&quot;准备工作&quot;&gt;&lt;/a&gt;准备工作&lt;/h1&gt;&lt;h2 id=&quot;配件清单&quot;&gt;&lt;a href=&quot;#配件清单&quot; class=&quot;headerlink&quot; title=&quot;配件清单&quot;&gt;&lt;/a
      
    
    </summary>
    
    
      <category term="OrangePi" scheme="http://blog.webpro.ltd/categories/OrangePi/"/>
    
    
      <category term="OrangePi" scheme="http://blog.webpro.ltd/tags/OrangePi/"/>
    
  </entry>
  
  <entry>
    <title>springboot快速入门</title>
    <link href="http://blog.webpro.ltd/2019/02/21/springboot-fast-study/"/>
    <id>http://blog.webpro.ltd/2019/02/21/springboot-fast-study/</id>
    <published>2019-02-20T16:00:00.000Z</published>
    <updated>2020-03-10T03:00:32.803Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SpringBoot介绍"><a href="#SpringBoot介绍" class="headerlink" title="SpringBoot介绍"></a>SpringBoot介绍</h1><ul><li><h2 id="SpringBoot特性"><a href="#SpringBoot特性" class="headerlink" title="SpringBoot特性"></a>SpringBoot特性</h2><ul><li>创建独立的Spring应用程序</li><li>嵌入的Tomcat，无需部署war文件</li><li>简化maven配置</li><li>自动配置Spring</li><li>提供生产就绪型功能，如指标、健康、检查和外部配置</li><li>开箱即用没有代码生成，也无需配置XML文件</li></ul></li><li><h2 id="开发准备"><a href="#开发准备" class="headerlink" title="开发准备"></a>开发准备</h2><ul><li>环境Windows10 - JDK1.8</li><li>开发工具IDEA</li><li>项目管理工具maven(3.6.0)</li></ul></li><li><h2 id="开发准备-1"><a href="#开发准备-1" class="headerlink" title="开发准备"></a>开发准备</h2><ul><li>环境JDK1.8</li><li>开发工具IDEA</li><li>项目管理工具maven(3.6.0)</li></ul></li></ul><h1 id="HelloWorld创建"><a href="#HelloWorld创建" class="headerlink" title="HelloWorld创建"></a>HelloWorld创建</h1><ol><li>通过 file –&gt; new –&gt; project 打开new project窗口</li><li>创建 Spring Initializr，next，next，选择 web –&gt; web组件，完成项目创建</li><li>等待 项目从 maven 库更新</li><li>新建 Controller 类，写入如下代码</li></ol><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jpaexample;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Created by admin</span></span><br><span class="line"><span class="comment">* HelloWorld创建</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line">  <span class="meta">@GetMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"hello world"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><ol start="5"><li>启动 主程序</li></ol><p>出现形如下面图片则启动成功</p><p>访问 <a href="http://127.0.0.1:8080/hello" target="_blank" rel="noopener">http://127.0.0.1:8080/hello</a></p><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309180359.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309180359.png" class="lazyload"></a></p><ol start="6"><li>步骤总结</li></ol><ul><li>a. 新建Controller</li><li>b. 编写springboot启动类（IDEA）自动创建</li><li>c. 访问</li></ul><p>说明: 下面两种写法等价</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br></pre></td></tr></table></figure></div><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br></pre></td></tr></table></figure></div><h1 id="启动springboot项目"><a href="#启动springboot项目" class="headerlink" title="启动springboot项目"></a>启动springboot项目</h1><h2 id="启动springboot项目的方式"><a href="#启动springboot项目的方式" class="headerlink" title="启动springboot项目的方式"></a>启动springboot项目的方式</h2><ol><li>直接在IDEA中启动</li><li>在cmd中输入如下命令启动<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn spring-boot:run</span><br></pre></td></tr></table></figure></div></li><li>在cmd中输入如下命令启动<ul><li>win下运行方法（阻塞）<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mvn install</span><br><span class="line"><span class="built_in">cd</span> target</span><br><span class="line">java -jar package-name.jar</span><br></pre></td></tr></table></figure></div></li><li>linux下dev/test运行方法（阻塞）<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar package-name.jar</span><br></pre></td></tr></table></figure></div></li><li>linux下prod(生产环境)运行方法<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup java -jar package-name.jar &amp;</span><br></pre></td></tr></table></figure></div></li></ul></li></ol><h1 id="RESTful-API规范"><a href="#RESTful-API规范" class="headerlink" title="RESTful API规范"></a>RESTful API规范</h1><table><thead><tr><th align="left">方法</th><th align="left">路由</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">/girls</td><td align="left">获取列表</td></tr><tr><td align="left">POST</td><td align="left">/girls</td><td align="left">创建女生</td></tr><tr><td align="left">GET</td><td align="left">/girls/{id}</td><td align="left">通过id查询</td></tr><tr><td align="left">GET</td><td align="left">/girls/age/{age}</td><td align="left">通过年龄查询</td></tr><tr><td align="left">PUT</td><td align="left">/girls/{id}</td><td align="left">通过id更新</td></tr><tr><td align="left">DELETE</td><td align="left">/girls/{id}</td><td align="left">通过id删除</td></tr></tbody></table><h1 id="spring-boot-starter-data-jpa"><a href="#spring-boot-starter-data-jpa" class="headerlink" title="spring-boot-starter-data-jpa"></a>spring-boot-starter-data-jpa</h1><ol><li>添加依赖（这里用MySQL数据库演示）、查看pom.xml版本</li></ol><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">xml</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight xml"><figcaption><span>pom.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></div><ul><li>对于pom.xml，设置其版本，我的版本1.5.7</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">xml</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight xml"><figcaption><span>pom.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br></pre></td></tr></table></figure></div><ul><li>（不超过2.0即可，2.0以后版本jpa语法略有不同）</li></ul><ol start="2"><li>配置 application.properties / application.yml</li></ol><ul><li>application.properties</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">properties</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight properties"><figcaption><span>application.properties</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://127.0.0.1:3306/studyjpa?charset=utf8mb4&amp;serverTimezone=PRC</span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.jpa.hibernate.ddl-auto</span>=<span class="string">update</span></span><br><span class="line"><span class="meta">spring.jpa.show-sql</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure></div><ul><li>application.yml（建议使用YML，比较简洁）</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">yml</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight yml"><figcaption><span>application.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://127.0.0.1:3306/studyjpa?charset=utf8mb4&amp;serverTimezone=PRC</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">root</span></span><br><span class="line">  <span class="attr">jpa:</span></span><br><span class="line">    <span class="attr">hibernate:</span></span><br><span class="line">      <span class="attr">ddl-auto:</span> <span class="string">update</span></span><br><span class="line">    <span class="attr">show-sql:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></div><ol start="3"><li>创建 Girl 类，映射到MySQL数据库的实体</li></ol><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jpaexample;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Created by admin</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"Girl"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Girl</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Id</span></span><br><span class="line">  <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">  <span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> String cupSize;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> id;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.id = id;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getCupSize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> cupSize;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCupSize</span><span class="params">(String cupSize)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.cupSize = cupSize;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Integer <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> age;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><ul><li>说明:<ul><li><code>javax.persistence.*</code>:必须引入的包</li><li><code>@Entity</code>:表示该类实体与MySQL数据表对应</li><li><code>@Table(name = &quot;Girl&quot;)</code>:指定表名，不指定则使用类名作为表名</li><li><code>@GeneratedValue</code> 或 <code>@GeneratedValue(strategy = GenerationType.IDENTITY)</code>:    该类型（通常指Integer）为自增型</li></ul></li></ul><ol start="4"><li>启动项目，在数据库中会新建出一个表，则运行成功</li></ol><h1 id="JPA对数据库增删改查"><a href="#JPA对数据库增删改查" class="headerlink" title="JPA对数据库增删改查"></a>JPA对数据库增删改查</h1><h2 id="创建接口"><a href="#创建接口" class="headerlink" title="创建接口"></a>创建接口</h2><h3 id="新建-GirlRespository-类-继承-JpaRepository"><a href="#新建-GirlRespository-类-继承-JpaRepository" class="headerlink" title="新建 GirlRespository 类 继承 JpaRepository"></a>新建 GirlRespository 类 继承 JpaRepository</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jpaexample;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Created by admin</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">GirlRespository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="新建-GirlController类-引入-GirlRespository-实体"><a href="#新建-GirlController类-引入-GirlRespository-实体" class="headerlink" title="新建 GirlController类 引入 GirlRespository 实体"></a>新建 GirlController类 引入 GirlRespository 实体</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jpaexample;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Created by admin</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GirlController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> GirlRespository girlRespository;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="符合-RESTful-API规范-的增删改查-GirlController类"><a href="#符合-RESTful-API规范-的增删改查-GirlController类" class="headerlink" title="符合 RESTful API规范 的增删改查(GirlController类)"></a>符合 RESTful API规范 的增删改查(GirlController类)</h2><h3 id="获取列表"><a href="#获取列表" class="headerlink" title="获取列表"></a>获取列表</h3><ul><li>GET</li><li>127.0.0.1:8080/girls</li><li>return List<girl></girl></li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 查询所有列表</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@GetMapping</span>(value = <span class="string">"/girls"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Girl&gt; <span class="title">girlList</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> girlRespository.findAll();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="新增一条记录"><a href="#新增一条记录" class="headerlink" title="新增一条记录"></a>新增一条记录</h3><ul><li>POST</li><li>127.0.0.1:8080/girls</li><li>return Girl</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 新增一个女生</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@PostMapping</span>(value = <span class="string">"/girls"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Girl <span class="title">girlAdd</span><span class="params">(@RequestParam(<span class="string">"cupSize"</span>)</span> String cupSize,@<span class="title">RequestParam</span><span class="params">(<span class="string">"age"</span>)</span> Integer age)</span>&#123;</span><br><span class="line">  Girl girl = <span class="keyword">new</span> Girl();</span><br><span class="line">  girl.setCupSize(cupSize);</span><br><span class="line">  girl.setAge(age);</span><br><span class="line">  <span class="keyword">return</span> girlRespository.save(girl);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="通过-id-查询一条记录"><a href="#通过-id-查询一条记录" class="headerlink" title="通过 id 查询一条记录"></a>通过 id 查询一条记录</h3><ul><li>GET</li><li>127.0.0.1:8080/girls/{id}</li><li>return Girl</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 通过 id查询一个女生</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@GetMapping</span>(value = <span class="string">"/girls/&#123;id&#125;"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Girl <span class="title">girlFindOne</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> girlRespository.findOne(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="通过-id-更新一条记录"><a href="#通过-id-更新一条记录" class="headerlink" title="通过 id 更新一条记录"></a>通过 id 更新一条记录</h3><ul><li>PUT</li><li>127.0.0.1:8080/girls/{id}</li><li>return Girl</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 更新</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@PutMapping</span>(value = <span class="string">"/girls/&#123;id&#125;"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Girl <span class="title">girlUpdate</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id,</span></span><br><span class="line"><span class="function">    @<span class="title">RequestParam</span><span class="params">(<span class="string">"cupSize"</span>)</span> String cupSize,</span></span><br><span class="line"><span class="function">    @<span class="title">RequestParam</span><span class="params">(<span class="string">"age"</span>)</span> Integer age)</span>&#123;</span><br><span class="line">  Girl girl = <span class="keyword">new</span> Girl();</span><br><span class="line">  girl.setId(id);</span><br><span class="line">  girl.setCupSize(cupSize);</span><br><span class="line">  girl.setAge(age);</span><br><span class="line">  <span class="keyword">return</span> girlRespository.save(girl);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h3 id="通过-id-删除一条记录"><a href="#通过-id-删除一条记录" class="headerlink" title="通过 id 删除一条记录"></a>通过 id 删除一条记录</h3><ul><li>DELETE</li><li>127.0.0.1:8080/girls/{id}</li><li>no return</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 删除</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@DeleteMapping</span>(value = <span class="string">"/girls/&#123;id&#125;"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">girlDelete</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id)</span>&#123;</span><br><span class="line">  Girl girl = <span class="keyword">new</span> Girl();</span><br><span class="line">  girl.setId(id);</span><br><span class="line">  girlRespository.delete(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="通过指定字段（age）查询列表"><a href="#通过指定字段（age）查询列表" class="headerlink" title="通过指定字段（age）查询列表"></a>通过指定字段（age）查询列表</h2><ul><li>GET</li><li>127.0.0.1:8080/girls/age/{age}</li><li>return List<girl></girl></li></ul><h3 id="在-GirlRespository-类中增加如下"><a href="#在-GirlRespository-类中增加如下" class="headerlink" title="在 GirlRespository 类中增加如下"></a>在 GirlRespository 类中增加如下</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过年龄查询</span></span><br><span class="line"><span class="function">List <span class="title">findByAge</span><span class="params">(Integer age)</span></span>;</span><br></pre></td></tr></table></figure></div><h3 id="在-GirlController-中编写如下"><a href="#在-GirlController-中编写如下" class="headerlink" title="在 GirlController 中编写如下"></a>在 GirlController 中编写如下</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 通过年龄查询</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@GetMapping</span>(value = <span class="string">"/girls/age/&#123;age&#125;"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> List <span class="title">girlFindByAge</span><span class="params">(@PathVariable(<span class="string">"age"</span>)</span> Integer age)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> girlRespository.findByAge(age);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h1 id="JPA事务管理（数据回滚）"><a href="#JPA事务管理（数据回滚）" class="headerlink" title="JPA事务管理（数据回滚）"></a>JPA事务管理（数据回滚）</h1><blockquote><p>例如当简化用户购买一件商品时，需要减少库存和用户扣款两种操作，可能出现如下情况</p></blockquote><table><thead><tr><th align="left">减少库存</th><th align="left">用户扣款</th><th align="left">是否成功</th><th align="left">应采取的操作</th></tr></thead><tbody><tr><td align="left">成功</td><td align="left">失败</td><td align="left">否</td><td align="left">撤回减少库存操作</td></tr><tr><td align="left">失败</td><td align="left">成功</td><td align="left">否</td><td align="left">撤回用户扣款操作</td></tr><tr><td align="left">失败</td><td align="left">失败</td><td align="left">否</td><td align="left">无</td></tr><tr><td align="left">成功</td><td align="left">成功</td><td align="left">是</td><td align="left">无</td></tr></tbody></table><ul><li>我们希望当操作失败时，对另外一个已经成功的操作进行撤回，即事物回滚操作</li><li>首先需要查看数据库是否支持回滚操作，查看表引擎，若非InnoDB引擎，修改引擎为 InnoDB 即可</li></ul><h2 id="新建-GirlService-模拟-有两个相关联的数据库操作"><a href="#新建-GirlService-模拟-有两个相关联的数据库操作" class="headerlink" title="新建 GirlService 模拟 有两个相关联的数据库操作"></a>新建 GirlService 模拟 有两个相关联的数据库操作</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jpaexample;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Created by suxia on 2019/2/21/021.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GirlService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> GirlRespository girlRespository;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Transactional</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertTwo</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Girl girlA = <span class="keyword">new</span> Girl();</span><br><span class="line">    girlA.setAge(<span class="number">18</span>);</span><br><span class="line">    girlA.setCupSize(<span class="string">"A"</span>);</span><br><span class="line">    girlRespository.save(girlA);</span><br><span class="line"></span><br><span class="line">    Girl girlB = <span class="keyword">new</span> Girl();</span><br><span class="line">    girlB.setAge(<span class="number">19</span>);</span><br><span class="line">    girlB.setCupSize(<span class="string">"BBBB"</span>);</span><br><span class="line">    girlRespository.save(girlB);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><code>@Transactional</code>事务管理声明</p><h2 id="编写-测试-控制器-GirlController类"><a href="#编写-测试-控制器-GirlController类" class="headerlink" title="编写 测试 控制器(GirlController类)"></a>编写 测试 控制器(GirlController类)</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 同时插入两个数据，失败回滚</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@PostMapping</span>(value = <span class="string">"/girls/two"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">girlTwo</span><span class="params">()</span></span>&#123;</span><br><span class="line">  girlService.insertTwo();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="访问测试"><a href="#访问测试" class="headerlink" title="访问测试"></a>访问测试</h2><ul><li>测试原理：<br>修改了 Girl 表中的 cupSize字段，令其长度为1，那么 <code>girlB.setCupSize(&quot;BBBB&quot;);</code> 语句必定会引起数据库插入失败。 如果运行后数据库出现了1条记录，那么事务回滚失败，如果没有出现记录那么数据回滚成功。</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;SpringBoot介绍&quot;&gt;&lt;a href=&quot;#SpringBoot介绍&quot; class=&quot;headerlink&quot; title=&quot;SpringBoot介绍&quot;&gt;&lt;/a&gt;SpringBoot介绍&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;h2 id=&quot;SpringBoot特性&quot;&gt;&lt;a
      
    
    </summary>
    
    
      <category term="springboot" scheme="http://blog.webpro.ltd/categories/springboot/"/>
    
    
      <category term="Java" scheme="http://blog.webpro.ltd/tags/Java/"/>
    
      <category term="springboot" scheme="http://blog.webpro.ltd/tags/springboot/"/>
    
  </entry>
  
  <entry>
    <title>Windows10安装Linux子系统(WSL,Ubuntu16.04)并配置jdk1.8</title>
    <link href="http://blog.webpro.ltd/2019/02/17/WSL-Install/"/>
    <id>http://blog.webpro.ltd/2019/02/17/WSL-Install/</id>
    <published>2019-02-16T16:00:00.000Z</published>
    <updated>2020-03-09T12:59:05.315Z</updated>
    
    <content type="html"><![CDATA[<h1 id="什么是Linux子系统-WSL"><a href="#什么是Linux子系统-WSL" class="headerlink" title="什么是Linux子系统(WSL)"></a>什么是Linux子系统(WSL)</h1><blockquote><p>Windows Subsystem for Linux（简称WSL）是一个为在Windows 10上能够原生运行Linux二进制可执行文件（ELF格式）的兼容层。它是由微软与Canonical公司合作开发，目标是使纯正的Ubuntu 14.04 “Trusty Tahr”映像能下载和解压到用户的本地计算机，并且映像内的工具和实用工具能在此子系统上原生运行。</p></blockquote><blockquote><p>在实际开发测试运行的时候，往往需要用到Linux系统部署，使用Linux指令，而自己的电脑又是win系统，安装虚拟机既麻烦又耗内存，但是在win10版本，出现了Linux子系统(WSL, Windows Subsystem for Linux)，使得Linux系统可以直接运行在win下，方便了很多。</p></blockquote><h1 id="安装WSL"><a href="#安装WSL" class="headerlink" title="安装WSL"></a>安装WSL</h1><h2 id="查看系统版本"><a href="#查看系统版本" class="headerlink" title="查看系统版本"></a>查看系统版本</h2><ul><li>首先查看一下操作系统版本。右击我的电脑，点击属性，如下</li></ul><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309172939.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309172939.png" class="lazyload"></a></p><ul><li>我的系统是Windows10专业版1709，早期的win版本可能安装方法不同。</li></ul><h2 id="安装子系统前需配置"><a href="#安装子系统前需配置" class="headerlink" title="安装子系统前需配置"></a>安装子系统前需配置</h2><h3 id="打开Windows控制面板-gt-启用和关闭Windows功能"><a href="#打开Windows控制面板-gt-启用和关闭Windows功能" class="headerlink" title="打开Windows控制面板-&gt;启用和关闭Windows功能"></a>打开Windows控制面板-&gt;启用和关闭Windows功能</h3><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309173155.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309173155.png" class="lazyload"></a></p><h3 id="适用于Linux的Windows子系统打勾"><a href="#适用于Linux的Windows子系统打勾" class="headerlink" title="适用于Linux的Windows子系统打勾"></a>适用于Linux的Windows子系统打勾</h3><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309173312.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309173312.png" class="lazyload"></a></p><h3 id="然后打开设置–-gt-更新和安全–-gt-针对开发人员，选择开发人员模式"><a href="#然后打开设置–-gt-更新和安全–-gt-针对开发人员，选择开发人员模式" class="headerlink" title="然后打开设置–&gt;更新和安全–&gt;针对开发人员，选择开发人员模式"></a>然后打开设置–&gt;更新和安全–&gt;针对开发人员，选择开发人员模式</h3><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309173410.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309173410.png" class="lazyload"></a></p><h2 id="安装子系统"><a href="#安装子系统" class="headerlink" title="安装子系统"></a>安装子系统</h2><h3 id="以管理员方式运行cmd（命令提示符）"><a href="#以管理员方式运行cmd（命令提示符）" class="headerlink" title="以管理员方式运行cmd（命令提示符）"></a>以管理员方式运行cmd（命令提示符）</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lxrun /install</span><br></pre></td></tr></table></figure></div><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309173624.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309173624.png" class="lazyload"></a></p><h3 id="输入y继续安装系统"><a href="#输入y继续安装系统" class="headerlink" title="输入y继续安装系统"></a>输入y继续安装系统</h3><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309173649.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309173649.png" class="lazyload"></a></p><h3 id="安装完成后输入y继续（这里停留的时间可能会比较长）"><a href="#安装完成后输入y继续（这里停留的时间可能会比较长）" class="headerlink" title="安装完成后输入y继续（这里停留的时间可能会比较长）"></a>安装完成后输入y继续（这里停留的时间可能会比较长）</h3><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309173714.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309173714.png" class="lazyload"></a></p><h3 id="完成后创建用户名和密码"><a href="#完成后创建用户名和密码" class="headerlink" title="完成后创建用户名和密码"></a>完成后创建用户名和密码</h3><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309173726.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309173726.png" class="lazyload"></a><br><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309173735.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309173735.png" class="lazyload"></a></p><h3 id="在cmd中输入bash命令即可进入到win子系统"><a href="#在cmd中输入bash命令即可进入到win子系统" class="headerlink" title="在cmd中输入bash命令即可进入到win子系统"></a>在cmd中输入bash命令即可进入到win子系统</h3><ul><li>这样实现了在win命令行下运行Linux命令</li></ul><h1 id="配置JDK环境"><a href="#配置JDK环境" class="headerlink" title="配置JDK环境"></a>配置JDK环境</h1><h2 id="下载JDK"><a href="#下载JDK" class="headerlink" title="下载JDK"></a>下载JDK</h2><ul><li><p><a href="http://www.oracle.com/technetwork/java/javase/downloads/" target="_blank" rel="noopener">JDK官网</a></p></li><li><p>我安装的是<code>jdk-8u201-linux-x64.tar.gz</code></p></li></ul><h2 id="创建安装目录"><a href="#创建安装目录" class="headerlink" title="创建安装目录"></a>创建安装目录</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /usr/java</span><br></pre></td></tr></table></figure></div><ul><li>将下载的jdk上传到Ubuntu中</li><li>子系统在Windows系统中的物理路径<code>C:\Users\用户名\AppData\Local\lxss</code></li></ul><h2 id="解压"><a href="#解压" class="headerlink" title="解压"></a>解压</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar zxvf jdk-8u201-linux-x64.tar.gz -C  /usr/java</span><br></pre></td></tr></table></figure></div><h2 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile</span><br></pre></td></tr></table></figure></div><ul><li>在文件的末尾添加如下</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">vim</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/java/jdk1.<span class="number">8.0</span>_45</span><br><span class="line">export PATH=$JAVA_HOME/bin:$PATH</span><br><span class="line">export CLASSPATH=$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span><br></pre></td></tr></table></figure></div><h2 id="令使配置生效"><a href="#令使配置生效" class="headerlink" title="令使配置生效"></a>令使配置生效</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure></div><h2 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure></div><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309175001.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309175001.png" class="lazyload"></a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;什么是Linux子系统-WSL&quot;&gt;&lt;a href=&quot;#什么是Linux子系统-WSL&quot; class=&quot;headerlink&quot; title=&quot;什么是Linux子系统(WSL)&quot;&gt;&lt;/a&gt;什么是Linux子系统(WSL)&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;Win
      
    
    </summary>
    
    
    
      <category term="WSL" scheme="http://blog.webpro.ltd/tags/WSL/"/>
    
      <category term="Ubuntu16.04" scheme="http://blog.webpro.ltd/tags/Ubuntu16-04/"/>
    
      <category term="Windows10" scheme="http://blog.webpro.ltd/tags/Windows10/"/>
    
  </entry>
  
  <entry>
    <title>CNN（卷积神经网络） - 卷积计算提取图像边缘</title>
    <link href="http://blog.webpro.ltd/2018/09/11/cnn-study-1/"/>
    <id>http://blog.webpro.ltd/2018/09/11/cnn-study-1/</id>
    <published>2018-09-10T16:00:00.000Z</published>
    <updated>2020-03-11T03:08:06.967Z</updated>
    
    <content type="html"><![CDATA[<h1 id="算法可视化"><a href="#算法可视化" class="headerlink" title="算法可视化"></a>算法可视化</h1><ul><li><p>CNN（卷积神经网络）算法一般应用在图像识别领域，如对数字字母的识别、区分猫狗等。卷积神经网络运算的第一步即使对输入图像进行边缘提取。这篇文章用来讲解如何对图像的边缘进行提取。</p></li><li><p>算法思维跨越语言，这里用PHP语言来进行算法的讲解，实际开发中，非常不建议使用PHP来进行多次卷积运算，效率堪忧。</p></li><li><p>基础不清晰的请阅读本文代码下面的CNN基础，转自 CSDN博主ice_actor 写的一篇文章《吴恩达deeplearning之CNN—卷积神经网络入门》</p></li><li><p>在这里，将边缘提取用下面两张动态图片加以表示，接下来的算法机理便是基于这两张图片</p></li></ul><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309171157.gif" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309171157.gif" class="lazyload"></a><br><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309171252.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309171252.png" class="lazyload"></a></p><h1 id="原生代码实现"><a href="#原生代码实现" class="headerlink" title="原生代码实现"></a>原生代码实现</h1><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/* vim: set expandtab tabstop=4 shiftwidth=4: */</span></span><br><span class="line"><span class="comment">// +----------------------------------------------------------------------+</span></span><br><span class="line"><span class="comment">// | PHP version 5.6                                                      |</span></span><br><span class="line"><span class="comment">// +----------------------------------------------------------------------+</span></span><br><span class="line"><span class="comment">// | Copyright (c) 1997-2004 The PHP Group                                |</span></span><br><span class="line"><span class="comment">// +----------------------------------------------------------------------+</span></span><br><span class="line"><span class="comment">// | This source file is subject to version 3.0 of the PHP license,       |</span></span><br><span class="line"><span class="comment">// | that is bundled with this package in the file LICENSE, and is        |</span></span><br><span class="line"><span class="comment">// | available through the world-wide-web at the following url:           |</span></span><br><span class="line"><span class="comment">// | http://www.php.net/license/3_0.txt.                                  |</span></span><br><span class="line"><span class="comment">// | If you did not receive a copy of the PHP license and are unable to   |</span></span><br><span class="line"><span class="comment">// | obtain it through the world-wide-web, please send a note to          |</span></span><br><span class="line"><span class="comment">// | license@php.net so we can mail you a copy immediately.               |</span></span><br><span class="line"><span class="comment">// +----------------------------------------------------------------------+</span></span><br><span class="line"><span class="comment">// | Authors: Original Author blog.webpro.ltd                             |</span></span><br><span class="line"><span class="comment">// |          Bill &lt;billwhite246@gmail.com&gt;                               |</span></span><br><span class="line"><span class="comment">// +----------------------------------------------------------------------+</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// $Id:$</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 基于卷积神经网络算法的图像识别</span></span><br><span class="line"><span class="comment"> * Bill</span></span><br><span class="line"><span class="comment"> * 2018年9月7日 08点46分</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">ini_set(<span class="string">'memory_limit'</span>, <span class="string">'-1'</span>);</span><br><span class="line">set_time_limit(<span class="number">0</span>);</span><br><span class="line">header(<span class="string">'content-type: text/html; charset=utf-8;'</span>);</span><br><span class="line"><span class="comment">// $imagePath = './ehuixue/1.jpg';</span></span><br><span class="line"><span class="comment">// $imagePath = './img/1.jpg';</span></span><br><span class="line"><span class="comment">// $imagePath = './img/crh.jpg';</span></span><br><span class="line">$imagePath = <span class="string">'./img/train.jpg'</span>;</span><br><span class="line">$array = getimagesize($imagePath);</span><br><span class="line">print_r($array);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;br/&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;h2&gt;【图像初始样式 - 60%】&lt;/h2&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img width="60%" src="'</span> . $imagePath . <span class="string">'"/&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;br/&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;br/&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;br/&gt;'</span>;</span><br><span class="line">$res = imagecreatefromjpeg($imagePath);</span><br><span class="line">$size = getimagesize($imagePath);</span><br><span class="line">$maxX = $size[<span class="number">0</span>];</span><br><span class="line">$maxY = $size[<span class="number">1</span>];</span><br><span class="line"><span class="comment">// // echo "&lt;pre&gt;";</span></span><br><span class="line"><span class="comment">// // echo "&lt;table border=\"1\" cellspacing=\"0\" cellpadding=\"0\"&gt;";</span></span><br><span class="line"><span class="comment">// // for ($i = 0; $i &lt; $size[1]; ++$i) &#123; // 行</span></span><br><span class="line"><span class="comment">// //     echo "&lt;tr&gt;";</span></span><br><span class="line"><span class="comment">// //     for ($j = 0; $j &lt; $size[0]; ++$j) &#123; // 列</span></span><br><span class="line"><span class="comment">// //         $rgb = imagecolorat($res, $j, $i);</span></span><br><span class="line"><span class="comment">// //         $rgbarray = imagecolorsforindex($res, $rgb);</span></span><br><span class="line"><span class="comment">// //         echo "&lt;td&gt;";</span></span><br><span class="line"><span class="comment">// //         echo $rgbarray['red'].',&lt;br/&gt;'.$rgbarray['green'].',&lt;br/&gt;'.$rgbarray['blue'];</span></span><br><span class="line"><span class="comment">// //         echo "&lt;/td&gt;";</span></span><br><span class="line"><span class="comment">// //     &#125;</span></span><br><span class="line"><span class="comment">// //     echo "&lt;tr&gt;";</span></span><br><span class="line"><span class="comment">// // &#125;</span></span><br><span class="line"><span class="comment">// // echo "&lt;/table&gt;";</span></span><br><span class="line"><span class="comment">// // echo "&lt;/pre&gt;";</span></span><br><span class="line"><span class="comment">// // echo "&lt;br/&gt;";</span></span><br><span class="line">$input = <span class="keyword">array</span>();</span><br><span class="line">$emmm = imagecreatetruecolor($size[<span class="number">0</span>], $size[<span class="number">1</span>]);</span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $size[<span class="number">0</span>]; ++$i) &#123; <span class="comment">// x</span></span><br><span class="line">    <span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; $size[<span class="number">1</span>]; ++$j) &#123; <span class="comment">// y</span></span><br><span class="line">        $rgb = imagecolorat($res, $i, $j);</span><br><span class="line">        $rgbarray = imagecolorsforindex($res, $rgb);</span><br><span class="line">        $rgb = (int)(($rgbarray[<span class="string">'red'</span>] + $rgbarray[<span class="string">'green'</span>] / <span class="number">3</span> + $rgbarray[<span class="string">'blue'</span>]) / <span class="number">12</span>);</span><br><span class="line">        <span class="keyword">if</span> ($rgb &gt; <span class="number">20</span>) &#123;</span><br><span class="line">            $color = imagecolorallocate($emmm, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>);</span><br><span class="line">            $input[$j][$i] = <span class="number">255</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $color = imagecolorallocate($emmm, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">            $input[$j][$i] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// $color = imagecolorallocate(  $emmm, $rgb, $rgb, $rgb);</span></span><br><span class="line">        <span class="comment">// $color  =  imagecolorallocate ( $emmm ,  255 ,  0 ,  0 );// 设置颜色 - ps里的选择画笔颜色</span></span><br><span class="line">        imagesetpixel($emmm, $i, $j, $color);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">date_default_timezone_set(<span class="string">'PRC'</span>);</span><br><span class="line">$now = time();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;h2&gt;【灰度化 - 60%】&lt;/h2&gt;'</span>;</span><br><span class="line">ImagePNG($emmm, <span class="string">'./img/'</span> . $now . <span class="string">'.png'</span>);</span><br><span class="line"><span class="comment">// imagepng($emmm);</span></span><br><span class="line">imagedestroy($emmm); <span class="comment">// 销毁图片，释放内存</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img width="60%" src="./img/'</span> . $now . <span class="string">'.png"/&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;br/&gt;'</span>;</span><br><span class="line"><span class="comment">// $red  =  imagecolorallocate ( $image ,  255 ,  0 ,  0 );// 设置颜色 - ps里的选择画笔颜色</span></span><br><span class="line"><span class="comment">// for($i=0; $i&lt;300; ++$i)&#123;</span></span><br><span class="line"><span class="comment">//     imagesetpixel (  $emmm , 100 , $i , $red );</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// header('Content-Type:image/jpg');</span></span><br><span class="line"><span class="comment">/////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">/////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">/////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">// 二值化// 二值化// 二值化// 二值化// 二值化// 二值化// 二值化//</span></span><br><span class="line"><span class="comment">// 二值化// 二值化// 二值化// 二值化// 二值化// 二值化// 二值化//</span></span><br><span class="line"><span class="comment">// date_default_timezone_set('PRC');</span></span><br><span class="line"><span class="comment">// $now = time();</span></span><br><span class="line"><span class="comment">// ImagePNG($emmm,'./img/'.$now.'.png');</span></span><br><span class="line"><span class="comment">// // imagepng($emmm);</span></span><br><span class="line"><span class="comment">// imagedestroy($emmm);// 销毁图片，释放内存</span></span><br><span class="line"><span class="comment">// echo '&lt;img src="./img/'.$now.'.png"/&gt;';</span></span><br><span class="line"><span class="comment">// echo '&lt;br/&gt;';</span></span><br><span class="line"><span class="comment">// foreach($input as $key =&gt; $value)&#123; // 先固定行，即y坐标，$j是y</span></span><br><span class="line"><span class="comment">//     foreach($value as $inner =&gt; $x)&#123;</span></span><br><span class="line"><span class="comment">//         if($x &lt; 100)&#123;</span></span><br><span class="line"><span class="comment">//             echo '1';</span></span><br><span class="line"><span class="comment">//         &#125;else&#123;</span></span><br><span class="line"><span class="comment">//             echo '0';</span></span><br><span class="line"><span class="comment">//         &#125;</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//     echo '&lt;br/&gt;';</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">/////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">/////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">/////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">// 二值化// 二值化// 二值化// 二值化// 二值化// 二值化// 二值化//</span></span><br><span class="line"><span class="comment">// 二值化// 二值化// 二值化// 二值化// 二值化// 二值化// 二值化//</span></span><br><span class="line"><span class="comment">// print_r($input);</span></span><br><span class="line"><span class="comment">/**INPUT padding 处理 */</span></span><br><span class="line"><span class="comment">// 暂时不需要</span></span><br><span class="line"><span class="comment">// $input = $temp;</span></span><br><span class="line"><span class="comment">// print_r($input);</span></span><br><span class="line"><span class="comment">// exit;</span></span><br><span class="line"><span class="comment">// for ( $i = 0; $i &lt; $x; ++$i ) &#123; // 列</span></span><br><span class="line"><span class="comment">//     for ( $j = 0; $j &lt; $y; ++$j ) &#123; // 行</span></span><br><span class="line"><span class="comment">//         if ($input[$i][$j] &lt; 80) &#123;</span></span><br><span class="line"><span class="comment">//             echo "1";</span></span><br><span class="line"><span class="comment">//         &#125;else&#123;</span></span><br><span class="line"><span class="comment">//             echo "0";</span></span><br><span class="line"><span class="comment">//         &#125;</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//     echo '&lt;br/&gt;';</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line">$output = <span class="keyword">array</span>(); <span class="comment">// 卷积计算后输出</span></span><br><span class="line"><span class="comment">// 卷积计算</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;h2&gt;【水平卷积过滤】&lt;/h2&gt;'</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> X过滤，算子:</span></span><br><span class="line"><span class="comment"> 1  0  -1</span></span><br><span class="line"><span class="comment"> 1  0  -1</span></span><br><span class="line"><span class="comment"> 1  0  -1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">$wx = <span class="keyword">array</span>(</span><br><span class="line">    <span class="number">0</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">0</span>, <span class="number">-1</span></span><br><span class="line">    ) ,</span><br><span class="line">    <span class="number">1</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">0</span>, <span class="number">-1</span></span><br><span class="line">    ) ,</span><br><span class="line">    <span class="number">2</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">0</span>, <span class="number">-1</span></span><br><span class="line">    ) ,</span><br><span class="line">);</span><br><span class="line">$wx = <span class="keyword">array</span>(</span><br><span class="line">    <span class="number">0</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">        <span class="number">1</span>, <span class="number">-1</span>,</span><br><span class="line">        <span class="number">1</span></span><br><span class="line">    ) ,</span><br><span class="line">    <span class="number">1</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">        <span class="number">1</span>, <span class="number">-1</span>,</span><br><span class="line">        <span class="number">0</span></span><br><span class="line">    ) ,</span><br><span class="line">    <span class="number">2</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">        <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span></span><br><span class="line">    ) ,</span><br><span class="line">);</span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; ($maxY - <span class="number">2</span>); ++$i) &#123; <span class="comment">// 固定行</span></span><br><span class="line">    <span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; ($maxX - <span class="number">2</span>); ++$j) &#123; <span class="comment">// 遍历列</span></span><br><span class="line">        $output[$i + <span class="number">1</span>][$j + <span class="number">1</span>] = <span class="number">0</span>; <span class="comment">// 赋初始值</span></span><br><span class="line">        $temp = <span class="keyword">array</span>(</span><br><span class="line">            <span class="number">0</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">                $input[$i + <span class="number">0</span>][$j + <span class="number">0</span>],</span><br><span class="line">                $input[$i + <span class="number">1</span>][$j + <span class="number">0</span>],</span><br><span class="line">                $input[$i + <span class="number">2</span>][$j + <span class="number">0</span>]</span><br><span class="line">            ) ,</span><br><span class="line">            <span class="number">1</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">                $input[$i + <span class="number">0</span>][$j + <span class="number">1</span>],</span><br><span class="line">                $input[$i + <span class="number">1</span>][$j + <span class="number">1</span>],</span><br><span class="line">                $input[$i + <span class="number">2</span>][$j + <span class="number">1</span>]</span><br><span class="line">            ) ,</span><br><span class="line">            <span class="number">2</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">                $input[$i + <span class="number">0</span>][$j + <span class="number">2</span>],</span><br><span class="line">                $input[$i + <span class="number">1</span>][$j + <span class="number">2</span>],</span><br><span class="line">                $input[$i + <span class="number">2</span>][$j + <span class="number">2</span>]</span><br><span class="line">            ) ,</span><br><span class="line">        );</span><br><span class="line">        <span class="comment">// 卷积计算</span></span><br><span class="line">        <span class="keyword">for</span> ($m = <span class="number">0</span>; $m &lt; <span class="number">3</span>; ++$m) &#123;</span><br><span class="line">            <span class="keyword">for</span> ($n = <span class="number">0</span>; $n &lt; <span class="number">3</span>; ++$n) &#123;</span><br><span class="line">                $output[$i + <span class="number">1</span>][$j + <span class="number">1</span>]+= $temp[$m][$n] * $wx[$m][$n];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;table border=\"1\" cellspacing=\"0\" cellpadding=\"0\"&gt;"</span>;</span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; ($maxY - <span class="number">2</span>); ++$i) &#123; <span class="comment">// 固定行</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;tr&gt;"</span>;</span><br><span class="line">    <span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; ($maxX - <span class="number">2</span>); ++$j) &#123; <span class="comment">// 遍历列</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;td&gt;"</span>;</span><br><span class="line">        <span class="keyword">echo</span> reluActive($output[$i + <span class="number">1</span>][$j + <span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;/td&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;/tr&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/table&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line">$emmm = imagecreatetruecolor($maxX - <span class="number">2</span>, $maxY - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; ($maxY - <span class="number">2</span>); ++$i) &#123; <span class="comment">// 固定行</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;tr&gt;"</span>;</span><br><span class="line">    <span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; ($maxX - <span class="number">2</span>); ++$j) &#123; <span class="comment">// 遍历列</span></span><br><span class="line">        $rgb = $output[$i + <span class="number">1</span>][$j + <span class="number">1</span>];</span><br><span class="line">        $color = imagecolorallocate($emmm, $rgb, $rgb, $rgb);</span><br><span class="line">        imagesetpixel($emmm, $j, $i, $color);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">date_default_timezone_set(<span class="string">'PRC'</span>);</span><br><span class="line">$now = time();</span><br><span class="line">ImagePNG($emmm, <span class="string">'./img/filtered'</span> . $now . <span class="string">'.png'</span>);</span><br><span class="line"><span class="comment">// imagepng($emmm);</span></span><br><span class="line">imagedestroy($emmm); <span class="comment">// 销毁图片，释放内存</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img width="60%" src="./img/filtered'</span> . $now . <span class="string">'.png"/&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;br/&gt;'</span>;</span><br><span class="line">$output1 = <span class="keyword">array</span>(); <span class="comment">// 卷积计算后输出</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;h2&gt;【垂直卷积过滤】&lt;/h2&gt;'</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> Y过滤，算子:</span></span><br><span class="line"><span class="comment"> 1  1  1</span></span><br><span class="line"><span class="comment"> 0  0  0</span></span><br><span class="line"><span class="comment"> -1 -1 -1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">$wy = <span class="keyword">array</span>(</span><br><span class="line">    <span class="number">0</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span>,</span><br><span class="line">        <span class="number">1</span></span><br><span class="line">    ) ,</span><br><span class="line">    <span class="number">1</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span></span><br><span class="line">    ) ,</span><br><span class="line">    <span class="number">2</span> =&gt; <span class="keyword">array</span>(<span class="number">-1</span>, <span class="number">-1</span>, <span class="number">-1</span></span><br><span class="line">    ) ,</span><br><span class="line">);</span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; ($maxY - <span class="number">2</span>); ++$i) &#123; <span class="comment">// 固定行</span></span><br><span class="line">    <span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; ($maxX - <span class="number">2</span>); ++$j) &#123; <span class="comment">// 遍历列</span></span><br><span class="line">        $output1[$i + <span class="number">1</span>][$j + <span class="number">1</span>] = <span class="number">0</span>; <span class="comment">// 赋初始值</span></span><br><span class="line">        $temp = <span class="keyword">array</span>(</span><br><span class="line">            <span class="number">0</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">                $input[$i + <span class="number">0</span>][$j + <span class="number">0</span>],</span><br><span class="line">                $input[$i + <span class="number">1</span>][$j + <span class="number">0</span>],</span><br><span class="line">                $input[$i + <span class="number">2</span>][$j + <span class="number">0</span>]</span><br><span class="line">            ) ,</span><br><span class="line">            <span class="number">1</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">                $input[$i + <span class="number">0</span>][$j + <span class="number">1</span>],</span><br><span class="line">                $input[$i + <span class="number">1</span>][$j + <span class="number">1</span>],</span><br><span class="line">                $input[$i + <span class="number">2</span>][$j + <span class="number">1</span>]</span><br><span class="line">            ) ,</span><br><span class="line">            <span class="number">2</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">                $input[$i + <span class="number">0</span>][$j + <span class="number">2</span>],</span><br><span class="line">                $input[$i + <span class="number">1</span>][$j + <span class="number">2</span>],</span><br><span class="line">                $input[$i + <span class="number">2</span>][$j + <span class="number">2</span>]</span><br><span class="line">            ) ,</span><br><span class="line">        );</span><br><span class="line">        <span class="comment">// 卷积计算</span></span><br><span class="line">        <span class="keyword">for</span> ($m = <span class="number">0</span>; $m &lt; <span class="number">3</span>; ++$m) &#123;</span><br><span class="line">            <span class="keyword">for</span> ($n = <span class="number">0</span>; $n &lt; <span class="number">3</span>; ++$n) &#123;</span><br><span class="line">                $output1[$i + <span class="number">1</span>][$j + <span class="number">1</span>]+= $temp[$m][$n] * $wy[$m][$n];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;table border=\"1\" cellspacing=\"0\" cellpadding=\"0\"&gt;"</span>;</span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; ($maxY - <span class="number">2</span>); ++$i) &#123; <span class="comment">// 固定行</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;tr&gt;"</span>;</span><br><span class="line">    <span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; ($maxX - <span class="number">2</span>); ++$j) &#123; <span class="comment">// 遍历列</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;td&gt;"</span>;</span><br><span class="line">        <span class="keyword">echo</span> reluActive($output1[$i + <span class="number">1</span>][$j + <span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;/td&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;/tr&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/table&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line">$emmm = imagecreatetruecolor($maxX - <span class="number">2</span>, $maxY - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; ($maxY - <span class="number">2</span>); ++$i) &#123; <span class="comment">// 固定行</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;tr&gt;"</span>;</span><br><span class="line">    <span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; ($maxX - <span class="number">2</span>); ++$j) &#123; <span class="comment">// 遍历列</span></span><br><span class="line">        $rgb = $output1[$i + <span class="number">1</span>][$j + <span class="number">1</span>];</span><br><span class="line">        $color = imagecolorallocate($emmm, $rgb, $rgb, $rgb);</span><br><span class="line">        imagesetpixel($emmm, $j, $i, $color);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">date_default_timezone_set(<span class="string">'PRC'</span>);</span><br><span class="line">$now = time();</span><br><span class="line">ImagePNG($emmm, <span class="string">'./img/filtered1'</span> . $now . <span class="string">'.png'</span>);</span><br><span class="line"><span class="comment">// imagepng($emmm);</span></span><br><span class="line">imagedestroy($emmm); <span class="comment">// 销毁图片，释放内存</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img width="60%" src="./img/filtered1'</span> . $now . <span class="string">'.png"/&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;br/&gt;'</span>;</span><br><span class="line">$final = <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;h2&gt;【X+Y卷积结果】&lt;/h2&gt;'</span>;</span><br><span class="line"><span class="comment">// XY合并</span></span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; ($maxY - <span class="number">2</span>); ++$i) &#123; <span class="comment">// 固定行</span></span><br><span class="line">    <span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; ($maxX - <span class="number">2</span>); ++$j) &#123; <span class="comment">// 遍历列</span></span><br><span class="line">        $final[$i][$j] = ($output[$i + <span class="number">1</span>][$j + <span class="number">1</span>]) ? ($output[$i + <span class="number">1</span>][$j + <span class="number">1</span>]) : ($output1[$i + <span class="number">1</span>][$j + <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;table border=\"1\" cellspacing=\"0\" cellpadding=\"0\"&gt;"</span>;</span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; ($maxY - <span class="number">2</span>); ++$i) &#123; <span class="comment">// 固定行</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;tr&gt;"</span>;</span><br><span class="line">    <span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; ($maxX - <span class="number">2</span>); ++$j) &#123; <span class="comment">// 遍历列</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;td&gt;"</span>;</span><br><span class="line">        <span class="keyword">echo</span> reluActive($final[$i][$j]);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;/td&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;/tr&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/table&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line">$emmm = imagecreatetruecolor($maxX - <span class="number">2</span>, $maxY - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; ($maxY - <span class="number">2</span>); ++$i) &#123; <span class="comment">// 固定行</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;tr&gt;"</span>;</span><br><span class="line">    <span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; ($maxX - <span class="number">2</span>); ++$j) &#123; <span class="comment">// 遍历列</span></span><br><span class="line">        $rgb = $final[$i][$j];</span><br><span class="line">        $color = imagecolorallocate($emmm, $rgb, $rgb, $rgb);</span><br><span class="line">        imagesetpixel($emmm, $j, $i, $color);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">date_default_timezone_set(<span class="string">'PRC'</span>);</span><br><span class="line">$now = time();</span><br><span class="line">ImagePNG($emmm, <span class="string">'./img/final'</span> . $now . <span class="string">'.png'</span>);</span><br><span class="line"><span class="comment">// imagepng($emmm);</span></span><br><span class="line">imagedestroy($emmm); <span class="comment">// 销毁图片，释放内存</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img width="60%" src="./img/final'</span> . $now . <span class="string">'.png"/&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;br/&gt;'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reluActive</span><span class="params">($x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> max(<span class="number">0</span>, $x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h1 id="处理效果"><a href="#处理效果" class="headerlink" title="处理效果"></a>处理效果</h1><h2 id="原图"><a href="#原图" class="headerlink" title="原图"></a>原图</h2><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309171616.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309171616.png" class="lazyload"></a></p><h2 id="灰度化处理"><a href="#灰度化处理" class="headerlink" title="灰度化处理"></a>灰度化处理</h2><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309171632.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309171632.png" class="lazyload"></a></p><h2 id="水平卷积算法处理"><a href="#水平卷积算法处理" class="headerlink" title="水平卷积算法处理"></a>水平卷积算法处理</h2><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309171728.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309171728.png" class="lazyload"></a></p><h2 id="垂直卷积算法处理"><a href="#垂直卷积算法处理" class="headerlink" title="垂直卷积算法处理"></a>垂直卷积算法处理</h2><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309171743.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309171743.png" class="lazyload"></a></p><h2 id="水平-垂直-叠加后-处理"><a href="#水平-垂直-叠加后-处理" class="headerlink" title="水平 + 垂直 叠加后 处理"></a>水平 + 垂直 叠加后 处理</h2><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309171801.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309171801.png" class="lazyload"></a></p><blockquote><p>至此，图片的边缘通过卷积计算提取了出来</p></blockquote><p>CNN基础参考<a href="https://blog.csdn.net/ice_actor/article/details/78648780" target="_blank" rel="noopener">CSDN博主ice_actor</a>写的一篇文章《吴恩达deeplearning之CNN—卷积神经网络入门》</p>]]></content>
    
    <summary type="html">
    
      CNN（卷积神经网络）
    
    </summary>
    
    
      <category term="CNN" scheme="http://blog.webpro.ltd/categories/CNN/"/>
    
    
      <category term="CNN" scheme="http://blog.webpro.ltd/tags/CNN/"/>
    
      <category term="算法" scheme="http://blog.webpro.ltd/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>Java JDBC 操作 MySql增删改查</title>
    <link href="http://blog.webpro.ltd/2018/09/11/Java-JDBC-%E6%93%8D%E4%BD%9C-MySql%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/"/>
    <id>http://blog.webpro.ltd/2018/09/11/Java-JDBC-%E6%93%8D%E4%BD%9C-MySql%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/</id>
    <published>2018-09-10T16:00:00.000Z</published>
    <updated>2020-03-12T01:53:55.096Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>工具：eclipse</p></blockquote><h1 id="导入jdbc驱动包"><a href="#导入jdbc驱动包" class="headerlink" title="导入jdbc驱动包"></a>导入jdbc驱动包</h1><table><thead><tr><th align="center">类型</th><th align="center">下载地址</th></tr></thead><tbody><tr><td align="center"><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/fileTypeImages/file_zip.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img class="fileType-icon lazyload" data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/fileTypeImages/file_zip.png"></a></td><td align="center"><br><a href="/pan/JDBC.zip">JDBC.zip</a></td></tr></tbody></table><h1 id="一个数据库的简单操作流程大致分为以下几个操作"><a href="#一个数据库的简单操作流程大致分为以下几个操作" class="headerlink" title="一个数据库的简单操作流程大致分为以下几个操作"></a>一个数据库的简单操作流程大致分为以下几个操作</h1><ul><li>a. 设置数据库连接参数</li><li>b. 加载数据库驱动（捕捉错误）</li><li>c. 连接数据库（捕捉错误）</li><li>d. 构造sql语句</li><li>e. 执行sql语句（捕捉错误）</li><li>f. 获取记录集结果</li><li>g.[关闭数据库连接]（java有cc机制不需要手动关闭）</li></ul><h1 id="下面进行代码演示"><a href="#下面进行代码演示" class="headerlink" title="下面进行代码演示"></a>下面进行代码演示</h1><ul><li>演示数据库简要说明</li></ul><table><thead><tr><th align="left">名称</th><th align="left">值</th></tr></thead><tbody><tr><td align="left">数据库名</td><td align="left">rtbook</td></tr><tr><td align="left">表名</td><td align="left">rtb_member</td></tr><tr><td align="left">包含字段1</td><td align="left">userid</td></tr><tr><td align="left">包含字段2</td><td align="left">phone</td></tr><tr><td align="left">包含字段3</td><td align="left">activeTime</td></tr></tbody></table><h2 id="main方法"><a href="#main方法" class="headerlink" title="main方法"></a>main方法</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 参数配置</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String dbName    =   <span class="string">"rtbook"</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String URL       =   <span class="string">"jdbc:mysql://127.0.0.1:3306/"</span> + dbName + <span class="string">"?useUnicode=true&amp;characterEncoding=UTF-8"</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String className =   <span class="string">"com.mysql.jdbc.Driver"</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String user      =   <span class="string">"root"</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String password  =   <span class="string">"root"</span>;</span><br><span class="line">  <span class="comment">// 数据库句柄</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Connection conn;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 测试顺序</span></span><br><span class="line"><span class="comment"> * 查询</span></span><br><span class="line"><span class="comment"> * 插入</span></span><br><span class="line"><span class="comment"> * 修改</span></span><br><span class="line"><span class="comment"> * 删除</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// 为了检验每次的执行效果，执行SQL语句完毕后都会输出表的数据视图</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 连接数据库</span></span><br><span class="line">jdbcConnect();</span><br><span class="line"><span class="comment">// 测试查询</span></span><br><span class="line"><span class="comment">// testSelect();</span></span><br><span class="line"><span class="comment">// 测试插入</span></span><br><span class="line"><span class="comment">// testInsert();</span></span><br><span class="line"><span class="comment">// 测试修改</span></span><br><span class="line"><span class="comment">// testUpdate();</span></span><br><span class="line"><span class="comment">// 测试删除</span></span><br><span class="line"><span class="comment">// testDelete();</span></span><br><span class="line">System.out.println(<span class="string">"done"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><code>其中下面这段GET参数，用来设置连接编码为utf-8</code></p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><figcaption><span>url</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">useUnicode=<span class="literal">true</span></span><br><span class="line">characterEncoding=UTF-8</span><br><span class="line">// 如果是高一点版本的MySQL，还要设置useSSL参数，不设置会报错</span><br><span class="line">useSSL=<span class="literal">false</span></span><br></pre></td></tr></table></figure></div><h2 id="数据库连接操作"><a href="#数据库连接操作" class="headerlink" title="数据库连接操作"></a>数据库连接操作</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">jdbcConnect</span><span class="params">()</span> </span>&#123;     </span><br><span class="line">  <span class="comment">// 加载JDBC驱动</span></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    Class.forName(className);</span><br><span class="line">    System.out.println(<span class="string">"JDBC Load SUCCESS"</span>);</span><br><span class="line">  &#125;<span class="keyword">catch</span>(ClassNotFoundException e) &#123;</span><br><span class="line">    <span class="comment">// 捕捉到错误</span></span><br><span class="line">    System.out.println(<span class="string">"JDBC Load error!"</span> + e);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 连接至数据库</span></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    conn = DriverManager.getConnection(URL, user, password);</span><br><span class="line">    System.out.println(dbName + <span class="string">"opened SUCCESS"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;<span class="keyword">catch</span>(SQLException e) &#123;</span><br><span class="line">    <span class="comment">// 捕捉到错误</span></span><br><span class="line">    System.out.println(dbName + <span class="string">"opened error!"</span> + e);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="数据查询"><a href="#数据查询" class="headerlink" title="数据查询"></a>数据查询</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testSelect</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 构造SQL语句</span></span><br><span class="line">    sql = conn.prepareStatement(<span class="string">"SELECT * FROM `rtb_member` WHERE `userid` &gt; 1"</span>);</span><br><span class="line">    <span class="comment">// 执行SQL语句</span></span><br><span class="line">    res = sql.executeQuery();</span><br><span class="line">    <span class="comment">// 输出表头</span></span><br><span class="line">    System.out.println( <span class="string">"编号"</span> + <span class="string">"\t"</span> + <span class="string">"手机"</span> + <span class="string">"\t"</span> + <span class="string">"注册时间"</span> );</span><br><span class="line">    <span class="comment">// 遍历结果集</span></span><br><span class="line">    <span class="keyword">while</span>(res.next()) &#123;</span><br><span class="line">      String userid = res.getString(<span class="string">"userid"</span>);</span><br><span class="line">      String phone = res.getString(<span class="string">"phone"</span>);</span><br><span class="line">      String activeTime = res.getString(<span class="string">"activeTime"</span>);</span><br><span class="line">      System.out.println(userid + <span class="string">"\t"</span> + phone + <span class="string">"\t"</span> + activeTime);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;<span class="keyword">catch</span>(SQLException e) &#123;</span><br><span class="line">    <span class="comment">// 捕捉到错误</span></span><br><span class="line">    System.out.println(<span class="string">"select execute error, err_msg:"</span> + e);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><ul><li>运行结果</li></ul><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309165006.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309165006.png" class="lazyload"></a></p><h2 id="数据插入"><a href="#数据插入" class="headerlink" title="数据插入"></a>数据插入</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 获取注册时间</span></span><br><span class="line">    Date day = <span class="keyword">new</span> Date();</span><br><span class="line">    SimpleDateFormat df = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">    String nowTime = df.format(day);</span><br><span class="line">    <span class="comment">// 构造SQL模板</span></span><br><span class="line">    sql = conn.prepareStatement(<span class="string">"INSERT INTO `rtb_member` (`phone`, `activeTime`) VALUES (? ,?)"</span>);</span><br><span class="line">    <span class="comment">// 填充模板</span></span><br><span class="line">    sql.setString(<span class="number">1</span>, <span class="string">"123456"</span>);</span><br><span class="line">    sql.setString(<span class="number">2</span>, nowTime);</span><br><span class="line">    <span class="comment">// 执行SQL语句</span></span><br><span class="line">    sql.executeUpdate();</span><br><span class="line">    System.out.println(<span class="string">"insert execute SUCCESS"</span>);</span><br><span class="line">  &#125;<span class="keyword">catch</span>(SQLException e) &#123;</span><br><span class="line">    <span class="comment">// 捕捉到错误</span></span><br><span class="line">    System.out.println(<span class="string">"insert execute error, err_msg:"</span> + e);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><ul><li>运行结果</li></ul><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309165141.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309165141.png" class="lazyload"></a></p><h2 id="数据修改"><a href="#数据修改" class="headerlink" title="数据修改"></a>数据修改</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 构造SQL模板</span></span><br><span class="line">    sql = conn.prepareStatement(<span class="string">"UPDATE `rtb_member` SET `phone`=? WHERE `phone`=?"</span>);</span><br><span class="line">    <span class="comment">// 填充SQL模板</span></span><br><span class="line">    sql.setString(<span class="number">1</span>, <span class="string">"654321"</span>);</span><br><span class="line">    sql.setString(<span class="number">2</span>, <span class="string">"123456"</span>);</span><br><span class="line">    <span class="comment">// 执行SQL语句</span></span><br><span class="line">    sql.executeUpdate();</span><br><span class="line">    System.out.println(<span class="string">"update execute SUCCESS"</span>);</span><br><span class="line">  &#125;<span class="keyword">catch</span>(SQLException e) &#123;</span><br><span class="line">    <span class="comment">// 捕捉到错误</span></span><br><span class="line">    System.out.println(<span class="string">"update execute error, err_msg:"</span> + e);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><ul><li>运行结果</li></ul><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309165438.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309165438.png" class="lazyload"></a></p><h2 id="数据删除"><a href="#数据删除" class="headerlink" title="数据删除"></a>数据删除</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 构造SQL模板</span></span><br><span class="line">    sql = conn.prepareStatement(<span class="string">"DELETE FROM `rtb_member` WHERE `phone`=?"</span>);</span><br><span class="line">    <span class="comment">// 填充SQL模板</span></span><br><span class="line">    sql.setString(<span class="number">1</span>, <span class="string">"654321"</span>);</span><br><span class="line">    <span class="comment">// 执行SQL语句</span></span><br><span class="line">    sql.executeUpdate();</span><br><span class="line">    System.out.println(<span class="string">"delete execute SUCCESS"</span>);</span><br><span class="line">  &#125;<span class="keyword">catch</span>(SQLException e) &#123;</span><br><span class="line">    <span class="comment">// 捕捉到错误</span></span><br><span class="line">    System.out.println(<span class="string">"delete execute error, err_msg:"</span> + e);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><ul><li>运行结果</li></ul><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309165535.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200309165535.png" class="lazyload"></a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;工具：eclipse&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;导入jdbc驱动包&quot;&gt;&lt;a href=&quot;#导入jdbc驱动包&quot; class=&quot;headerlink&quot; title=&quot;导入jdbc驱动包&quot;&gt;&lt;/a&gt;导入jdbc驱动包&lt;/h1&gt;
      
    
    </summary>
    
    
    
      <category term="Java" scheme="http://blog.webpro.ltd/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>kangle服务器 - easypanel API 文档</title>
    <link href="http://blog.webpro.ltd/2018/08/15/easypanel-API-doc/"/>
    <id>http://blog.webpro.ltd/2018/08/15/easypanel-API-doc/</id>
    <published>2018-08-14T16:00:00.000Z</published>
    <updated>2020-03-10T02:56:22.083Z</updated>
    
    <content type="html"><![CDATA[<h1 id="下载与之匹配的接口文件-PHP"><a href="#下载与之匹配的接口文件-PHP" class="headerlink" title="下载与之匹配的接口文件(PHP)"></a>下载与之匹配的接口文件(PHP)</h1><table><thead><tr><th align="center">类型</th><th align="center">下载地址</th></tr></thead><tbody><tr><td align="center"><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/fileTypeImages/file_zip.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img class="fileType-icon lazyload" data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/fileTypeImages/file_zip.png"></a></td><td align="center"><br><a href="/pan/easypanel_PHP_SDK.zip">easypanel_PHP_SDK.zip</a></td></tr></tbody></table><h1 id="接口概览"><a href="#接口概览" class="headerlink" title="接口概览"></a>接口概览</h1><blockquote><p>Easypanel的api通信安全码在easypanel的服务器设置处设置。</p></blockquote><ul><li>有以下接口接口：</li></ul><table><thead><tr><th align="center">接口名称</th><th align="center">用途</th></tr></thead><tbody><tr><td align="center">add_vh</td><td align="center">创建空间和修改空间</td></tr><tr><td align="center">update_vh</td><td align="center">暂停空间和恢复空间</td></tr><tr><td align="center">del_vh</td><td align="center">删除空间</td></tr><tr><td align="center">change_password</td><td align="center">修改空间的密码</td></tr></tbody></table><ul><li><p>通用返回信息:（返回内容为xml/json格式）</p><ul><li>安全码错误的返回信息:</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">xml</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">add_vh</span> <span class="attr">whm_version</span>=<span class="string">"1.0"</span>&gt;</span><span class="tag">&lt;<span class="name">result</span> <span class="attr">status</span>=<span class="string">'403 sign error'</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span><span class="tag">&lt;/<span class="name">add_vh</span>&gt;</span></span><br></pre></td></tr></table></figure></div><ul><li>创建、修改、删除创建成功的返回信息:</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">xml</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="tag">&lt;<span class="name">add_vh</span> <span class="attr">whm_version</span>=<span class="string">"1.0"</span>&gt;</span><span class="tag">&lt;<span class="name">result</span> <span class="attr">status</span>=<span class="string">'200'</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span><span class="tag">&lt;/<span class="name">add_vh</span>&gt;</span></span><br></pre></td></tr></table></figure></div><ul><li>创建、修改、删除失败的返回信息:</li></ul><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">xml</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="tag">&lt;<span class="name">add_vh</span> <span class="attr">whm_version</span>=<span class="string">"1.0"</span>&gt;</span><span class="tag">&lt;<span class="name">result</span> <span class="attr">status</span>=<span class="string">'500'</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span><span class="tag">&lt;/<span class="name">add_vh</span>&gt;</span></span><br></pre></td></tr></table></figure></div></li></ul><h2 id="add-vh-创建空间"><a href="#add-vh-创建空间" class="headerlink" title="add_vh:创建空间"></a>add_vh:创建空间</h2><ul><li><h3 id="接口地址及方法"><a href="#接口地址及方法" class="headerlink" title="接口地址及方法"></a>接口地址及方法</h3><ul><li>地址: 域名:3312/api/</li><li>方法: GET</li></ul></li><li><h3 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h3><ul><li><h4 id="固定参数"><a href="#固定参数" class="headerlink" title="固定参数"></a>固定参数</h4><table><thead><tr><th align="left">参数名</th><th align="left">说明</th><th align="left">(默认)值</th></tr></thead><tbody><tr><td align="left">c</td><td align="left">固定</td><td align="left">whm</td></tr><tr><td align="left">a</td><td align="left">操作名称（固定）</td><td align="left">add_vh</td></tr><tr><td align="left">s</td><td align="left">验证密钥,构成方式:md5(a.easypanel安全码.r)</td><td align="left">例(安全码为test):md5(add_vhtest1000)</td></tr><tr><td align="left">Init</td><td align="left">表示创建空间,固定为1即可</td><td align="left">1</td></tr><tr><td align="left">Name</td><td align="left">网站账号,数据库账号,ftp账号同步</td><td align="left"></td></tr><tr><td align="left">Passwd</td><td align="left">网站密码,数据库密码，ftp密码同步(只创建时同步)</td><td align="left"></td></tr></tbody></table></li><li><h4 id="可选参数"><a href="#可选参数" class="headerlink" title="可选参数"></a>可选参数</h4><table><thead><tr><th align="left">参数名</th><th align="left">说明</th><th align="left">(默认)值</th></tr></thead><tbody><tr><td align="left">Product_id</td><td align="left">easypanel里的产品ID</td><td align="left"></td></tr><tr><td align="left">Product_name</td><td align="left">easypanel里的产品名称</td><td align="left"></td></tr><tr><td align="left">vhost_domains</td><td align="left">绑定域名</td><td align="left"></td></tr><tr><td align="left">Cdn</td><td align="left">是否为CDN空间,是则发送1</td><td align="left"></td></tr><tr><td align="left">Templete</td><td align="left">语言(html|php|iis)</td><td align="left"></td></tr><tr><td align="left">Subtemplete</td><td align="left">语言引擎,php52|php53|php5217</td><td align="left"></td></tr><tr><td align="left">web_quota</td><td align="left">网页空间大小,数字</td><td align="left"></td></tr><tr><td align="left">db_quota</td><td align="left">数据库大小,数字</td><td align="left"></td></tr><tr><td align="left">db_type</td><td align="left">数据库类型,mysql|sqlsrv</td><td align="left"></td></tr><tr><td align="left">subdir_flag</td><td align="left">是否允许绑定子目录,1为是</td><td align="left"></td></tr><tr><td align="left">Subdir</td><td align="left">默认绑定目录,可为空,例:wwwroot</td><td align="left"></td></tr><tr><td align="left">max_subdir</td><td align="left">最多子目录数</td><td align="left"></td></tr><tr><td align="left">Domain</td><td align="left">最大绑定域名数，可空,默认会绑定到subdir指 定的目录下</td><td align="left"></td></tr><tr><td align="left">ftp</td><td align="left">是否开启ftp,1为是</td><td align="left"></td></tr><tr><td align="left">ftp_connec</td><td align="left">ftp最多连接数</td><td align="left"></td></tr><tr><td align="left">ftp_usl</td><td align="left">ftp上传速度限制,单位kb</td><td align="left"></td></tr><tr><td align="left">ftp_dsl</td><td align="left">ftp下载限制。单位kb</td><td align="left"></td></tr><tr><td align="left">Access</td><td align="left">是否自定义控制，1为是</td><td align="left"></td></tr><tr><td align="left">speed_limit</td><td align="left">带宽限制,数字型，默认为不限</td><td align="left"></td></tr><tr><td align="left">log_handle</td><td align="left">是否开启日志析分功能，1为是</td><td align="left"></td></tr><tr><td align="left">flow_limit</td><td align="left">流量限制,数字型</td><td align="left">默认不限</td></tr><tr><td align="left">max_connect</td><td align="left">空间最多连接数,可空</td><td align="left">默认采用kangle全局配置</td></tr><tr><td align="left">max_worker</td><td align="left">最多工作者,可空</td><td align="left">默认采用kangle全局配置</td></tr><tr><td align="left">ignore_backup</td><td align="left">是否备份,1为是</td><td align="left"></td></tr></tbody></table></li></ul></li><li><h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><figcaption><span>URL</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">域名:3312/api/?c=whm&amp;a=add_vh&amp;r=3333&amp;s=(md5)&amp;name=webtest&amp;passwd=webpasswd&amp;init=1&amp;product_name=php100</span><br></pre></td></tr></table></figure></div><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><figcaption><span>URL</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">域名:3312/api/?c=whm&amp;a=add_vh&amp;r=3333&amp;s=aaadddsfsdfaslkdfEsdfsad&amp;name=webtest&amp;passwd=webpasswd&amp;templete=php&amp;subtemplete=php52&amp;web_quota=1000&amp;db_quota=1000&amp;db_type=mysql&amp;ftp=1&amp;ftp_connect=3&amp;ftp_usl=50&amp;ftp_dsl=50&amp;access=1&amp;speed_limit=100&amp;log_handle=1&amp;flow_limit=3000&amp;ignore_backup=1&amp;domain=www.kanglesoft.com&amp;subdir_flag=1&amp;subdir=wwwroot&amp;max_subdir=3</span><br></pre></td></tr></table></figure></div></li><li><h3 id="add-vh-升级网站或者修改网站参数"><a href="#add-vh-升级网站或者修改网站参数" class="headerlink" title="add_vh:升级网站或者修改网站参数"></a>add_vh:升级网站或者修改网站参数</h3></li><li><p>其他参数和创建网站一样，只是需要把init=1换成edit=1即可。</p></li><li><p>例:</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><figcaption><span>URL</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">域名:3312/api/?c=whm&amp;a=add_vh&amp;r=3333&amp;s=adasdfasdf2322344&amp;name=webtest&amp;edit=1&amp;product_name=newproduct</span><br></pre></td></tr></table></figure></div></li></ul><h2 id="update-vh-暂停和恢复网站"><a href="#update-vh-暂停和恢复网站" class="headerlink" title="update_vh:暂停和恢复网站"></a>update_vh:暂停和恢复网站</h2><ul><li><h3 id="接口地址及方法-1"><a href="#接口地址及方法-1" class="headerlink" title="接口地址及方法"></a>接口地址及方法</h3><ul><li>地址: 域名:3312/api/</li><li>方法: GET</li></ul></li><li><h3 id="参数-1"><a href="#参数-1" class="headerlink" title="参数"></a>参数</h3><ul><li><h4 id="固定参数-1"><a href="#固定参数-1" class="headerlink" title="固定参数"></a>固定参数</h4><table><thead><tr><th align="left">参数名</th><th align="left">说明</th><th align="left">(默认)值</th></tr></thead><tbody><tr><td align="left">c</td><td align="left">固定</td><td align="left">whm</td></tr><tr><td align="left">a</td><td align="left">操作名称（固定）</td><td align="left">update_vh</td></tr><tr><td align="left">r</td><td align="left">随机数(1000-99999)</td><td align="left"></td></tr><tr><td align="left">S</td><td align="left">验证密钥。构成方式请参考创建空间说明</td><td align="left">例:md5(update_vhtest3333)</td></tr><tr><td align="left">Name</td><td align="left">网站名称</td><td align="left"></td></tr><tr><td align="left">Status</td><td align="left">网站的状态</td><td align="left">0为恢复，1为暂停</td></tr></tbody></table></li></ul></li><li><h3 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><figcaption><span>URL</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">域名:3312/api/?c=whm&amp;a=update_vh&amp;r=3333&amp;s=adasdfasdf2322344&amp;name=webtest&amp;status=0</span><br></pre></td></tr></table></figure></div></li></ul><h2 id="del-vh-删除网站"><a href="#del-vh-删除网站" class="headerlink" title="del_vh:删除网站"></a>del_vh:删除网站</h2><ul><li><h3 id="接口地址及方法-2"><a href="#接口地址及方法-2" class="headerlink" title="接口地址及方法"></a>接口地址及方法</h3><ul><li>地址: 域名:3312/api/</li><li>方法: GET</li></ul></li><li><h3 id="参数-2"><a href="#参数-2" class="headerlink" title="参数"></a>参数</h3><ul><li><h4 id="固定参数-2"><a href="#固定参数-2" class="headerlink" title="固定参数"></a>固定参数</h4><table><thead><tr><th align="left">参数名</th><th align="left">说明</th><th align="left">(默认)值</th></tr></thead><tbody><tr><td align="left">c</td><td align="left">固定</td><td align="left">whm</td></tr><tr><td align="left">a</td><td align="left">操作名称（固定）</td><td align="left">del_vh</td></tr><tr><td align="left">r</td><td align="left">随机数(1000-99999)</td><td align="left"></td></tr><tr><td align="left">S</td><td align="left">验证密钥。构成方式请参考创建空间说明</td><td align="left">例:md5(update_vhtest3333)</td></tr><tr><td align="left">Name</td><td align="left">网站名称</td><td align="left"></td></tr></tbody></table></li></ul></li><li><h3 id="示例-2"><a href="#示例-2" class="headerlink" title="示例"></a>示例</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><figcaption><span>URL</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">域名:3312/api/?c=whm&amp;a=del_vh&amp;r=3333&amp;s=adasdfasdf2322344&amp;name=webtest</span><br></pre></td></tr></table></figure></div></li></ul><h2 id="change-password-修改网站密码"><a href="#change-password-修改网站密码" class="headerlink" title="change_password:修改网站密码"></a>change_password:修改网站密码</h2><ul><li><h3 id="接口地址及方法-3"><a href="#接口地址及方法-3" class="headerlink" title="接口地址及方法"></a>接口地址及方法</h3><ul><li>地址: 域名:3312/api/</li><li>方法: GET</li></ul></li><li><h3 id="参数-3"><a href="#参数-3" class="headerlink" title="参数"></a>参数</h3><ul><li><h4 id="固定参数-3"><a href="#固定参数-3" class="headerlink" title="固定参数"></a>固定参数</h4><table><thead><tr><th align="left">参数名</th><th align="left">说明</th><th align="left">(默认)值</th></tr></thead><tbody><tr><td align="left">c</td><td align="left">固定</td><td align="left">whm</td></tr><tr><td align="left">a</td><td align="left">操作名称（固定）</td><td align="left">change_password</td></tr><tr><td align="left">r</td><td align="left">随机数(1000-99999)</td><td align="left"></td></tr><tr><td align="left">S</td><td align="left">验证密钥。构成方式请参考创建空间说明</td><td align="left">例:md5(update_vhtest3333)</td></tr><tr><td align="left">Name</td><td align="left">网站名称</td><td align="left"></td></tr><tr><td align="left">passwd</td><td align="left">修改的新密码</td><td align="left"></td></tr></tbody></table></li></ul></li><li><h3 id="示例-3"><a href="#示例-3" class="headerlink" title="示例"></a>示例</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><figcaption><span>URL</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">域名:3312/api/?c=whm&amp;a=change_password&amp;r=3333&amp;s=adasdfasdf2322344&amp;name=webtest&amp;passwd=newpasswd</span><br></pre></td></tr></table></figure></div></li></ul><h2 id="getVh-获取站点的信息"><a href="#getVh-获取站点的信息" class="headerlink" title="getVh:获取站点的信息"></a>getVh:获取站点的信息</h2><ul><li><h3 id="接口地址及方法-4"><a href="#接口地址及方法-4" class="headerlink" title="接口地址及方法"></a>接口地址及方法</h3><ul><li>地址: 域名:3312/api/</li><li>方法: GET</li></ul></li><li><h3 id="参数-4"><a href="#参数-4" class="headerlink" title="参数"></a>参数</h3><ul><li><h4 id="固定参数-4"><a href="#固定参数-4" class="headerlink" title="固定参数"></a>固定参数</h4><table><thead><tr><th align="left">参数名</th><th align="left">说明</th><th align="left">(默认)值</th></tr></thead><tbody><tr><td align="left">c</td><td align="left">固定</td><td align="left">whm</td></tr><tr><td align="left">a</td><td align="left">操作名称（固定）</td><td align="left">getVh</td></tr><tr><td align="left">Name</td><td align="left">网站名称</td><td align="left"></td></tr></tbody></table></li></ul></li><li><h3 id="示例-4"><a href="#示例-4" class="headerlink" title="示例"></a>示例</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><figcaption><span>URL</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">域名:3312/api/?c=whm&amp;a=getVh&amp;name=webtest</span><br></pre></td></tr></table></figure></div></li></ul><h2 id="listVh-获取站点列表"><a href="#listVh-获取站点列表" class="headerlink" title="listVh:获取站点列表"></a>listVh:获取站点列表</h2><ul><li><h3 id="接口地址及方法-5"><a href="#接口地址及方法-5" class="headerlink" title="接口地址及方法"></a>接口地址及方法</h3><ul><li>地址: 域名:3312/api/</li><li>方法: GET</li></ul></li><li><h3 id="参数-5"><a href="#参数-5" class="headerlink" title="参数"></a>参数</h3><ul><li><h4 id="固定参数-5"><a href="#固定参数-5" class="headerlink" title="固定参数"></a>固定参数</h4><table><thead><tr><th align="left">参数名</th><th align="left">说明</th><th align="left">(默认)值</th></tr></thead><tbody><tr><td align="left">c</td><td align="left">固定</td><td align="left">whm</td></tr><tr><td align="left">a</td><td align="left">操作名称（固定）</td><td align="left">listVh</td></tr><tr><td align="left">r</td><td align="left">随机数(1000-99999)</td><td align="left"></td></tr><tr><td align="left">S</td><td align="left">验证密钥。构成方式请参考创建空间说明</td><td align="left">例:md5(update_vhtest3333)</td></tr></tbody></table></li></ul></li><li><h3 id="示例-5"><a href="#示例-5" class="headerlink" title="示例"></a>示例</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><figcaption><span>URL</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">域名:3312/api/?c=whm&amp;a=listVh&amp;r=3333&amp;s=adasdfasdf2322344</span><br></pre></td></tr></table></figure></div></li></ul><h2 id="Test-Code"><a href="#Test-Code" class="headerlink" title="Test Code"></a>Test Code</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">"content-type: text/html; charset=utf-8"</span>);</span><br><span class="line">$xmls = <span class="string">'&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;add_vh whm_version="1.0"&gt;&lt;result status=\'403 sign error\'&gt;&lt;/result&gt;&lt;/add_vh&gt;'</span>;</span><br><span class="line"></span><br><span class="line">$epsafecode = <span class="string">"xCxWDxc4xxxtxdmx"</span>;</span><br><span class="line">$rand = rand(<span class="number">1000</span>, <span class="number">99999</span>);</span><br><span class="line"></span><br><span class="line">$domain = <span class="string">"http://103.74.173.19:3312/api/?"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 所有参数组，带上一个json=1后将返回json字符串</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 增加主机参数</span></span><br><span class="line">$param = <span class="keyword">array</span>(</span><br><span class="line">  <span class="string">'c'</span> =&gt; <span class="string">'whm'</span>,</span><br><span class="line">  <span class="string">'a'</span> =&gt; <span class="string">'add_vh'</span>,</span><br><span class="line">  <span class="string">'r'</span> =&gt; $rand,</span><br><span class="line">  <span class="string">'s'</span> =&gt; md5(<span class="string">'add_vh'</span>.$epsafecode.$rand),</span><br><span class="line">  <span class="string">'Init'</span> =&gt; <span class="string">'1'</span>,</span><br><span class="line">  <span class="string">'name'</span> =&gt; <span class="string">'mytest'</span>,</span><br><span class="line">  <span class="string">'passwd'</span> =&gt; <span class="string">'test'</span>,</span><br><span class="line">  <span class="string">'product_id'</span> =&gt; <span class="number">3</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对已有的主机进行套餐升级</span></span><br><span class="line">$param = <span class="keyword">array</span>(</span><br><span class="line">  <span class="string">'c'</span> =&gt; <span class="string">'whm'</span>,</span><br><span class="line">  <span class="string">'a'</span> =&gt; <span class="string">'add_vh'</span>,</span><br><span class="line">  <span class="string">'r'</span> =&gt; $rand,</span><br><span class="line">  <span class="string">'s'</span> =&gt; md5(<span class="string">'add_vh'</span>.$epsafecode.$rand),</span><br><span class="line">  <span class="string">'name'</span> =&gt; <span class="string">'mytest'</span>,</span><br><span class="line">  <span class="string">'edit'</span> =&gt; <span class="number">1</span>,</span><br><span class="line">  <span class="string">'product_id'</span> =&gt; <span class="number">3</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 暂停或恢复网站 status = 0 恢复 status = 1 暂停</span></span><br><span class="line">$param = <span class="keyword">array</span>(</span><br><span class="line">  <span class="string">'c'</span> =&gt; <span class="string">'whm'</span>,</span><br><span class="line">  <span class="string">'a'</span> =&gt; <span class="string">'update_vh'</span>,</span><br><span class="line">  <span class="string">'r'</span> =&gt; $rand,</span><br><span class="line">  <span class="string">'s'</span> =&gt; md5(<span class="string">'update_vh'</span>.$epsafecode.$rand),</span><br><span class="line">  <span class="string">'name'</span> =&gt; <span class="string">'mytest'</span>,</span><br><span class="line">  <span class="string">'status'</span> =&gt; <span class="number">0</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改网站密码</span></span><br><span class="line">$param = <span class="keyword">array</span>(</span><br><span class="line">  <span class="string">'c'</span> =&gt; <span class="string">'whm'</span>,</span><br><span class="line">  <span class="string">'a'</span> =&gt; <span class="string">'change_password'</span>,</span><br><span class="line">  <span class="string">'r'</span> =&gt; $rand,</span><br><span class="line">  <span class="string">'s'</span> =&gt; md5(<span class="string">'change_password'</span>.$epsafecode.$rand),</span><br><span class="line">  <span class="string">'name'</span> =&gt; <span class="string">'mytest'</span>,</span><br><span class="line">  <span class="string">'passwd'</span> =&gt; <span class="string">'123456'</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除网站</span></span><br><span class="line">$param = <span class="keyword">array</span>(</span><br><span class="line">  <span class="string">'c'</span> =&gt; <span class="string">'whm'</span>,</span><br><span class="line">  <span class="string">'a'</span> =&gt; <span class="string">'del_vh'</span>,</span><br><span class="line">  <span class="string">'r'</span> =&gt; $rand,</span><br><span class="line">  <span class="string">'s'</span> =&gt; md5(<span class="string">'del_vh'</span>.$epsafecode.$rand),</span><br><span class="line">  <span class="string">'name'</span> =&gt; <span class="string">'mytest'</span>,</span><br><span class="line">  <span class="string">'json'</span> =&gt; <span class="number">1</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取服务器信息</span></span><br><span class="line">$param = <span class="keyword">array</span>(</span><br><span class="line">  <span class="string">'c'</span> =&gt; <span class="string">'whm'</span>,</span><br><span class="line">  <span class="string">'a'</span> =&gt; <span class="string">'info'</span>,</span><br><span class="line">  <span class="string">'r'</span> =&gt; $rand,</span><br><span class="line">  <span class="string">'s'</span> =&gt; md5(<span class="string">'info'</span>.$epsafecode.$rand),</span><br><span class="line">  <span class="string">'json'</span> =&gt; <span class="number">1</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取站点列表</span></span><br><span class="line">$param = <span class="keyword">array</span>(</span><br><span class="line">  <span class="string">'c'</span> =&gt; <span class="string">'whm'</span>,</span><br><span class="line">  <span class="string">'a'</span> =&gt; <span class="string">'listVh'</span>,</span><br><span class="line">  <span class="string">'r'</span> =&gt; $rand,</span><br><span class="line">  <span class="string">'s'</span> =&gt; md5(<span class="string">'listVh'</span>.$epsafecode.$rand),</span><br><span class="line">  <span class="string">'json'</span> =&gt; <span class="number">1</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取某一站点的信息</span></span><br><span class="line">$param = <span class="keyword">array</span>(</span><br><span class="line">  <span class="string">'c'</span> =&gt; <span class="string">'whm'</span>,</span><br><span class="line">  <span class="string">'a'</span> =&gt; <span class="string">'getVh'</span>,</span><br><span class="line">  <span class="string">'r'</span> =&gt; $rand,</span><br><span class="line">  <span class="string">'s'</span> =&gt; md5(<span class="string">'getVh'</span>.$epsafecode.$rand),</span><br><span class="line">  <span class="string">'name'</span> =&gt; <span class="string">'sumiaomiao'</span>,</span><br><span class="line">  <span class="string">'json'</span> =&gt; <span class="number">1</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">$param = http_build_query($param);</span><br><span class="line">$url = $domain.$param;</span><br><span class="line">$xmls = file_get_contents($url);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;pre&gt;'</span>;</span><br><span class="line">print_r(json_decode($xmls, <span class="keyword">true</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;/pre&gt;'</span>;</span><br><span class="line"><span class="keyword">exit</span>;</span><br><span class="line"></span><br><span class="line">$xml =simplexml_load_string($xmls);</span><br><span class="line">$xmljson= json_encode($xml);</span><br><span class="line">$xml=json_decode($xmljson,<span class="keyword">true</span>);</span><br><span class="line">print_r($xml);</span><br><span class="line"><span class="keyword">echo</span> $xml[<span class="string">'result'</span>][<span class="string">'@attributes'</span>][<span class="string">'status'</span>];</span><br></pre></td></tr></table></figure></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;下载与之匹配的接口文件-PHP&quot;&gt;&lt;a href=&quot;#下载与之匹配的接口文件-PHP&quot; class=&quot;headerlink&quot; title=&quot;下载与之匹配的接口文件(PHP)&quot;&gt;&lt;/a&gt;下载与之匹配的接口文件(PHP)&lt;/h1&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr
      
    
    </summary>
    
    
    
      <category term="kangle" scheme="http://blog.webpro.ltd/tags/kangle/"/>
    
      <category term="easypanel" scheme="http://blog.webpro.ltd/tags/easypanel/"/>
    
  </entry>
  
  <entry>
    <title>旧版正方教务处验证码识别</title>
    <link href="http://blog.webpro.ltd/2018/03/22/zf-verifyCode-ocr/"/>
    <id>http://blog.webpro.ltd/2018/03/22/zf-verifyCode-ocr/</id>
    <published>2018-03-21T16:00:00.000Z</published>
    <updated>2020-03-11T03:11:33.788Z</updated>
    
    <content type="html"><![CDATA[<p>本文以安徽工业大学的正方教务系统验证码为实例</p><p>请提前将验证码下载为gif格式图片到本地</p><p>附件1:model.ini (字模文件，已经提取好，不需修改)</p><p>原理即将图像进行二值化处理，逐一对每一个像素点进行处理，处理结果非黑即白</p><h2 id="【业务逻辑】"><a href="#【业务逻辑】" class="headerlink" title="【业务逻辑】"></a>【业务逻辑】</h2><p>1、首先从网络上下载验证码，存储到本地</p><p>2、校验图片信息，确保是gif（因为算法中采用的是gif引擎对图片处理，可根据自身需求自己修改代码中的引擎）</p><pre><code>通过打印图片基本信息，得到以下数组</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Array ( [0] &#x3D;&gt; 60 [1] &#x3D;&gt; 22 [2] &#x3D;&gt; 1 [3] &#x3D;&gt; width&#x3D;”60 ” height&#x3D;”22 ” [bits] &#x3D;&gt; 8 [channels] &#x3D;&gt; 3 [mime] &#x3D;&gt; image&#x2F;gif )</span><br></pre></td></tr></table></figure></div><p>3、将图像进行灰度化处理，这样可以使图像二值化难度降低，示例见下图</p><p>4、二值化处理图像</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$rgbarray[<span class="string">'red '</span>] &lt;= <span class="number">84</span>  &amp;&amp; $rgbarray[<span class="string">'green '</span>] &lt;= <span class="number">80</span>  &amp;&amp; $rgbarray[<span class="string">'blue '</span>] &lt;= <span class="number">240</span></span><br></pre></td></tr></table></figure></div><p>通过观察发现，将图像的RGB控制在(84, 80, 240)以内，打印输出■，否则输出□（存储在数组内）,此时的识别效果最精准</p><p>5、对二值化的图像进行分割处理，该验证码排列规律性极强，故分割可以做到精确，将5个数字分割开来，将5个数字的数组分别与model.ini中的字模加以对比</p><p>6、对于经常识别出错的数字，我们对其提取特征，二次验证</p><p>7、处理结果展示</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Array ( [0] &#x3D;&gt; 60 [1] &#x3D;&gt; 22 [2] &#x3D;&gt; 1 [3] &#x3D;&gt; width&#x3D;&quot;60 &quot; height&#x3D;&quot;22 &quot; [bits] &#x3D;&gt; 8 [channels] &#x3D;&gt; 3 [mime] &#x3D;&gt; image&#x2F;gif )</span><br></pre></td></tr></table></figure></div><p><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200308123051.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200308123051.png" class="lazyload"></a><br><a href="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200308123050.png" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/billwhite246/myPicBedRepo@master/img/20200308123050.png" class="lazyload"></a></p><p><code>上述过程都放在了DealCode.class.php</code></p><h3 id="【爬取验证码】"><a href="#【爬取验证码】" class="headerlink" title="【爬取验证码】"></a>【爬取验证码】</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 爬取图片</span></span><br><span class="line">  <span class="keyword">include</span>(<span class="string">"DealCode.class.php"</span>);</span><br><span class="line">  $img = CURL(<span class="string">"http://211.70.149.135:88/CheckCode.aspx"</span>,<span class="keyword">array</span>(</span><br><span class="line">      <span class="string">"Cache-Control: max-age=0"</span>,</span><br><span class="line">      <span class="string">"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8"</span>,</span><br><span class="line">      <span class="string">"Accept-Language: zh-CN,zh;q=0.9"</span>,</span><br><span class="line">      <span class="string">"User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36"</span>,</span><br><span class="line">      <span class="string">"Upgrade-Insecure-Requests: 1"</span>,</span><br><span class="line">      <span class="string">"Host: 211.70.149.135:88"</span>,</span><br><span class="line">      <span class="string">"Proxy-Connection: keep-alive"</span></span><br><span class="line">    ),</span><br><span class="line">    <span class="string">"GET"</span>,</span><br><span class="line">    <span class="string">""</span>,</span><br><span class="line">    <span class="keyword">false</span></span><br><span class="line">  );</span><br><span class="line">  <span class="comment">// 用了一个订单号的算法生成唯一文件名</span></span><br><span class="line">  @date_default_timezone_set(<span class="string">"PRC"</span>);</span><br><span class="line">  <span class="comment">//订购日期</span></span><br><span class="line">  $a=<span class="keyword">array</span>();</span><br><span class="line">  $order_date = date(<span class="string">'Y-m-d'</span>);</span><br><span class="line">  <span class="comment">//订单号码主体（YYYYMMDDHHIISSNNNNNNNN）</span></span><br><span class="line">  $order_id_main = date(<span class="string">'YmdHis'</span>) . rand(<span class="number">10000000</span>,<span class="number">99999999</span>);</span><br><span class="line">  <span class="comment">//订单号码主体长度</span></span><br><span class="line">  $order_id_len = strlen($order_id_main);</span><br><span class="line">  $order_id_sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ($i=<span class="number">0</span>; $i&lt;$order_id_len; $i++) &#123;</span><br><span class="line">    $order_id_sum += (int)(substr($order_id_main,$i,<span class="number">1</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//唯一订单号码（YYYYMMDDHHIISSNNNNNNNNCC）</span></span><br><span class="line">  $order_id = $order_id_main . str_pad((<span class="number">100</span> - $order_id_sum % <span class="number">100</span>) % <span class="number">100</span>,<span class="number">2</span>,<span class="string">'0'</span>,STR_PAD_LEFT);</span><br><span class="line">  file_put_contents(<span class="string">'zf/'</span>.$order_id.<span class="string">'.jpg'</span>,$img);</span><br><span class="line">  <span class="comment">//sleep(1);</span></span><br><span class="line">  $p=<span class="keyword">new</span> DealCode();</span><br><span class="line">  $t1 = microtime(<span class="keyword">true</span>); <span class="comment">// 识别开始时间</span></span><br><span class="line">  $p-&gt;loadVerify(<span class="string">'zf/'</span>.$order_id.<span class="string">'.jpg'</span>,<span class="number">0</span>);</span><br><span class="line">  $codeRes=$p-&gt;OCR_CODE();</span><br><span class="line">  $show=$p-&gt;OCR_SHOW();  <span class="comment">// 显示图片</span></span><br><span class="line">  $t2 = microtime(<span class="keyword">true</span>); <span class="comment">// 识别结束时间</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><h3 id="【DealCode-class-php源文件】"><a href="#【DealCode-class-php源文件】" class="headerlink" title="【DealCode.class.php源文件】"></a>【DealCode.class.php源文件】</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">*文件名:DealCode.class.php</span></span><br><span class="line"><span class="comment">*版本：</span></span><br><span class="line"><span class="comment">0.0.1</span></span><br><span class="line"><span class="comment">0.1.0</span></span><br><span class="line"><span class="comment">*时间：</span></span><br><span class="line"><span class="comment">2018年2月15日 14点23分</span></span><br><span class="line"><span class="comment">2018年3月21日 21点09分</span></span><br><span class="line"><span class="comment">*作者：苏喵喵</span></span><br><span class="line"><span class="comment">*功能：识别传来处的理后的*数字*图片，仅适用于安徽工业大学教务处系统的验证码</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">header(<span class="string">'content-type:text/html;charset=utf-8'</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DealCode</span> </span>&#123;</span><br><span class="line"><span class="comment">//图片地址（本地）</span></span><br><span class="line"><span class="keyword">private</span> $imagePath;</span><br><span class="line"><span class="keyword">private</span> $origin_code;</span><br><span class="line"><span class="keyword">private</span> $code;</span><br><span class="line"><span class="keyword">private</span> $model;</span><br><span class="line"><span class="comment">//RGB阈值</span></span><br><span class="line"><span class="keyword">private</span> $rmax;</span><br><span class="line"><span class="keyword">private</span> $gmax;</span><br><span class="line"><span class="keyword">private</span> $bmax;</span><br><span class="line"><span class="comment">//验证码的类型</span></span><br><span class="line"><span class="keyword">private</span> $type;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">self</span>::classify();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 验证码类别分流</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> $type</span></span><br><span class="line"><span class="comment">* </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">classify</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//初始化字模</span></span><br><span class="line">$config_file_path = <span class="string">'model.ini'</span>;</span><br><span class="line">$config_info = parse_ini_file($config_file_path,<span class="keyword">true</span>);</span><br><span class="line"><span class="comment">//筛选验证码类型</span></span><br><span class="line"><span class="keyword">switch</span>(<span class="keyword">$this</span>-&gt;type) &#123;</span><br><span class="line"><span class="comment">//安徽工业大学验证码</span></span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line"><span class="keyword">$this</span>-&gt;model=<span class="keyword">array</span>(</span><br><span class="line"><span class="number">0</span> =&gt; $config_info[<span class="string">'ahut'</span>][<span class="string">'0'</span>],</span><br><span class="line"><span class="number">1</span> =&gt; $config_info[<span class="string">'ahut'</span>][<span class="string">'1'</span>],</span><br><span class="line"><span class="number">2</span> =&gt; $config_info[<span class="string">'ahut'</span>][<span class="string">'2'</span>],</span><br><span class="line"><span class="number">3</span> =&gt; $config_info[<span class="string">'ahut'</span>][<span class="string">'3'</span>],</span><br><span class="line"><span class="number">4</span> =&gt; $config_info[<span class="string">'ahut'</span>][<span class="string">'4'</span>],</span><br><span class="line"><span class="number">5</span> =&gt; $config_info[<span class="string">'ahut'</span>][<span class="string">'5'</span>],</span><br><span class="line"><span class="number">6</span> =&gt; $config_info[<span class="string">'ahut'</span>][<span class="string">'6'</span>],</span><br><span class="line"><span class="number">7</span> =&gt; $config_info[<span class="string">'ahut'</span>][<span class="string">'7'</span>],</span><br><span class="line"><span class="number">8</span> =&gt; $config_info[<span class="string">'ahut'</span>][<span class="string">'8'</span>],</span><br><span class="line"><span class="number">9</span> =&gt; $config_info[<span class="string">'ahut'</span>][<span class="string">'9'</span>],</span><br><span class="line"><span class="string">'v5'</span> =&gt; $config_info[<span class="string">'ahut'</span>][<span class="string">'v5'</span>], <span class="comment">//数字5特征提取</span></span><br><span class="line"><span class="string">'v6'</span> =&gt; $config_info[<span class="string">'ahut'</span>][<span class="string">'v6'</span>], <span class="comment">//数字6特征提取</span></span><br><span class="line"><span class="string">'v7'</span> =&gt; $config_info[<span class="string">'ahut'</span>][<span class="string">'v7'</span>], <span class="comment">//数字7特征提取</span></span><br><span class="line"><span class="string">'v8'</span> =&gt; $config_info[<span class="string">'ahut'</span>][<span class="string">'v8'</span>], <span class="comment">//数字8特征提取</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">//print_r($this-&gt;model);</span></span><br><span class="line"><span class="keyword">$this</span>-&gt;code=<span class="keyword">array</span>(</span><br><span class="line"><span class="number">0</span> =&gt; <span class="keyword">null</span>,</span><br><span class="line"><span class="number">1</span> =&gt; <span class="keyword">null</span>,</span><br><span class="line"><span class="number">2</span> =&gt; <span class="keyword">null</span>,</span><br><span class="line"><span class="number">3</span> =&gt; <span class="keyword">null</span>,</span><br><span class="line"><span class="number">4</span> =&gt; <span class="keyword">null</span>,</span><br><span class="line">);</span><br><span class="line"><span class="keyword">$this</span>-&gt;rmax=<span class="number">125</span>;</span><br><span class="line"><span class="keyword">$this</span>-&gt;gmax=<span class="number">94</span>;</span><br><span class="line"><span class="keyword">$this</span>-&gt;bmax=<span class="number">222</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'没有该学校的识别方法！'</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  * 载入验证码，必要步骤</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> $imagePath</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@return</span> $number</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadVerify</span><span class="params">($imagePath,$type)</span> </span>&#123;</span><br><span class="line">$im = imagecreatefromgif($imagePath);</span><br><span class="line">unlink($imagePath);</span><br><span class="line"><span class="keyword">if</span> ($im &amp;&amp; imagefilter($im, IMG_FILTER_GRAYSCALE)) &#123;</span><br><span class="line"><span class="comment">// echo 'Image converted to grayscale.';</span></span><br><span class="line">imagegif($im, $imagePath);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Conversion to grayscale failed.'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">$this</span>-&gt;imagePath=$imagePath;</span><br><span class="line"><span class="keyword">$this</span>-&gt;type=$type;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 【安工大教务处】验证码识别</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> $imagePath</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span> $number</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">OCR_CODE</span><span class="params">()</span> </span>&#123;</span><br><span class="line">$codeRes=<span class="keyword">self</span>::getHec();</span><br><span class="line"><span class="keyword">return</span> $codeRes;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 显示二值化的图片</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> $imagePath</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span> 二值化的图片</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">OCR_SHOW</span><span class="params">()</span> </span>&#123;</span><br><span class="line">$array = getimagesize(<span class="keyword">$this</span>-&gt;imagePath);</span><br><span class="line">print_r($array);</span><br><span class="line"><span class="keyword">self</span>::visualHec();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">visualHec</span><span class="params">()</span> </span>&#123;</span><br><span class="line">$res = imagecreatefromgif(<span class="keyword">$this</span>-&gt;imagePath);</span><br><span class="line"><span class="comment">//$res = imagecreatefrompng($this-&gt;imagePath);</span></span><br><span class="line">$size = getimagesize(<span class="keyword">$this</span>-&gt;imagePath);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;pre&gt;"</span>;</span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $size[<span class="number">1</span>]; ++$i) &#123;</span><br><span class="line"><span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; $size[<span class="number">0</span>]; ++$j) &#123;</span><br><span class="line">$rgb = imagecolorat($res, $j, $i);</span><br><span class="line">$rgbarray = imagecolorsforindex($res, $rgb);</span><br><span class="line"><span class="keyword">if</span> ($rgbarray[<span class="string">'red'</span>] &lt; (<span class="keyword">$this</span>-&gt;rmax) &amp;&amp; $rgbarray[<span class="string">'green'</span>] &lt; (<span class="keyword">$this</span>-&gt;gmax) &amp;&amp; $rgbarray[<span class="string">'blue'</span>] &lt; (<span class="keyword">$this</span>-&gt;bmax)) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"■"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"□"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"[完毕]"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/pre&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">getHec</span><span class="params">()</span> </span>&#123;</span><br><span class="line">$m=<span class="string">''</span>;</span><br><span class="line">$codeRes=<span class="string">''</span>;</span><br><span class="line">$res = imagecreatefromgif(<span class="keyword">$this</span>-&gt;imagePath);</span><br><span class="line"><span class="comment">//$res = imagecreatefrompng($this-&gt;imagePath);</span></span><br><span class="line">$size = getimagesize(<span class="keyword">$this</span>-&gt;imagePath);</span><br><span class="line"><span class="comment">//坐标：(j宽度,i高度)</span></span><br><span class="line"><span class="comment">//第一个字模的矩阵为:宽度0-13，高度所有</span></span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $size[<span class="number">1</span>]; ++$i) &#123;</span><br><span class="line"><span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; $size[<span class="number">0</span>]; ++$j) &#123;</span><br><span class="line">$rgb = imagecolorat($res, $j, $i);</span><br><span class="line">$rgbarray = imagecolorsforindex($res, $rgb);</span><br><span class="line"><span class="keyword">if</span> ($rgbarray[<span class="string">'red'</span>] &lt; (<span class="keyword">$this</span>-&gt;rmax) &amp;&amp; $rgbarray[<span class="string">'green'</span>] &lt; (<span class="keyword">$this</span>-&gt;gmax) &amp;&amp; $rgbarray[<span class="string">'blue'</span>] &lt; (<span class="keyword">$this</span>-&gt;bmax)) &#123;</span><br><span class="line">$m = <span class="string">"0"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">$m = <span class="string">"1"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">$this</span>-&gt;origin_code[$i][$j]=$m;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">switch</span>(<span class="keyword">$this</span>-&gt;type) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">$codeRes=<span class="keyword">self</span>::ahut_DealCode();</span><br><span class="line"><span class="keyword">return</span> $codeRes;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">ahut_DealCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> ($p=<span class="number">5</span>;$p&lt;<span class="number">17</span>;$p++) &#123;</span><br><span class="line"><span class="keyword">for</span> ($q=<span class="number">5</span>;$q&lt;<span class="number">14</span>;$q++) &#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;code[<span class="number">0</span>]=<span class="keyword">$this</span>-&gt;code[<span class="number">0</span>].<span class="keyword">$this</span>-&gt;origin_code[$p][$q];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> ($p=<span class="number">5</span>;$p&lt;<span class="number">17</span>;$p++) &#123;</span><br><span class="line"><span class="keyword">for</span> ($q=<span class="number">14</span>;$q&lt;<span class="number">23</span>;$q++) &#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;code[<span class="number">1</span>]=<span class="keyword">$this</span>-&gt;code[<span class="number">1</span>].<span class="keyword">$this</span>-&gt;origin_code[$p][$q];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> ($p=<span class="number">5</span>;$p&lt;<span class="number">17</span>;$p++) &#123;</span><br><span class="line"><span class="keyword">for</span> ($q=<span class="number">23</span>;$q&lt;<span class="number">32</span>;$q++) &#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;code[<span class="number">2</span>]=<span class="keyword">$this</span>-&gt;code[<span class="number">2</span>].<span class="keyword">$this</span>-&gt;origin_code[$p][$q];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> ($p=<span class="number">5</span>;$p&lt;<span class="number">17</span>;$p++) &#123;</span><br><span class="line"><span class="keyword">for</span> ($q=<span class="number">32</span>;$q&lt;<span class="number">41</span>;$q++) &#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;code[<span class="number">3</span>]=<span class="keyword">$this</span>-&gt;code[<span class="number">3</span>].<span class="keyword">$this</span>-&gt;origin_code[$p][$q];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> ($p=<span class="number">5</span>;$p&lt;<span class="number">17</span>;$p++) &#123;</span><br><span class="line"><span class="keyword">for</span> ($q=<span class="number">41</span>;$q&lt;<span class="number">50</span>;$q++) &#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;code[<span class="number">4</span>]=<span class="keyword">$this</span>-&gt;code[<span class="number">4</span>].<span class="keyword">$this</span>-&gt;origin_code[$p][$q];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// echo "&lt;pre&gt;";</span></span><br><span class="line"><span class="comment">// print_r($this-&gt;code);</span></span><br><span class="line"><span class="comment">// echo "&lt;pre/&gt;";</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    * 算法优化</span></span><br><span class="line"><span class="comment">    * 对于没有识别出来的，不到达指定匹配程度的数字进行降匹配率限制操作</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">$codeArr=<span class="keyword">array</span>(</span><br><span class="line"><span class="number">0</span> =&gt; <span class="string">'-1'</span>,</span><br><span class="line"><span class="number">1</span> =&gt; <span class="string">'-1'</span>,</span><br><span class="line"><span class="number">2</span> =&gt; <span class="string">'-1'</span>,</span><br><span class="line"><span class="number">3</span> =&gt; <span class="string">'-1'</span>,</span><br><span class="line"><span class="number">4</span> =&gt; <span class="string">'-1'</span>,</span><br><span class="line">);</span><br><span class="line">$codeRes=<span class="string">''</span>;</span><br><span class="line"><span class="comment">/*校验验证码位数，是否全部识别出来，没有识别出来的，降低匹配率限制</span></span><br><span class="line"><span class="comment">    匹配率，选出匹配率最高的*/</span></span><br><span class="line"><span class="comment">//初始化单字符匹配率</span></span><br><span class="line">$percent=<span class="number">0</span>;</span><br><span class="line"><span class="comment">//初始化单字符最大匹配程度存储变量</span></span><br><span class="line">$p=<span class="number">0</span>;</span><br><span class="line"><span class="comment">//初始化相似度</span></span><br><span class="line">$sim=<span class="keyword">array</span>(</span><br><span class="line">      <span class="number">0</span> =&gt; <span class="number">0</span>,</span><br><span class="line">      <span class="number">1</span> =&gt; <span class="number">0</span>,</span><br><span class="line">      <span class="number">2</span> =&gt; <span class="number">0</span>,</span><br><span class="line">      <span class="number">3</span> =&gt; <span class="number">0</span>,</span><br><span class="line">      <span class="number">4</span> =&gt; <span class="number">0</span>,</span><br><span class="line">      <span class="number">5</span> =&gt; <span class="number">0</span>,</span><br><span class="line">      <span class="number">6</span> =&gt; <span class="number">0</span>,</span><br><span class="line">      <span class="number">7</span> =&gt; <span class="number">0</span>,</span><br><span class="line">      <span class="number">8</span> =&gt; <span class="number">0</span>,</span><br><span class="line">      <span class="number">9</span> =&gt; <span class="number">0</span>,</span><br><span class="line">);</span><br><span class="line"><span class="keyword">for</span> ($i=<span class="number">0</span>;$i&lt;<span class="number">5</span>;$i++) &#123;</span><br><span class="line"><span class="comment">//++代码兼容性</span></span><br><span class="line"><span class="keyword">if</span>($codeArr[$i]==<span class="string">'-1'</span>) &#123;</span><br><span class="line"><span class="keyword">foreach</span>(<span class="keyword">$this</span>-&gt;model <span class="keyword">as</span> $key=&gt;$value) &#123;</span><br><span class="line">similar_text(<span class="keyword">$this</span>-&gt;code[$i],$value,$percent);</span><br><span class="line">$sim[$key]=$percent;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//筛选出匹配程度最大的</span></span><br><span class="line"><span class="comment">//筛选出来的键名$p就是验证码对应的数字;</span></span><br><span class="line">$p=array_search(max($sim), $sim);</span><br><span class="line"><span class="comment">//$p=(string)$p;</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">             识别进化</span></span><br><span class="line"><span class="comment">             对于上述的算法，会造成机器5、6不分，7、8不分，因此识别到5/6/7/8的数字时，要进一步对这四个数字的局部特征进行进一步比对</span></span><br><span class="line"><span class="comment">             根据2018年3月21日实验发现，仅仅是在，</span></span><br><span class="line"><span class="comment">                识别图片8=&gt;数字7，暂时没有发现识别图片7=&gt;数字8，这是单向的，8=&gt;7</span></span><br><span class="line"><span class="comment">                识别图片6=&gt;数字5，暂时没有发现识别图片5=&gt;数字6，这是单向的，6=&gt;5</span></span><br><span class="line"><span class="comment">                因此在识别结果为6/8的时候，再次进行校验，比对特征区域，通过则输出6/8，否则输出5/7</span></span><br><span class="line"><span class="comment">                对于上述的算法，识别到6/8的数字时，要进一步对这2个数字的局部特征进行进一步比对</span></span><br><span class="line"><span class="comment">             另外发现，验证码前部图片识别失败率明显高于后部，初步判定原因可能是底色分离问题导致</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line"><span class="keyword">if</span>($p==<span class="string">'6'</span>) &#123;</span><br><span class="line">$vp=substr(<span class="keyword">$this</span>-&gt;code[$i],<span class="number">63</span>,<span class="number">71</span>);</span><br><span class="line">similar_text(<span class="keyword">$this</span>-&gt;model[<span class="string">'v5'</span>],$vp,$vpPercentA);</span><br><span class="line">similar_text(<span class="keyword">$this</span>-&gt;model[<span class="string">'v6'</span>],$vp,$vpPercentB);</span><br><span class="line"><span class="comment">//if($vpPercent&lt;77.777777777778)&#123;</span></span><br><span class="line"><span class="keyword">if</span>($vpPercentA&gt;$vpPercentB) &#123;</span><br><span class="line">$p=<span class="string">'5'</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($p==<span class="string">'8'</span>) &#123;</span><br><span class="line">$vp=substr(<span class="keyword">$this</span>-&gt;code[$i],<span class="number">45</span>,<span class="number">62</span>);</span><br><span class="line">similar_text(<span class="keyword">$this</span>-&gt;model[<span class="string">'v7'</span>],$vp,$vpPercentA);</span><br><span class="line">similar_text(<span class="keyword">$this</span>-&gt;model[<span class="string">'v8'</span>],$vp,$vpPercentB);</span><br><span class="line"><span class="comment">//if($vpPercent&lt;50)&#123;</span></span><br><span class="line"><span class="keyword">if</span>($vpPercentA&gt;$vpPercentB) &#123;</span><br><span class="line">$p=<span class="string">'7'</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">$codeArr[$i]=$p;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">$codeRes=$codeArr[<span class="number">0</span>].$codeArr[<span class="number">1</span>].$codeArr[<span class="number">2</span>].$codeArr[<span class="number">3</span>].$codeArr[<span class="number">4</span>];</span><br><span class="line"><span class="keyword">return</span> $codeRes;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>附件：model.ini</p><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">ini</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[ahut]</span></span><br><span class="line"><span class="attr">0</span> = <span class="number">110000111100000011000110001001111001001111001001111001001111001001111001001111001000110001100000011110000111</span></span><br><span class="line"><span class="attr">1</span> = <span class="number">111100111111000111110000111100100111101100111111100111111100111111100111111100111111100111111100111111100111</span></span><br><span class="line"><span class="attr">2</span> = <span class="number">110000111100000011000111001001111001111111001111110011111100011111000111110001111100111111000000001000000001</span></span><br><span class="line"><span class="attr">3</span> = <span class="number">110000011100000001001111001111111001111000011111000011111110001111111001001111001000110001100000011110000111</span></span><br><span class="line"><span class="attr">4</span> = <span class="number">111110011111100011111100011111000011110010011110010011100110011001110011000000001000000001111110011111110011</span></span><br><span class="line"><span class="attr">5</span> = <span class="number">100000011100000011100111111000111111000000111000000011001110001111111001001111001000110001100000011110000111</span></span><br><span class="line"><span class="attr">6</span> = <span class="number">110000011100000001100111001001111111001000111000000011000110001001111001001111001100111001100000011110000111</span></span><br><span class="line"><span class="attr">7</span> = <span class="number">000000001000000001111110011111100111111100111111001111111001111111001111110001111110011111110011111110011111</span></span><br><span class="line"><span class="attr">8</span> = <span class="number">110000111100000011001111001001111001001111001100000011100000011001111001001111001001111001100000011110000111</span></span><br><span class="line"><span class="attr">9</span> = <span class="number">110000111100000011001110011001111001001111001000110001100000001110001001111111001001110011000000011100000111</span></span><br><span class="line"><span class="attr">v5</span> = <span class="number">111111001</span></span><br><span class="line"><span class="attr">v6</span> = <span class="number">001111001</span></span><br><span class="line"><span class="attr">v7</span> = <span class="number">111001111111001111</span></span><br><span class="line"><span class="attr">v8</span> = <span class="number">100000011100000011</span></span><br><span class="line"></span><br><span class="line"><span class="comment">;注释</span></span><br><span class="line"><span class="comment">;6的特征是在初始矩阵中的第8行</span></span><br><span class="line"><span class="comment">;8的特征是在初始矩阵中的第6-7行</span></span><br></pre></td></tr></table></figure></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;本文以安徽工业大学的正方教务系统验证码为实例&lt;/p&gt;
&lt;p&gt;请提前将验证码下载为gif格式图片到本地&lt;/p&gt;
&lt;p&gt;附件1:model.ini (字模文件，已经提取好，不需修改)&lt;/p&gt;
&lt;p&gt;原理即将图像进行二值化处理，逐一对每一个像素点进行处理，处理结果非黑即白&lt;/p&gt;
      
    
    </summary>
    
    
    
      <category term="OCR" scheme="http://blog.webpro.ltd/tags/OCR/"/>
    
      <category term="图像识别" scheme="http://blog.webpro.ltd/tags/%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB/"/>
    
  </entry>
  
  <entry>
    <title>基于PHP+MySQL的小型网上商城系统</title>
    <link href="http://blog.webpro.ltd/2018/01/24/php-shoping/"/>
    <id>http://blog.webpro.ltd/2018/01/24/php-shoping/</id>
    <published>2018-01-23T16:00:00.000Z</published>
    <updated>2020-03-11T03:09:34.476Z</updated>
    
    <content type="html"><![CDATA[<p><em>Demo地址:</em> <a href="https://webpro.ltd/ycpos/member_login.php" target="_blank" rel="noopener">https://webpro.ltd/ycpos/member_login.php</a></p><blockquote><p>测试账户：账号-123,密码-123</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;em&gt;Demo地址:&lt;/em&gt; &lt;a href=&quot;https://webpro.ltd/ycpos/member_login.php&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://webpro.ltd/ycpos/member_login
      
    
    </summary>
    
    
    
      <category term="php" scheme="http://blog.webpro.ltd/tags/php/"/>
    
  </entry>
  
</feed>
